---
title: "ğŸ”§ KFM v11 â€” Shai-Hulud 2.0 Workflow Hardening & Integrity Controls (Diamondâ¹ Î© / CrownâˆÎ© Ultimate Certified)"
path: "docs/security/supply-chain/shai-hulud-2.0/workflows/README.md"
version: "v11.2.3"
last_updated: "2025-11-29"

release_stage: "Stable / Enforced"
lifecycle: "Long-Term Support (LTS)"
review_cycle: "Quarterly Â· Security Guild Â· FAIR+CARE Council Oversight"
backward_compatibility: "Aligned with v10.x â†’ v11.x workflow-governance model"

commit_sha: "<latest-commit>"
previous_version_hash: "<previous-sha256>"
doc_integrity_checksum: "<sha256>"

sbom_ref: "../../../../../releases/v11.2.3/sbom.spdx.json"
manifest_ref: "../../../../../releases/v11.2.3/manifest.zip"
signature_ref: "../../../../../releases/v11.2.3/signature.sig"
attestation_ref: "../../../../../releases/v11.2.3/slsa-attestation.json"

telemetry_ref: "../../../../../releases/v11.2.3/security-telemetry.json"
telemetry_schema: "../../../../../schemas/telemetry/supply-chain-defense-v11.json"
energy_schema: "../../../../../schemas/telemetry/energy-v2.json"
carbon_schema: "../../../../../schemas/telemetry/carbon-v2.json"

governance_ref: "../../../../standards/governance/ROOT-GOVERNANCE.md"
license: "MIT"
mcp_version: "MCP-DL v6.3"
markdown_protocol_version: "KFM-MDP v11.2.2"
status: "Active / Enforced"
doc_kind: "Workflow-Hardening"
intent: "supply-chain-defense-workflow-rules"
fair_category: "F1-A2-I1-R1"
care_label: "CARE-Compliant"
---

<div align="center">

# ğŸ”§ **Shai-Hulud 2.0 â€” Workflow Integrity & Hardening Rules**
`docs/security/supply-chain/shai-hulud-2.0/workflows/README.md`

**Purpose:**  
Define the **workflow-level protections, enforcement rules, validation schemas, and  
signed-template governance** required to prevent workflow-based Shai-Hulud 2.0 infiltration.

**Scope:**  
GitHub Actions Â· promotion DAGs Â· signed templates Â· forbidden triggers Â· lineage & provenance controls  
</div>

---

## ğŸ§¬ 1. Overview

Shai-Hulud 2.0 commonly targets CI/CD workflows through:

- hidden workflow drops (`discussion.yaml`)  
- malicious trigger chains  
- forged workflow dispatches  
- tampering with promotion DAGs  
- unauthorized self-hosted runners

KFM v11 mandates strict workflow integrity, ensuring all actions and pipelines are  
**deterministic**, **immutable**, **tamper-resistant**, and **fully provenance-verified**.

---

## ğŸ§± 2. Workflow Hardening Principles (v11)

### **1. Signed Workflow Templates**
- All workflows must originate from signed, approved templates  
- Any deviation triggers verification failure  
- Template hash stored in PROV-O lineage  

### **2. Forbidden Workflow Files**
Auto-fail if the following appear:

- `.github/workflows/discussion.yaml`  
- `.github/workflows/maintenance.yaml`  
- any workflow containing opaque or undocumented steps  

### **3. Deterministic & Immutable DAGs**
- Promotion DAGs validated before execution  
- No dynamic modification of steps  
- Workflow diffs required for any pipeline changes  

### **4. Strict Trigger Governance**
- Only approved triggers allowed  
- No `workflow_dispatch` without review  
- No scheduling patterns that hide anomalous execution windows  

### **5. Runner Governance Enforcement**
- All runner registrations hashed and verified  
- Self-hosted runners require rotation keys  
- Unrecognized runner IDs auto-blocked  

### **6. Secrets & Token Hygiene**
- No secrets in workflow definitions  
- All token-scopes minimized and audited  
- Exfil-defensive audit logs generated by default  

### **7. Provenance Integration**
- Workflows must produce SLSA v11 provenance  
- Invalid provenance halts DAG promotion  
- Build steps recorded as PROV-O activities  

---

## ğŸ§¬ 3. Workflow Rule Schema (KFM v11)

Each workflow hardening rule includes:

- `id` â€” UUIDv4  
- `category` â€” template | trigger | runner | provenance | DAG  
- `severity` â€” low/medium/high/critical  
- `enforcement` â€” hard | soft | advisory  
- `scope` â€” global | repo | job | action  
- `rationale` â€” justification for rule  
- `mitigation` â€” what CI does when violated  
- `provenance` â€” PROV-O lineage  
- `telemetry_signals[]` â€” linked monitoring metrics  
- `evidence_assets[]` â€” examples, diagrams, redacted files  

---

## ğŸ“¦ 4. STAC Integration

Every workflow rule publishes as a **STAC Item**, with:

- `properties.workflow_rule_type`  
- `assets.rule` â€” rule JSON  
- `assets.provenance` â€” lineage chain  
- `assets.metadata` â€” DCAT metadata  
- `assets.template` â€” signed workflow template (optional redacted)  

STAC enables:

- discovery  
- validation  
- cross-correlation with indicators  
- time-based workflow security analysis  

---

## ğŸ—‚ï¸ 5. Directory Layout

~~~text
docs/security/supply-chain/shai-hulud-2.0/workflows/
â”œâ”€â”€ ğŸ“„ README.md            # This file
â”œâ”€â”€ ğŸ”§ templates/           # Signed workflow templates, baseline definitions
â”œâ”€â”€ ğŸ§ª validation/          # JSON Schema, SHACL, rule checks for workflow integrity
â”œâ”€â”€ ğŸ§¬ provenance/          # PROV-O lineage bundles for workflow runs
â”œâ”€â”€ ğŸ“¦ stac/                # STAC Items / Collections for workflow hardening rules
â””â”€â”€ ğŸ§· samples/             # Synthetic workflow examples for CI & onboarding
~~~

---

## ğŸ” 6. Story Node & Focus Mode Integration

Workflow hardening data generates **Story Node v3** entries that:

- explain workflow-level protections  
- link workflow changes to potential compromises  
- incorporate provenance chains for trust-building  
- anchor security events along the timeline  
- correlate workflow anomalies with Shai-Hulud 2.0 signatures  

Focus Mode v3 uses workflow rules to:

- visualize promotion DAG integrity  
- narratively interpret kill-switch activations  
- tie runner and workflow anomalies into explainable stories  
- show causality between workflow security and detected IoCs  

---

## ğŸ§­ Version History

| Version | Date       | Summary                                                                                                   |
|---------|------------|-----------------------------------------------------------------------------------------------------------|
| v11.2.2 | 2025-11-29 | Complete rewrite; emoji-prefix directory added; governance/H3 upgrades; aligned with KFM-MDP v11.2.2.     |
| v10.4.0 | 2025-11-15 | Earlier workflow integrity overview; pre-v11 metadata structure.                                           |

---

<div align="center">

[ğŸ“˜ Docs Root](../../../../../../..) Â· [ğŸ§ª Pipelines](../../../../../pipelines) Â· [ğŸŒ Governance](../../../../../standards/governance/ROOT-GOVERNANCE.md)

</div>


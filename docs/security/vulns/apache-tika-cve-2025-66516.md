---
title: "üõ°Ô∏è Kansas Frontier Matrix ‚Äî Apache Tika XXE Vulnerability (CVE-2025-66516) Advisory"
path: "docs/security/vulns/apache-tika-cve-2025-66516.md"
version: "v11.2.4"
last_updated: "2025-12-07"

release_stage: "Advisory ¬∑ Active"
lifecycle: "Incident-Driven ‚Üí Archived (Post-Mitigation)"
review_cycle: "Ad-hoc ¬∑ Security & Supply Chain Board ¬∑ FAIR+CARE Council"
content_stability: "stable"
backward_compatibility: "Not Applicable (governance / architecture only)"

status: "Active ¬∑ Mitigation Required"
doc_kind: "Security Advisory"
header_profile: "standard"
footer_profile: "standard"

scope:
  domain: "security"
  applies_to:
    - "etl"
    - "document-ingestion"
    - "search-indexing"
    - "api"
    - "ci-cd"
    - "supply-chain"
    - "observability"

fair_category: "F1-A1-I2-R1"
care_label: "Public ¬∑ Low-Risk"
sensitivity: "General (non-sensitive; no secrets)"
classification: "Security Advisory ¬∑ Public"
threat_kind: "XXE ¬∑ SSRF ¬∑ Potential RCE"
cve_id: "CVE-2025-66516"

commit_sha: "<latest-commit-hash>"
previous_version_hash: "<previous-commit-or-doc-hash>"
doc_integrity_checksum: "<sha256-of-this-file>"

sbom_ref: "../../../releases/v11.2.4/sbom.spdx.json"
manifest_ref: "../../../releases/v11.2.4/manifest.zip"
telemetry_ref: "../../../releases/v11.2.4/security-incidents-telemetry.json"
telemetry_schema: "../../../schemas/telemetry/security/security-incidents-v1.json"
governance_ref: "../../standards/governance/ROOT-GOVERNANCE.md"

license: "MIT"
mcp_version: "MCP-DL v6.3"
markdown_protocol_version: "KFM-MDP v11.2.4"
---

<div align="center">

# üõ°Ô∏è Kansas Frontier Matrix  
## Apache Tika XXE Vulnerability (CVE-2025-66516) Advisory  

**Severity:** Critical ¬∑ CVSS 10.0 ¬∑ XXE ‚Üí SSRF / Data Exfiltration / Potential RCE  
**Applies To:** Any past, present, or future KFM use of Apache Tika for document or metadata parsing.

</div>

---

## üìò Overview

### 1. Purpose

This document records how the Kansas Frontier Matrix (KFM) recognizes, evaluates, and governs **CVE-2025-66516**, a critical XML External Entity (XXE) vulnerability in **Apache Tika**.  

It defines:

- A **canonical risk assessment** for KFM.
- **Hard requirements** for any use of Apache Tika in ETL / indexing / analysis.
- **CI/CD, supply-chain, and runtime controls** required to keep KFM safe from this class of issue.
- How this advisory plugs into **KFM security, FAIR+CARE governance, and Shai-Hulud 2.0 supply-chain defenses**.

This is an **architecture and governance** document; it does not expose secrets and is safe to publish in a public repo.

### 2. CVE-2025-66516 ‚Äî Summary

#### 2.1 Vulnerability class

- Type: **XML External Entity (XXE) injection** in PDF/XFA parsing.
- Impact:
  - Arbitrary **file read** on the server.
  - **SSRF** into internal networks and metadata services.
  - Potential stepping stone to **RCE**, depending on environment and integrations.
- Trigger: Parsing a **crafted PDF** containing malicious **XFA** XML that Tika processes with entity expansion enabled.

#### 2.2 Affected Apache Tika components & versions

As of 2025-12-07, the advisory affects at least the following Maven artifacts and version ranges:

- `org.apache.tika:tika-core`  
  - Vulnerable: **1.13 ‚Äì 3.2.1**  
  - Fixed: **3.2.2+**
- `org.apache.tika:tika-parser-pdf-module`  
  - Vulnerable: **2.0.0 ‚Äì 3.2.1**  
  - Fixed: **3.2.2+**
- `org.apache.tika:tika-parsers` (1.x line)  
  - Vulnerable: **1.13 ‚Äì 1.28.5**  
  - Fixed: **2.0.0+**

Key nuance: the **root flaw lives in `tika-core`**, not only in the PDF parser module. Updating only the PDF parser **does not fully mitigate** if `tika-core` remains below 3.2.2.

---

## üóÇÔ∏è Directory Layout

```text
üìÅ repo-root/
‚îú‚îÄ‚îÄ üìÅ docs/
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ security/
‚îÇ       ‚îú‚îÄ‚îÄ üìÑ README.md
‚îÇ       ‚îî‚îÄ‚îÄ üìÅ vulns/
‚îÇ           ‚îî‚îÄ‚îÄ üìÑ apache-tika-cve-2025-66516.md      # This advisory
‚îú‚îÄ‚îÄ üìÅ src/
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ pipelines/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ security/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ üìÅ tika/
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ üìÑ tika-sbom-scan.py              # SBOM scanner for Tika deps
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ üìÑ tika-sandbox-runner.py         # Sandbox wrapper for Tika parsing
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ graph/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ security/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ üìÑ vulns.cypher                      # Graph inserts for vulnerability facts
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ api/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ security/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ üìÑ vulnerabilities.py                 # API exposure of vulnerability metadata
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ web/
‚îÇ       ‚îî‚îÄ‚îÄ üìÅ security/
‚îÇ           ‚îî‚îÄ‚îÄ üìÑ SecurityAdvisories.tsx             # Frontend list + detail view
‚îú‚îÄ‚îÄ üìÅ data/
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ security/
‚îÇ       ‚îú‚îÄ‚îÄ üìÅ sbom/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ tika-components.spdx.json          # SBOM with explicit Tika artifacts
‚îÇ       ‚îî‚îÄ‚îÄ üìÅ telemetry/
‚îÇ           ‚îî‚îÄ‚îÄ üìÑ security-incidents.jsonl           # Incident + detection telemetry
‚îî‚îÄ‚îÄ üìÅ .github/
    ‚îî‚îÄ‚îÄ üìÅ workflows/
        ‚îî‚îÄ‚îÄ üìÑ security-advisories-ci.yml             # Lints, schema, link + status checks
```

- **Primary module:** `docs/security/vulns/apache-tika-cve-2025-66516.md`
- **Related modules:**
  - `src/pipelines/security/tika/*` (sandboxed parsing + SBOM scans)
  - `src/api/security/vulnerabilities.py` (API surface)
  - `src/web/security/SecurityAdvisories.tsx` (UI)
  - `data/security/sbom/*`, `data/security/telemetry/*` (evidence & monitoring)
  - `.github/workflows/security-advisories-ci.yml` (Markdown + policy enforcement)

---

## üß≠ Context

### 4. KFM Exposure Assessment

#### 4.1 Current state (v11.2.4)

As of this advisory:

- **Canonical KFM stack** (ETL, graph, API, web, Story Nodes, Focus Mode) does **not require** Apache Tika as a core dependency.
- Where document parsing is required (e.g., for historical PDFs, archival material, environmental reports), KFM prefers:
  - **Language-native parsing libraries** with tighter configuration.
  - **External, sandboxed services** with strong egress controls and minimal privileges.

> If any KFM sub-project, experiment, or external contributor adds Apache Tika, it **must** conform to the governance and constraints in this advisory.

#### 4.2 Risk if Tika were introduced

If Apache Tika were used in KFM, the realistic high-risk scenarios include:

- **Untrusted file uploads** (e.g., community contributions, scanned documents, crowdsourced material) being parsed by a vulnerable Tika instance.
- **Automated harvesting** of historical documents from the web (e.g., environmental reports, agency archives) feeding directly through Tika without pre-validation.
- A compromised PDF functioning as a **pivot**:
  - Read secrets from disk (keys, tokens, configuration).
  - Perform **SSRF** into metadata endpoints (e.g., cloud instance metadata, internal APIs).
  - Degrade availability via **resource exhaustion** (entity expansion, large external documents).

Given KFM‚Äôs goal as a long-lived open data and AI system, this class of bug is considered **structural risk**: it will reoccur in different libraries over time and must be governed at **architecture level**, not just dependency level.

---

## üß± Architecture

### 5. Hard Requirements for Any Apache Tika Usage in KFM

This section defines **non-negotiable rules**. Any proposal or PR that introduces Tika must show compliance in design docs, code, CI, and observability.

#### 5.1 Dependency constraints

1. **Version floor (mandatory)**
   - `tika-core` **must be ‚â• 3.2.2**.
   - `tika-parser-pdf-module` **must be ‚â• 3.2.2** if used.
   - `tika-parsers` (if 1.x ever appears in a legacy context) **must be ‚â• 2.0.0** (but use of 1.x is strongly discouraged).

2. **SBOM enforcement**
   - The KFM **SBOM generator** MUST:
     - Enumerate all Apache Tika artifacts and versions.
     - Fail CI if any vulnerable or unknown version appears.
   - `sbom_ref` for any release containing Tika MUST point to an SBOM where Tika entries are:
     - **Explicitly listed**.
     - Checked against **CVE-2025-66516** and successors.

3. **No transitives-by-accident**
   - Any appearance of Tika as a **transitive dependency** is treated as **‚Äúas if direct‚Äù** for governance:
     - Must be captured in SBOM.
     - Must pass version floor checks.
     - Must be surfaced in PR review via the Shai-Hulud 2.0 supply-chain guardrails.

#### 5.2 Configuration hardening

Even on patched versions:

- **Disable** or strictly restrict any XML/XFA features that allow external entities, unless a requirement is documented and justified.
- Enforce explicit parser configurations:
  - No ‚Äúdefault permissive‚Äù parsing for XML within PDFs.
  - Where possible, configure **entity expansion limits** and **disallow external entities**.
- Treat **all PDF/XFA input as untrusted**, regardless of source.

#### 5.3 Allowed usage patterns

KFM will only accept Tika usage if **all** of the following are true:

- Parsing happens in a **separate, sandboxed service or worker** (not in core ETL nodes that hold secrets).
- The process:
  - Runs under a **low-privilege account**.
  - Has **read-only, minimal filesystem access**.
  - Has restrictively configured **egress** (no default full outbound internet).
- Secrets (API keys, cloud credentials, DB connection strings) are **not** co-located with the Tika parser process.

If these conditions cannot be met, Tika **must not** be used.

### 6. Runtime Safeguards

Regardless of Tika version, KFM treats file parsing as **high-risk** and requires defense in depth.

#### 6.1 Sandbox & isolation

- Parse PDFs/XFA in:
  - **Containerized** workloads with:
    - Read-only root filesystem.
    - No access to host-level secrets or `/proc` information beyond what‚Äôs required.
  - **Kubernetes** or equivalent with:
    - Tight **network policies** (egress allow-list only).
    - Pod security restrictions (no privileged mode, no host networking).
- Only allow the parser to:
  - Read from a **controlled input volume/object store**.
  - Emit **normalized text/metadata** into a separate output channel (e.g., queue, object store).

#### 6.2 Network & egress controls

- Deny:
  - Access to **metadata endpoints** (e.g., cloud instance metadata).
  - Access to **internal APIs** unless explicitly needed and justified.
  - Arbitrary outbound HTTP to the internet from parser containers.
- If HTTP is required (e.g., for limited schema validation), restrict with:
  - DNS allow-list.
  - Minimal HTTP client configuration (timeouts, small response limits).

#### 6.3 Observability and detection

- Emit telemetry spans for each parse:
  - File type, size bucket, and anonymized source category.
  - Parser outcome: success / parse_error / security_blocked.
- Add **security alerts** when:
  - XFA/XML entities attempt to reach blocked destinations.
  - Parse pods exceed normal resource usage thresholds (possible DoS).
  - Unexpected outbound network patterns arise from parser workloads.

---

## üß™ Validation & CI/CD

### 7. CI/CD, Supply-Chain & Governance Controls

#### 7.1 Shai-Hulud 2.0 supply-chain defenses

Any pipeline that could introduce Tika (directly or transitively) must:

1. **Pin versions**
   - Use explicit version pins for Tika dependencies.
   - No floating ranges that would allow downgrades or accidental introduction of vulnerable versions.

2. **CVE policy in CI**
   - CI must:
     - Fail builds if Tika versions fall in **affected ranges**.
     - Surface CVE metadata (including CVE-2025-66516) in build logs and PR comments.

3. **Dependabot / updater rules**
   - `.github/dependabot.yml` must:
     - Monitor ecosystems where Tika could appear (Maven/Gradle, possibly containers).
     - Prefer **security updates** and **major/minor Tika bumps** when vulnerability advisories are published.
   - PRs auto-created for Tika upgrades **must not be auto-merged**; they require manual review acknowledging security impact.

#### 7.2 Docs and design review

Any component design that proposes Tika must:

- Reference this advisory‚Äôs **path** and **version** in its design doc.
- Explicitly answer:
  - Why Tika is needed instead of safer/simpler alternatives.
  - Which **parsers** and **file types** will be enabled.
  - How sandboxing and egress restrictions are implemented.

Designs that fail to do so can be rejected at review as **non-compliant with KFM security governance**.

### 8. Implementation Checklist

Use this table as a **PR review checklist** if Tika is added or modified anywhere in KFM.

| Item | Requirement                                             | Status (‚úî/‚úñ/N/A) | Notes / Links |
|------|---------------------------------------------------------|------------------|---------------|
| 1    | All Tika deps ‚â• required fixed versions                 |                  |               |
| 2    | Tika presence verified in SBOM                          |                  |               |
| 3    | CI fails on vulnerable Tika versions                    |                  |               |
| 4    | Parser runs in sandboxed container                      |                  |               |
| 5    | No direct access to secrets from parser                 |                  |               |
| 6    | Egress locked down (no metadata, no general internet)   |                  |               |
| 7    | XML/XFA entity expansion hardened/disabled              |                  |               |
| 8    | Telemetry + alerts for parsing anomalies                |                  |               |
| 9    | Design doc references this advisory                     |                  |               |
| 10   | FAIR+CARE governance and data sensitivity reviewed      |                  |               |

---

## ‚öñ FAIR+CARE & Governance

### 9. FAIR+CARE and Data Sensitivity

Even though this advisory does not contain sensitive site coordinates or cultural heritage locations, KFM still binds it to FAIR+CARE principles:

- **FAIR**
  - Findable via the security docs index and CVE tag.
  - Accessible as a public, non-secret document.
  - Interoperable via clear metadata fields (`cve_id`, `threat_kind`).
  - Reusable as a template for future document-parser vulnerabilities.

- **CARE**
  - By hardening parsing paths against XXE/SSRF, KFM reduces the risk that malicious documents compromise:
    - Indigenous data stores.
    - Sensitive archaeology or cultural heritage metadata.
  - Any pipeline that handles such data **must** use hardened parsers and sandboxing by default; Tika, if used, is no exception.

### 10. How to Use This Document

- **If you are proposing to add Apache Tika to any KFM component:**
  - Link this advisory in your design doc.
  - Copy the checklist (Section 8) into your PR description and complete it.
- **If you discover Tika is already present transitively:**
  - Raise an issue referencing this file path and `cve_id`.
  - Add SBOM + CI rules to enforce the version floors and sandbox requirements.
- **If you are on the security or reliability team:**
  - Ensure Shai-Hulud 2.0 policies and energy/cost telemetry also capture the overhead of sandboxed parsing, so risk-mitigation costs are observable.

---

## üï∞Ô∏è Version History

| Version | Date       | Author / Steward              | Summary                                                                                           |
|---------|-----------:|------------------------------|---------------------------------------------------------------------------------------------------|
| v11.2.4 | 2025-12-07 | Security & Supply-Chain Team | Initial advisory for CVE-2025-66516; defined version floors, sandbox requirements, CI/SBOM rules, and telemetry expectations. |

---

<div align="center">

**Kansas Frontier Matrix (KFM v11)**  
Deterministic ETL ‚Üí STAC/DCAT/PROV ‚Üí Neo4j Graph ‚Üí API ‚Üí React/MapLibre/Cesium ‚Üí Story Nodes ‚Üí Focus Mode  

[üèóÔ∏è Architecture Index](../../architecture/README.md) ‚Ä¢ [üõ°Ô∏è Security & Supply Chain](../README.md) ‚Ä¢ [‚öñÔ∏è Root Governance](../../standards/governance/ROOT-GOVERNANCE.md)

</div>
~~~json
{
  "@context": [
    "https://schema.kfm.example.org/story-node/v3",
    "https://schema.org",
    {
      "kfm": "urn:kfm:"
    }
  ],
  "id": "urn:kfm:story-node:system:auto-update:kfm-auto-update-v11.2.2",
  "type": "kfm:StoryNode",
  "version": "v11.2.2",
  "label": "KFM Auto-Update Orchestrator (Stage → Prod)",
  "spacetime": {
    "geometry": null,
    "when": {
      "type": "Interval",
      "start": "2025-11-28T03:00:00Z",
      "end": null
    }
  },
  "narrative": {
    "summary": "Daily governed auto-update from stage to production using kfm-auto-update.yml with FAIR+CARE, sovereignty, supply-chain, and telemetry enforcement.",
    "details": [
      "At 03:00 UTC each day, KFM runs the kfm-auto-update workflow.",
      "The ingest job refreshes data/models in stage, then validates docs, STAC/DCAT, JSON-LD, FAIR+CARE, H3 masking, and data contracts.",
      "If governance passes, the promote job uses the prod environment gate to move artifacts from stage to production and tags a new version.",
      "Telemetry and OpenLineage events describe each run, feeding governance dashboards and Focus Mode system health."
    ],
    "risk_summary": "Low technical risk (governed and fully validated) but subject to FAIR+CARE and sovereignty review for new or changed datasets."
  },
  "links": {
    "targets": [
      "urn:kfm:workflow:.github/workflows/kfm-auto-update.yml",
      "urn:kfm:doc:github-workflows:architecture:v11.2.2",
      "urn:kfm:doc:github-readme-v11.2.2",
      "urn:kfm:release:v11.2.2"
    ],
    "datasets": [],
    "environments": [
      "urn:kfm:environment:stage",
      "urn:kfm:environment:prod"
    ]
  },
  "governance": {
    "fair_category": "F1-A1-I1-R1",
    "care_label": "Public / Low-Risk",
    "sovereignty_policy": "docs/standards/sovereignty/INDIGENOUS-DATA-PROTECTION.md",
    "notes": [
      "Auto-update runs must not override manual governance decisions.",
      "Stage → prod promotion is always gated by environment approvals."
    ]
  },
  "telemetry_refs": [
    "releases/v11.2.2/github-infra-telemetry.json"
  ]
}
~~~


---

# File: schemas/telemetry/views/kfm-auto-update-dashboard-v1.json
~~~json
{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "urn:kfm:schema:telemetry:view:kfm-auto-update-dashboard-v1",
  "title": "KFM Auto-Update Dashboard View v1",
  "type": "object",
  "description": "A view configuration for visualizing auto-update telemetry (stage → prod runs) from github-infra-telemetry.json.",
  "properties": {
    "version": {
      "type": "string",
      "const": "v1"
    },
    "source_telemetry_file": {
      "type": "string",
      "description": "Path to the aggregated GitHub infra telemetry file.",
      "default": "releases/v11.2.2/github-infra-telemetry.json"
    },
    "widgets": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["id", "type"],
        "properties": {
          "id": { "type": "string" },
          "type": {
            "type": "string",
            "enum": [
              "timeseries",
              "bar",
              "table",
              "kpi"
            ]
          },
          "title": { "type": "string" },
          "description": { "type": "string" },
          "query": {
            "type": "object",
            "description": "Lightweight query spec against telemetry JSON.",
            "properties": {
              "filter": {
                "type": "object",
                "description": "Field/value filters on telemetry records."
              },
              "group_by": {
                "type": "array",
                "items": { "type": "string" }
              },
              "metric": {
                "type": "string",
                "description": "Name of the numeric metric, e.g. auto_update.success_count."
              },
              "aggregation": {
                "type": "string",
                "enum": ["sum", "avg", "min", "max", "count"],
                "default": "sum"
              }
            },
            "required": ["metric"]
          }
        }
      }
    }
  },
  "required": [
    "version",
    "source_telemetry_file",
    "widgets"
  ],
  "examples": [
    {
      "version": "v1",
      "source_telemetry_file": "releases/v11.2.2/github-infra-telemetry.json",
      "widgets": [
        {
          "id": "auto-update-success-rate",
          "type": "kpi",
          "title": "Auto-Update Success Rate (Stage → Prod)",
          "description": "Percentage of auto-update runs that fully passed all governance gates.",
          "query": {
            "metric": "auto_update.success_rate_pct"
          }
        },
        {
          "id": "auto-update-duration",
          "type": "timeseries",
          "title": "Auto-Update Duration Over Time",
          "description": "Total duration (minutes) of ingest + promote per run.",
          "query": {
            "metric": "auto_update.total_duration_minutes"
          }
        },
        {
          "id": "auto-update-governance-violations",
          "type": "bar",
          "title": "Governance Violations per Auto-Update Run",
          "description": "Count of FAIR+CARE, H3, and security violations blocking promotions.",
          "query": {
            "metric": "auto_update.governance_violation_count",
            "group_by": ["violation_type"]
          }
        }
      ]
    }
  ]
}
~~~

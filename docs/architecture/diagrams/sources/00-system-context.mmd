%% ğŸ§­ Kansas-Matrix-System â€” System Context (C4: Context)
%% ğŸ“„ docs/architecture/diagrams/sources/00-system-context.mmd
%% âœ… Mermaid-safe labels: NO parentheses inside node text (prevents parse errors)
%% ğŸ§© Scope: People + external systems + KFM as a single â€œsystemâ€ box

flowchart LR

%% =========================
%% ğŸ‘¥ People & Roles
%% =========================
subgraph P["ğŸ‘¥ People & Roles"]
  direction TB
  publicViewer["ğŸ§­ Public Viewer<br/>read-only public datasets and stories"]
  researcher["ğŸ”¬ Researcher<br/>analysis and export workflows"]
  educator["ğŸ“ Educator<br/>teaching and storytelling"]
  policymaker["ğŸ›ï¸ Policy Maker<br/>evidence-backed decisions"]
  contributor["âœï¸ Contributor<br/>draft data and story submissions"]
  maintainer["ğŸ› ï¸ Maintainer<br/>review and publish approvals"]
  admin["ğŸ” Admin<br/>operate pipelines and configure policies"]
  governance["ğŸ§‘â€âš–ï¸ Governance and Data Stewards<br/>including Indigenous stakeholders"]
end

%% =========================
%% ğŸ—ºï¸ System (KFM)
%% =========================
kfm["ğŸ—ºï¸ Kansas Frontier Matrix<br/>KFM evidence-first geospatial knowledge platform<br/><br/>ğŸ§¾ map behind the map<br/>ğŸ” provenance and citations on every insight<br/>ğŸ§© open standards and interoperable APIs"]

%% =========================
%% ğŸŒ External Data Providers
%% =========================
subgraph D["ğŸŒ External Data Providers"]
  direction TB
  state["ğŸ¢ Kansas and regional sources<br/>state agencies and GIS hubs"]
  federal["ğŸ‡ºğŸ‡¸ Federal sources<br/>USGS NOAA USDA EPA FEMA Census and more"]
  archives["ğŸ›ï¸ Libraries and archives<br/>universities community collections"]
  partners["ğŸ¤ Partner and licensed collections<br/>when permitted"]
end

%% =========================
%% ğŸ”Œ External Services & Integrations
%% =========================
subgraph S["ğŸ”Œ External Services & Integrations"]
  direction TB
  idp["ğŸªª Identity Provider<br/>OAuth OIDC and or API keys"]
  cicd["ğŸ¤– Source control and CI CD<br/>automations and policy checks"]
  gisTools["ğŸ§° External tools<br/>QGIS ArcGIS notebooks Jupyter R Python"]
  earthEngine["ğŸ›°ï¸ Google Earth Engine<br/>optional analysis and prototyping"]
  downstream["ğŸ“£ Downstream consumers<br/>third-party apps via APIs"]
end

%% =========================
%% ğŸ” Relationships
%% =========================
publicViewer -->|Browse public maps and stories| kfm
researcher -->|Query analyze export| kfm
educator -->|Use curated stories| kfm
policymaker -->|Explore insights with citations| kfm
contributor -->|Submit drafts| kfm
maintainer -->|Review approve publish| kfm
admin -->|Run operations and ingestion| kfm
governance -->|Define policy sensitivity and CARE rules| kfm

state -->|Provide datasets for ingestion and catalog| kfm
federal -->|Provide open datasets and imagery| kfm
archives -->|Provide historical records media texts| kfm
partners -->|Provide licensed data under governance| kfm

idp -->|Issue auth tokens| kfm
cicd -->|Trigger governed builds tests gates| kfm
kfm -->|Exports and APIs STAC COG GeoJSON OGC-ready| gisTools
kfm -->|APIs for integration| downstream
kfm -.->|Optional export compute import derivatives| earthEngine

%% =========================
%% ğŸ¨ Light styling
%% =========================
classDef system stroke-width:2px;
class kfm system;

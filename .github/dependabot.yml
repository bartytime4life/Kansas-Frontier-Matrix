version: 2
updates:
  # Keep GitHub Actions dependencies (referenced in .github/workflows/** and composite actions) up to date.
  - package-ecosystem: "github-actions"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "monday"
      time: "05:00"
      timezone: "UTC"

    # Keep PR volume bounded; version-update PRs stop after this limit
    # (security updates have their own internal limit).
    open-pull-requests-limit: 5

    # Commit message prefix used for both commits + PR titles (for non-grouped updates).
    commit-message:
      # Keep titles stable and concise (avoid `deps(deps): ...`).
      prefix: "deps"

    # Avoid "/" separators in branch names for maximum tooling compatibility.
    pull-request-branch-name:
      separator: "-"

    # Group minor+patch updates into fewer PRs; majors remain individual PRs for explicit review.
    # Split first-party actions (GitHub orgs) from third-party actions to reduce review blast-radius.
    groups:
      actions-first-party-minor-patch:
        patterns:
          - "actions/*"
          - "github/*"
        update-types:
          - "minor"
          - "patch"

      actions-third-party-minor-patch:
        patterns:
          - "*"
        exclude-patterns:
          - "actions/*"
          - "github/*"
        update-types:
          - "minor"
          - "patch"

      # If Dependabot Security Updates are enabled, group Actions security fixes too.
      actions-first-party-security:
        applies-to: "security-updates"
        patterns:
          - "actions/*"
          - "github/*"

      actions-third-party-security:
        applies-to: "security-updates"
        patterns:
          - "*"
        exclude-patterns:
          - "actions/*"
          - "github/*"

    # Delay major releases briefly to reduce churn from just-published majors.
    # Note: cooldown applies only to version updates (not security updates).
    cooldown:
      semver-major-days: 7

  # Optional ecosystems (enable only after confirming manifests exist in the given directory).
  # These align to KFM canonical roots (UI in `web/`, APIs in `src/server/`, etc.):contentReference[oaicite:2]{index=2}
  # Not confirmed in repo:
  #
  # - package-ecosystem: "npm"
  #   directory: "/web"
  #   schedule:
  #     interval: "weekly"
  #     day: "monday"
  #     time: "05:00"
  #     timezone: "UTC"
  #   open-pull-requests-limit: 5
  #   commit-message:
  #     prefix: "deps"
  #   pull-request-branch-name:
  #     separator: "-"
  #   groups:
  #     npm-minor-patch:
  #       patterns:
  #         - "*"
  #       update-types:
  #         - "minor"
  #         - "patch"
  #     npm-security:
  #       applies-to: "security-updates"
  #       patterns:
  #         - "*"
  #
  # - package-ecosystem: "pip"
  #   directory: "/"
  #   schedule:
  #     interval: "weekly"
  #     day: "monday"
  #     time: "05:00"
  #     timezone: "UTC"
  #   open-pull-requests-limit: 5
  #   commit-message:
  #     prefix: "deps"
  #   pull-request-branch-name:
  #     separator: "-"
  #   groups:
  #     pip-minor-patch:
  #       patterns:
  #         - "*"
  #       update-types:
  #         - "minor"
  #         - "patch"
  #     pip-security:
  #       applies-to: "security-updates"
  #       patterns:
  #         - "*"
  #
  # - package-ecosystem: "docker"
  #   directory: "/"
  #   schedule:
  #     interval: "weekly"
  #     day: "monday"
  #     time: "05:00"
  #     timezone: "UTC"
  #   open-pull-requests-limit: 5
  #   commit-message:
  #     prefix: "deps"
  #   pull-request-branch-name:
  #     separator: "-"
  #   groups:
  #     docker-minor-patch:
  #       patterns:
  #         - "*"
  #       update-types:
  #         - "minor"
  #         - "patch"
  #     docker-security:
  #       applies-to: "security-updates"
  #       patterns:
  #         - "*"

# .github/dependabot.yml
# Kansas-Frontier-Matrix — Dependabot configuration (aligned to .github/labels.yml)
version: 2

updates:
  # ── GitHub Actions (workflows) ────────────────────────────────────────────────
  - package-ecosystem: github-actions
    directory: /
    schedule:
      interval: weekly
      day: sunday
      time: "03:10"
      timezone: "America/Chicago"
    open-pull-requests-limit: 10
    rebase-strategy: auto
    labels: ["dependencies", "security", "ci"]
    groups:
      actions-minor-patch:
        update-types: ["minor", "patch"]

  # ── NPM / Node (web client) ──────────────────────────────────────────────────
  - package-ecosystem: npm
    directory: /web
    schedule:
      interval: weekly
      day: sunday
      time: "03:20"
      timezone: "America/Chicago"
    open-pull-requests-limit: 10
    rebase-strategy: auto
    labels: ["dependencies", "security", "web"]
    versioning-strategy: increase
    groups:
      web-minor-patch:
        patterns: ["*"]
        update-types: ["minor", "patch"]
    ignore:
      # Hold back major MapLibre jumps until manually tested
      - dependency-name: maplibre-gl
        update-types: ["version-update:semver-major"]

  # ── Python (pip / backend & tooling) ─────────────────────────────────────────
  - package-ecosystem: pip
    directory: /
    schedule:
      interval: weekly
      day: sunday
      time: "03:30"
      timezone: "America/Chicago"
    open-pull-requests-limit: 10
    rebase-strategy: auto
    labels: ["dependencies", "security"]
    groups:
      python-minor-patch:
        patterns: ["*"]
        update-types: ["minor", "patch"]
    ignore:
      # Pin GDAL major jumps until CI base images/toolchains are updated
      - dependency-name: gdal
        update-types: ["version-update:semver-major"]

  # ── Docker (container builds) ────────────────────────────────────────────────
  - package-ecosystem: docker
    directory: /
    schedule:
      interval: weekly
      day: sunday
      time: "03:40"
      timezone: "America/Chicago"
    open-pull-requests-limit: 10
    rebase-strategy: auto
    labels: ["dependencies", "security"]
    groups:
      docker-minor-patch:
        patterns: ["*"]
        update-types: ["minor", "patch"]

  # ── Security fast-lane (daily advisory-based bumps) ──────────────────────────
  - package-ecosystem: github-actions
    directory: /
    schedule:
      interval: daily
      timezone: "America/Chicago"
    labels: ["dependencies", "security", "ci"]
    commit-message:
      prefix: "chore(security)"

  - package-ecosystem: npm
    directory: /web
    schedule:
      interval: daily
      timezone: "America/Chicago"
    labels: ["dependencies", "security", "web"]
    commit-message:
      prefix: "chore(security)"

  - package-ecosystem: pip
    directory: /
    schedule:
      interval: daily
      timezone: "America/Chicago"
    labels: ["dependencies", "security"]
    commit-message:
      prefix: "chore(security)"

  - package-ecosystem: docker
    directory: /
    schedule:
      interval: daily
      timezone: "America/Chicago"
    labels: ["dependencies", "security"]
    commit-message:
      prefix: "chore(security)"

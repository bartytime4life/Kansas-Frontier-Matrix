---
title: "GitHub Apps ‚Äî Repository Automation"
path: ".github/apps/README.md"
version: "v1.0.1"
last_updated: "2025-12-28"
status: "draft"
doc_kind: "Guide"
license: "CC-BY-4.0"

markdown_protocol_version: "KFM-MDP v11.2.6"
mcp_version: "MCP-DL v6.3"
ontology_protocol_version: "KFM-ONTO v4.1.0"
pipeline_contract_version: "KFM-PPC v11.0.0"
stac_profile: "KFM-STAC v11.0.0"
dcat_profile: "KFM-DCAT v11.0.0"
prov_profile: "KFM-PROV v11.0.0"

governance_ref: "docs/governance/ROOT_GOVERNANCE.md"
ethics_ref: "docs/governance/ETHICS.md"
sovereignty_policy: "docs/governance/SOVEREIGNTY.md"
fair_category: "FAIR+CARE"
care_label: "TBD"
sensitivity: "public"
classification: "open"
jurisdiction: "US-KS"

doc_uuid: "urn:kfm:doc:github:apps-readme:v1.0.1"
semantic_document_id: "kfm-github-apps-readme-v1.0.1"
event_source_id: "ledger:kfm:doc:github:apps-readme:v1.0.1"
commit_sha: "<latest-commit-hash>"

ai_transform_permissions:
  - "summarize"
  - "structure_extract"
  - "translate"
  - "keyword_index"

ai_transform_prohibited:
  - "generate_policy"
  - "infer_sensitive_locations"

doc_integrity_checksum: "sha256:<calculate-and-fill>"
---

# GitHub Apps ‚Äî Repository Automation

## üìò Overview

### Purpose

- Provide a single, repo-versioned location for **GitHub App** manifests and operational documentation used by repository automation.
- Standardize how we request/review app permissions and how CI workflows authenticate **without committing secrets**.
- Keep automation aligned with KFM‚Äôs contract-first pipeline rules and canonical subsystem homes (see `docs/MASTER_GUIDE_v12.md`).

### Scope

| In Scope | Out of Scope |
|---|---|
| Public GitHub App manifests (no secrets), permission justifications, mapping apps ‚Üí workflows/jobs, rotation/runbook pointers, telemetry pointers | Private keys, webhook secrets, installation tokens, and other credential *values* (must live in secret storage); GitHub Actions workflow definitions themselves; generating new policy text |

### Audience

- Primary: repo maintainers, CI/CD owners, security reviewers
- Secondary: contributors who need to understand why an integration exists (and how it is governed)

### Definitions

- Glossary link: `docs/glossary.md` *(expected canonical location; if missing, add or replace with repo‚Äôs glossary path)*
- Terms used in this doc:
  - **GitHub App**: GitHub-native integration with scoped permissions and auditable installations.
  - **App manifest**: JSON definition used to create/configure an app (must be secret-free in this repo).
  - **Installation**: Org/repo install of the app that grants access within scope.
  - **Private key / webhook secret**: credentials generated by GitHub (never commit).
  - **Least privilege**: only the permissions required for a specific job/workflow.
  - **GITHUB_TOKEN**: default workflow token; preferred where sufficient.
  - **OIDC**: preferred for external cloud auth (not a replacement for GitHub App auth).

### Key artifacts (what this doc points to)

| Artifact | Path / Identifier | Owner | Notes |
|---|---|---|---|
| GitHub Apps README | `.github/apps/README.md` | Repo maintainers | This document |
| App definition folder | `.github/apps/<app_slug>/` | App owner | One folder per GitHub App integration |
| Workflow inventory | `.github/workflows/` | CI owners | Workflows that may use app-based auth |
| Master Guide | `docs/MASTER_GUIDE_v12.md` | KFM maintainers | Pipeline invariants + contract-first rules |
| Security + governance refs | `docs/governance/*` + `.github/SECURITY.md` *(if present)* | Security reviewers | Credential handling, review gates, incident process |
| Universal template | `docs/templates/TEMPLATE__KFM_UNIVERSAL_DOC.md` | KFM maintainers | This doc‚Äôs governing structure |

### Definition of done (for this document)

- [ ] Front-matter complete + valid (path/version/last_updated)
- [ ] Folder contract documented and consistent across apps
- [ ] App permission requests are documented and justified (least privilege)
- [ ] No secrets committed (private keys/webhook secrets/tokens) anywhere in `.github/apps/**`
- [ ] Workflows depending on an app are listed and reviewed
- [ ] Validation steps below are repeatable
- [ ] Governance + CARE/sovereignty considerations explicitly stated

## üóÇÔ∏è Directory Layout

### This document

- `path`: `.github/apps/README.md` *(must match front-matter)*

### Related repository paths

| Area | Path | What lives here |
|---|---|---|
| CI | `.github/` | Workflows + policy gates |
| GitHub Apps docs | `.github/apps/` | App manifests + permission/runbook docs (secret-free) |
| Workflows | `.github/workflows/` | CI/CD pipelines that may call GitHub APIs |
| Local actions | `.github/actions/` *(if present)* | Repo-local composite actions (preferred for reusable gate logic) |
| Documentation | `docs/` | Canonical governed docs (architecture, standards, runbooks) |
| Pipelines | `src/pipelines/` | ETL + catalog + transforms (may be triggered by CI) |
| Graph | `src/graph/` | Ontology bindings, ingest/migrations, integrity constraints |
| API boundary | `src/server/` | Contracted access layer (REST/GraphQL); redaction enforcement |
| UI | `web/` | React + MapLibre (+ optional Cesium); Focus Mode UX |
| Story Nodes | `docs/reports/story_nodes/` *(pattern)* | Templates, draft/published narratives, assets |
| Catalog outputs | `data/stac/` + `data/catalog/dcat/` + `data/prov/` | STAC/DCAT/PROV outputs (when pipelines run) |
| Telemetry | `schemas/telemetry/` + `docs/telemetry/` *(if present)* | Observability + governance signals |

### Expected file tree for this sub-area

~~~text
üìÅ .github/
‚îî‚îÄ‚îÄ üìÅ apps/
    ‚îú‚îÄ‚îÄ üìÑ README.md
    ‚îú‚îÄ‚îÄ üìÑ inventory.md                  # optional but recommended
    ‚îî‚îÄ‚îÄ üìÅ <app_slug>/
        ‚îú‚îÄ‚îÄ üìÑ permissions.md
        ‚îú‚îÄ‚îÄ üìÑ manifest.json
        ‚îú‚îÄ‚îÄ üìÑ workflows.md
        ‚îú‚îÄ‚îÄ üìÑ rotation.md               # optional but recommended
        ‚îî‚îÄ‚îÄ üìÅ assets/
            ‚îî‚îÄ‚îÄ üìÑ <optional_files>
~~~

### Per-app folder contract

For every `.github/apps/<app_slug>/`:

- `permissions.md` (required)
  - Explicit permission list + justification (why each permission is needed).
  - Map each permission to the workflow job(s) and GitHub operations it enables.
  - Include why the workflow cannot use `GITHUB_TOKEN` (if applicable).
- `manifest.json` (required)
  - **Secret-free** GitHub App manifest (safe to commit).
  - No private keys, webhook secrets, installation tokens, or org-specific secrets.
- `workflows.md` (required)
  - Which workflows/jobs depend on the app.
  - Which secrets are expected **by name only** (never include secret values).
  - Expected installation scope (org vs repo) and required repositories.
- `rotation.md` (optional, recommended)
  - Key rotation cadence, steps, and incident-response pointers (high-level; no secrets).
- `assets/` (optional)
  - Diagrams/screenshots or supporting docs safe to publish.

Naming guidance:

- `<app_slug>` should be stable, kebab-case, and safe to expose publicly (e.g., `kfm-catalog-publisher`).
- Prefer 1 app per distinct automation role over ‚Äúone app to rule them all‚Äù (enables least privilege).

## üß≠ Context

### Background

- KFM uses CI/CD to keep **data ‚Üí catalogs ‚Üí graph ‚Üí APIs ‚Üí UI ‚Üí Story Nodes ‚Üí Focus Mode** synchronized and reviewable.
- GitHub Apps are preferred over long-lived personal tokens for GitHub API automation (scoped permissions + auditable installations).

### Authentication strategy (decision guidance)

Use the least-privileged option that satisfies the requirement:

- Prefer **`GITHUB_TOKEN`** when interacting only within the current repo and default permissions are sufficient.
- Prefer **OIDC** when authenticating to external cloud resources (e.g., object storage / compute). *(OIDC does not replace GitHub App auth for GitHub API calls.)*
- Use a **GitHub App** when you need any of the following:
  - org-level operations, multi-repo operations, or controlled write access across repositories
  - a more restrictive permission footprint than a broadly-scoped token
  - clearer auditability and separation of duties between automations

### Assumptions

- This repository may be public; anything committed under `.github/apps/**` must be safe to disclose.
- Secrets are managed via GitHub Environments/Secrets or an external secret manager (never stored in git).
- CI gates should ‚Äúvalidate if present; fail if invalid; skip if not applicable‚Äù where appropriate.

### Constraints / invariants

- Preserve canonical ordering: **ETL ‚Üí STAC/DCAT/PROV ‚Üí Graph ‚Üí APIs ‚Üí UI ‚Üí Story Nodes ‚Üí Focus Mode**.
- Frontend consumes data via **contracted APIs** (no direct graph access from UI).
- Never commit private keys, webhook secrets, installation tokens, or credential values into this directory.
- If an app/workflow writes to governed artifacts (e.g., `data/**`, `docs/reports/**`, `mcp/**`):
  - outputs must be deterministic and diffable,
  - outputs must land in canonical homes (`data/stac/`, `data/catalog/dcat/`, `data/prov/`, `docs/reports/story_nodes/`, etc.),
  - validation must run before any publish/merge step (schemas, catalogs, provenance, tests).

### Security & sensitivity notes

- Store GitHub App private keys and webhook secrets only in secret storage.
- Ensure workflows do not echo tokens in logs; redact secrets in any debug output.
- Permission increases require explicit security review and justification.

### Open questions

| Question | Owner | Target date |
|---|---|---|
| Which GitHub Apps are installed and used for this repo/org? | TBD | TBD |
| Do we require org-level installs for any automation, or repo-level only? | TBD | TBD |
| Which workflows (if any) publish STAC/DCAT/PROV, graph fixtures, or Story Nodes via app credentials? | TBD | TBD |

### Future extensions

- Add `.github/apps/inventory.md` listing every installed app, installation scope (org/repo), and the workflows/jobs that depend on it.
- Standardize `rotation.md` per app (key rotation cadence + incident response pointers).
- Add a lightweight validator (CI) to enforce the per-app folder contract (presence + link checks + secret scan).

## üó∫Ô∏è Diagrams

### System / dataflow diagram

~~~mermaid
flowchart LR
  PR[Pull Request] --> WF[GitHub Actions Workflow]
  WF --> VAL[Validation Jobs]
  WF --> AUTH[Auth Strategy]
  AUTH -->|GitHub App| APP[GitHub App Auth]
  AUTH -->|Default| GT[GITHUB_TOKEN]
  APP --> GH[GitHub API]
  GT --> GH
  WF --> PIPE[Pipeline Jobs (optional)]
  PIPE --> CAT[STAC/DCAT/PROV (optional)]
  CAT --> GRAPH[Graph ingest (optional)]
  GRAPH --> API[API boundary]
  API --> UI[UI + Focus Mode]
  WF --> ART[Artifacts: logs/reports]
~~~

### Optional: sequence diagram (GitHub App path)

~~~mermaid
sequenceDiagram
  participant Dev as Contributor
  participant GH as GitHub
  participant WF as Actions Workflow
  participant App as GitHub App
  participant SS as Secret Storage

  Dev->>GH: Open PR
  GH->>WF: Trigger workflow
  WF->>SS: Read app credentials (names only in repo)
  WF->>App: Request installation token (using stored private key)
  App-->>WF: Short-lived token
  WF->>GH: Comment/status/update checks
~~~

## üì¶ Data & Metadata

### Inputs

| Input | Format | Where from | Validation / constraints |
|---|---|---|---|
| App manifest | JSON | `.github/apps/<app_slug>/manifest.json` | Must be secret-free; JSON parse; secret scan |
| Permission justification | Markdown | `.github/apps/<app_slug>/permissions.md` | Must map permissions ‚Üí workflow jobs; least privilege |
| Workflow mapping | Markdown | `.github/apps/<app_slug>/workflows.md` | Links should match `.github/workflows/**` (where possible) |
| Secrets (names only) | N/A | GitHub Secrets/Environments / external secret manager | Names may be documented; values must never appear in repo |
| Workflow triggers | GitHub event payload | GitHub Actions | Governed by workflow config (out of scope here) |

### Outputs

| Output | Format | Where recorded | Contract / notes |
|---|---|---|---|
| Repo documentation | Markdown | `.github/apps/**` | Must follow KFM Markdown protocol |
| CI logs & artifacts | Logs / artifacts | GitHub Actions UI | Avoid leaking tokens; redact secrets |
| Catalog outputs (if generated) | STAC / DCAT / PROV | `data/stac/`, `data/catalog/dcat/`, `data/prov/` | Validate against schemas before publish |
| Story outputs (if generated) | Markdown + assets | `docs/reports/story_nodes/` | Must include provenance + citations; governance review required |

### Sensitivity & redaction

- Treat anything under `.github/apps/**` as public-facing documentation.
- Never include or paste: private keys, webhook secrets, installation tokens, or credential values.
- Avoid printing tokens to logs; ensure debug modes redact secrets.

### Quality signals

- Every app has required files (`permissions.md`, `manifest.json`, `workflows.md`).
- Permission deltas are reviewed by security reviewers (least privilege).
- Secret scan passes (no credentials committed).
- Links to workflows and governance references resolve (or are explicitly labeled ‚Äúnot confirmed in repo‚Äù).

## üåê STAC, DCAT & PROV Alignment

> GitHub Apps do not inherently produce STAC/DCAT/PROV, but they may be used by workflows that run KFM pipelines that do.

### STAC

- If a workflow uses a GitHub App to run catalog generation, outputs must land in `data/stac/` (collections + items).
- Ensure item/collection integrity and stable IDs before publishing.

### DCAT

- If produced, DCAT discovery outputs must land in `data/catalog/dcat/` and remain schema-valid.

### PROV-O

- If produced, provenance bundles must land in `data/prov/` and include run identifiers and traceability metadata.

### Versioning

- Any automation that writes governed artifacts must be deterministic and diffable.
- Prefer explicit version bumps and traceability pointers (run IDs, commit hashes) for publish steps.

## üß± Architecture

### Components (high level)

| Component | Responsibility | Notes |
|---|---|---|
| GitHub Actions workflows | Trigger, validate, run pipelines, publish artifacts | `.github/workflows/**` |
| GitHub App integration | Scoped GitHub API access for automation | Defined by manifest + permissions docs |
| Secret storage | Store private keys/webhook secrets | GitHub Secrets/Environments or external manager |
| Validators / gates | Secret scan, schema validation, link checks, tests | Prefer repo-local composite actions where applicable |
| KFM pipelines | Produce catalogs/graph/API/UI/story artifacts | Code in `src/pipelines/**`; outputs in `data/**`/`docs/**` |

### Interfaces / contracts

| Interface | Contract | Where defined |
|---|---|---|
| Per-app folder contract | Required files and content expectations | This README + per-app docs |
| Markdown governance | KFM Markdown protocol + templates | `docs/templates/**` + `docs/standards/**` *(some may be not confirmed in repo)* |
| Pipeline contract | Ordering + canonical homes | `docs/MASTER_GUIDE_v12.md` |
| Schema validation | STAC/DCAT/PROV/story/ui/telemetry schemas | `schemas/**` *(if present)* |
| API boundary | UI must consume via APIs, not graph directly | `src/server/**` + API contracts *(location may vary)* |

### Extension points checklist (when adding a new GitHub App)

- [ ] Create `.github/apps/<app_slug>/` with required files
- [ ] Document permissions with least-privilege justification
- [ ] Document secrets by **name only** (and where they live)
- [ ] Map the app to specific workflows/jobs
- [ ] Add security review requirement for permission increases
- [ ] If the workflows publish governed artifacts:
  - [ ] ETL outputs land in `data/**` (raw/work/processed as appropriate)
  - [ ] STAC outputs land in `data/stac/**`
  - [ ] DCAT outputs land in `data/catalog/dcat/**`
  - [ ] PROV outputs land in `data/prov/**`
  - [ ] Graph ingest aligns to `src/graph/**` and graph fixtures rules
  - [ ] API/UI/Story changes remain behind contracted boundaries and validation gates
  - [ ] Telemetry signals recorded (if present) under `docs/telemetry/**` and schema-valid

## üìñ Story Node & Focus Mode Integration

### How this work surfaces in Focus Mode

- This document is primarily operational, but it governs authentication used by workflows that may generate:
  - catalogs (STAC/DCAT/PROV),
  - graph ingest fixtures,
  - API contract snapshots,
  - UI layer registries,
  - Story Nodes and Focus Mode narrative bundles.

### Provenance-linked narrative rule

- If a GitHub App‚Äìauthenticated workflow writes any narrative-facing artifact (e.g., `docs/reports/story_nodes/**`), it must enforce:
  - provenance links (run IDs / dataset IDs),
  - citations/evidence pointers for factual claims,
  - explicit labeling of fact vs inference vs hypothesis,
  - adherence to ‚Äúdo not infer sensitive locations.‚Äù

### Optional structured controls (for workflows that publish narratives)

~~~yaml
# Example (optional): publish controls a workflow may reference
publish_controls:
  allow_story_publish: false
  require_human_review: true
  require_provenance_bundle: true
  require_schema_validation: true
~~~

## üß™ Validation & CI/CD

### Validation steps

- [ ] Secret scan passes (no keys/tokens in `.github/apps/**`)
- [ ] `permissions.md`, `manifest.json`, `workflows.md` exist for every `.github/apps/<app_slug>/`
- [ ] Any permission change is reviewed by a security reviewer
- [ ] Workflows referencing the app are updated and still pass
- [ ] Documentation updated (this README + per-app docs)
- [ ] If the workflow generates governed artifacts, run appropriate validation:
  - schema validation (STAC/DCAT/PROV/story/ui/telemetry) where applicable
  - link checks
  - tests for pipelines/graph/api/ui (as applicable)

### Reproduction (high level)

To recreate an app from a manifest:

1. Use the secret-free manifest file in `.github/apps/<app_slug>/manifest.json`
2. Create/install the app in the GitHub UI (org/repo settings)
3. Store the generated private key and webhook secret in secret storage
4. Update workflows to reference secrets **by name** (never copy secrets into git)
5. Verify permissions and workflow mapping in `.github/apps/<app_slug>/workflows.md`

### Telemetry signals (if applicable)

| Signal | Source | Where recorded |
|---|---|---|
| App permission changes | PR review + GitHub audit logs | `docs/telemetry/` *(if present)* |
| Workflow auth failures | Actions logs | `docs/telemetry/` *(if present)* |
| Unexpected repo writes | GitHub audit logs | Security incident process |

## ‚öñ FAIR+CARE & Governance

### Review gates

- Permission increases and any automation that writes to governed outputs (e.g., `data/`, `docs/reports/`, `mcp/`) should be reviewed by:
  - CI owners
  - a security reviewer
  - and (if narrative-facing) governance/review gate owners

### CARE / sovereignty considerations

- If an app/workflow processes culturally sensitive or restricted information, follow:
  - redaction/generalization rules
  - access controls
  - and any sovereignty constraints referenced in the governance docs

### AI usage constraints

- Ensure this document‚Äôs AI permissions/prohibitions match intended use (see front matter).
- Do not use automated tooling to infer sensitive locations or generate new policy text.

## üï∞Ô∏è Version History

| Version | Date | Summary | Author |
|---|---|---|---|
| v1.0.0 | 2025-12-26 | Initial README for `.github/apps/` | TBD |
| v1.0.1 | 2025-12-28 | Align to KFM Universal template + Master Guide invariants; add Data/Metadata, STAC/DCAT/PROV alignment, architecture + Story/Focus integration guidance | TBD |

---

Footer refs (canonical pointers):

- Master Guide: `docs/MASTER_GUIDE_v12.md`
- Redesign blueprint (if adopted): `docs/architecture/KFM_REDESIGN_BLUEPRINT_v13.md`
- Universal template: `docs/templates/TEMPLATE__KFM_UNIVERSAL_DOC.md`
- Glossary (expected): `docs/glossary.md`
- Markdown work protocol: `docs/standards/KFM_MARKDOWN_WORK_PROTOCOL.md` *(not confirmed in repo)*
- Governance: `docs/governance/ROOT_GOVERNANCE.md`
- Ethics: `docs/governance/ETHICS.md`
- Sovereignty: `docs/governance/SOVEREIGNTY.md`

---
title: "GitHub App ‚Äî <app_name> (Repository Automation)"
path: ".github/apps/<app_slug>/README.md"
version: "v1.0.0"
last_updated: "2025-12-29"
status: "draft"
doc_kind: "Guide"
license: "CC-BY-4.0"

markdown_protocol_version: "KFM-MDP v11.2.6"
mcp_version: "MCP-DL v6.3"
ontology_protocol_version: "KFM-ONTO v4.1.0"
pipeline_contract_version: "KFM-PPC v11.0.0"
stac_profile: "KFM-STAC v11.0.0"
dcat_profile: "KFM-DCAT v11.0.0"
prov_profile: "KFM-PROV v11.0.0"

governance_ref: "docs/governance/ROOT_GOVERNANCE.md"
ethics_ref: "docs/governance/ETHICS.md"
sovereignty_policy: "docs/governance/SOVEREIGNTY.md"
fair_category: "FAIR+CARE"
care_label: "TBD"
sensitivity: "public"
classification: "open"
jurisdiction: "US-KS"

doc_uuid: "urn:kfm:doc:github:app:<app_slug>:readme:v1.0.0"
semantic_document_id: "kfm-github-app-<app_slug>-readme-v1.0.0"
event_source_id: "ledger:kfm:doc:github:app:<app_slug>:readme:v1.0.0"
commit_sha: "<latest-commit-hash>"

ai_transform_permissions:
  - "summarize"
  - "structure_extract"
  - "translate"
  - "keyword_index"

ai_transform_prohibited:
  - "generate_policy"
  - "infer_sensitive_locations"

doc_integrity_checksum: "sha256:<calculate-and-fill>"
---

# GitHub App ‚Äî <app_name> (Repository Automation)

## üìò Overview

### Purpose

- Define the **per-app contract** for `<app_name>` (`<app_slug>`) so maintainers and reviewers can evaluate:
  - **why the app exists**,  
  - **what permissions it has** (and why),
  - **which workflows/jobs are allowed to use it**, and
  - **how credentials are handled** (secret names only; never values).
- Keep repository automation aligned with KFM‚Äôs canonical ordering:
  **ETL ‚Üí STAC/DCAT/PROV ‚Üí Graph ‚Üí APIs ‚Üí UI ‚Üí Story Nodes ‚Üí Focus Mode**.
- Provide a single entrypoint for security review and operational ownership.

### Scope

| In Scope | Out of Scope |
|---|---|
| App intent + ownership; installation scope (org/repo) and target repos; permission justification pointers; workflow/job mapping pointers; secret names + storage location; rotation/runbook pointer; publish guardrails for governed artifacts | Private keys, webhook secrets, installation tokens, and any credential values; writing new governance policy; defining GitHub Actions workflows (referenced only); bypassing review gates |

### Audience

- Primary: app owners, repo maintainers, CI/CD owners, security reviewers
- Secondary: contributors who need to understand why the integration exists and what it is allowed to do

### Definitions (link to glossary)

- Link: `docs/glossary.md` *(expected canonical location; if missing, replace with repo‚Äôs glossary path)*
- Terms used in this doc:
  - **GitHub App**: GitHub-native integration with scoped permissions and auditable installations.
  - **App manifest**: secret-free JSON definition used to create/configure an app.
  - **Installation**: org/repo installation that grants access within scope.
  - **Private key / webhook secret**: credentials generated by GitHub (never commit).
  - **Installation token**: short-lived token minted at runtime (never commit).
  - **Least privilege**: only the permissions required for the workflow jobs listed here.
  - **GITHUB_TOKEN**: default workflow token; preferred where sufficient.
  - **OIDC**: preferred for external cloud auth; not a replacement for GitHub App auth for GitHub API operations.

### Key artifacts (what this doc points to)

| Artifact | Path / Identifier | Owner | Notes |
|---|---|---|---|
| Global GitHub Apps guide | `.github/apps/README.md` | Repo maintainers | Folder contract + repo-wide rules |
| Apps inventory | `.github/apps/inventory.md` | Repo maintainers | Installed apps, scopes, and usage |
| Per-app README | `.github/apps/<app_slug>/README.md` | App owner | This document |
| App manifest | `.github/apps/<app_slug>/manifest.json` | App owner | Secret-free |
| Permission justification | `.github/apps/<app_slug>/permissions.md` | App owner + security | Source of truth for least privilege |
| Workflow mapping | `.github/apps/<app_slug>/workflows.md` | CI owners | Workflows/jobs that may use this app |
| Rotation/runbook | `.github/apps/<app_slug>/rotation.md` *(recommended)* | App owner | High-level; no secrets |
| Master Guide | `docs/MASTER_GUIDE_v12.md` | KFM maintainers | Canonical ordering + contracts |

### Quick facts (fill in)

| Field | Value |
|---|---|
| App name | `<app_name>` |
| App slug | `<app_slug>` |
| App homepage (optional) | `<link>` |
| Installation scope | `<org>` / `<repo>` |
| Target repositories | `<org>/<repo>` (list) |
| Owner / steward | `@<team_or_person>` |
| Security reviewer | `@<team_or_person>` |
| Primary purpose | `<one sentence>` |
| Creates/modifies content? | `yes/no` (if yes, list allowed paths below) |

### Definition of done (for this document)

- [ ] Front-matter complete + valid (`path`, `version`, `last_updated`)
- [ ] Installation scope + target repositories documented
- [ ] `permissions.md`, `manifest.json`, `workflows.md` exist and are linked
- [ ] Secrets documented by **name only**; values never appear in repo
- [ ] Workflows/jobs that use this app are explicitly listed (and reviewed)
- [ ] If any governed artifacts may be written, allowed paths and publish gates are documented
- [ ] Validation steps below are repeatable
- [ ] Governance + CARE/sovereignty considerations explicitly stated

## üóÇÔ∏è Directory Layout

### This document

- `path`: `.github/apps/<app_slug>/README.md` *(must match front-matter)*

### Related repository paths

| Area | Path | What lives here |
|---|---|---|
| CI | `.github/` | Workflows + policy gates |
| GitHub Apps | `.github/apps/` | App manifests + permission/runbooks (secret-free) |
| Workflows | `.github/workflows/` | Workflows that may use app auth |
| Documentation | `docs/` | Canonical governed docs |
| Pipelines | `src/pipelines/` | ETL + catalog transforms |
| Graph | `src/graph/` | Ontology bindings, ingest/migrations |
| API boundary | `src/server/` | Contracted API layer + redaction |
| UI | `web/` | React + MapLibre (+ optional Cesium) |
| Story Nodes | `docs/reports/story_nodes/` *(pattern)* | Draft/published narratives (if adopted) |
| Catalog outputs | `data/stac/` + `data/catalog/dcat/` + `data/prov/` | STAC/DCAT/PROV outputs (when pipelines run) |

### Expected file tree for this app

~~~text
üìÅ .github/
‚îî‚îÄ‚îÄ üìÅ apps/
    ‚îî‚îÄ‚îÄ üìÅ <app_slug>/
        ‚îú‚îÄ‚îÄ üìÑ README.md
        ‚îú‚îÄ‚îÄ üìÑ manifest.json
        ‚îú‚îÄ‚îÄ üìÑ permissions.md
        ‚îú‚îÄ‚îÄ üìÑ workflows.md
        ‚îú‚îÄ‚îÄ üìÑ rotation.md                  # optional but recommended
        ‚îî‚îÄ‚îÄ üìÅ assets/
            ‚îî‚îÄ‚îÄ üìÑ <optional_files>
~~~

## üß≠ Context

### Background

- Why does `<app_name>` exist instead of using `GITHUB_TOKEN`?
  - `<fill in: org-level operations, cross-repo writes, checks, approvals, etc.>`
- Which GitHub operations does it enable?
  - `<fill in: create check-runs, create PRs, push commits, manage releases, etc.>`

### Assumptions

- Anything committed in `.github/apps/**` is safe to disclose publicly (secret-free).
- Secrets are stored in GitHub Environments/Secrets or an external secret manager.
- This app must follow least privilege and should be used only by the workflows listed in `workflows.md`.

### Constraints / invariants

- Preserve canonical ordering:
  **ETL ‚Üí STAC/DCAT/PROV ‚Üí Graph ‚Üí APIs ‚Üí UI ‚Üí Story Nodes ‚Üí Focus Mode**.
- UI never reads Neo4j directly; all access is via contracted APIs.
- Never commit private keys, webhook secrets, installation tokens, or credential values.
- If this app is used by workflows that write governed outputs (`data/**`, `docs/reports/**`, `mcp/**`):
  - outputs must be deterministic and diffable,
  - outputs must land in canonical homes,
  - validation must run before publish/merge steps.

### Allowed repository writes (declare explicitly)

If this app has **any** write capability (e.g., `contents: write`), document allowed paths:

| Path prefix | Allowed? | Notes |
|---|---:|---|
| `data/raw/**` | ‚òê | |
| `data/work/**` | ‚òê | |
| `data/processed/**` | ‚òê | |
| `data/stac/**` | ‚òê | |
| `data/catalog/dcat/**` | ‚òê | |
| `data/prov/**` | ‚òê | |
| `docs/reports/story_nodes/**` | ‚òê | |
| `mcp/runs/**` | ‚òê | |
| `releases/**` | ‚òê | |

### Open questions

| Question | Owner | Target date |
|---|---|---|
| What is the installation scope (org vs repo) for `<app_name>`? | TBD | TBD |
| Which repositories are included/excluded from the installation? | TBD | TBD |
| Which workflows/jobs are the only approved consumers of this app token? | TBD | TBD |
| Does this app ever publish governed artifacts (STAC/DCAT/PROV/story bundles)? | TBD | TBD |

### Future extensions

- Add/verify this app entry in `.github/apps/inventory.md` (single source of truth for installed apps).
- Add a CI validator that ensures:
  - required files exist,
  - `manifest.json` parses,
  - secrets are not present,
  - workflow links resolve.

## üó∫Ô∏è Diagrams

### System / dataflow diagram (GitHub App usage)

~~~mermaid
flowchart LR
  EVT[GitHub Event] --> WF[Workflow Job(s)]
  WF --> AUTH[Mint short-lived token]
  AUTH -->|uses private key in secret storage| APP[GitHub App]
  APP --> TOK[Installation Token]
  TOK --> GHAPI[GitHub API Operations]

  WF --> PL[Optional: Run KFM pipelines]
  PL --> CAT[Optional: STAC/DCAT/PROV]
  CAT --> G[Optional: Neo4j Graph]
  G --> API[Contracted APIs]
  API --> UI[UI]
  UI --> SN[Story Nodes]
  SN --> FM[Focus Mode]
~~~

### Optional: sequence diagram (token mint path)

~~~mermaid
sequenceDiagram
  participant GH as GitHub
  participant WF as Actions Workflow
  participant SS as Secret Storage
  participant App as GitHub App

  GH->>WF: Trigger workflow
  WF->>SS: Read secret(s) (names only documented in repo)
  WF->>App: Sign JWT / request installation token
  App-->>WF: Short-lived installation token
  WF->>GH: Perform GitHub API operations within granted permissions
~~~

## üì¶ Data & Metadata

### Inputs

| Input | Format | Where from | Validation / constraints |
|---|---|---|---|
| App manifest | JSON | `.github/apps/<app_slug>/manifest.json` | Must be secret-free; JSON parse; secret scan |
| Permission justification | Markdown | `.github/apps/<app_slug>/permissions.md` | Must map permissions ‚Üí workflows/jobs; least privilege |
| Workflow mapping | Markdown | `.github/apps/<app_slug>/workflows.md` | Links should match `.github/workflows/**` where possible |
| Secrets (names only) | N/A | GitHub Secrets/Environments or external secret manager | Names may be documented; values must never appear in repo |
| GitHub event payload | JSON | GitHub Actions runtime | Governed by workflow configuration |

### Outputs

| Output | Format | Where recorded | Contract / notes |
|---|---|---|---|
| GitHub API effects | GitHub objects | GitHub audit logs / UI | Must be within approved permissions and workflow scope |
| CI logs & artifacts | Logs / artifacts | GitHub Actions UI | Must not leak tokens; redact secrets |
| Governed artifacts (if any) | STAC/DCAT/PROV / Markdown | `data/**`, `docs/**`, `mcp/**` | Must be deterministic + validated before publish |

### Secrets & redaction (names only)

Fill in and keep current:

| Secret purpose | Secret name | Storage location | Rotated? |
|---|---|---|---|
| App private key | `<SECRET_NAME_APP_PRIVATE_KEY>` | `<GitHub Environment / external manager>` | ‚òê yes / ‚òê no |
| App ID | `<SECRET_NAME_APP_ID>` | `<GitHub Environment / external manager>` | ‚òê yes / ‚òê no |
| Installation ID (if required) | `<SECRET_NAME_INSTALLATION_ID>` | `<GitHub Environment / external manager>` | ‚òê yes / ‚òê no |
| Webhook secret (if used) | `<SECRET_NAME_WEBHOOK_SECRET>` | `<external manager>` | ‚òê yes / ‚òê no |

Rules:

- Never store secret **values** in git.
- Never echo tokens into logs.
- Document secret names only and the environment/location where they live.

## üåê STAC, DCAT & PROV Alignment

> This GitHub App does not itself define STAC/DCAT/PROV artifacts, but it may be used by workflows that run KFM pipelines which do.

### STAC

If app-authenticated workflows generate STAC:

- Outputs must land in `data/stac/` (collections + items).
- Ensure stable IDs and item‚Üîcollection integrity.
- Validate schema before publish/merge steps.

### DCAT

If produced:

- Outputs must land in `data/catalog/dcat/`.
- Keep dataset identifiers stable and schema-valid.

### PROV-O

If produced:

- Outputs must land in `data/prov/`.
- Include run identifiers and traceability metadata that links:
  source inputs ‚Üí transform activity ‚Üí derived outputs.

### Versioning expectations

- Any automation that writes governed artifacts must be deterministic and diffable.
- Prefer explicit version bumps, run IDs, and commit hashes for publish steps.

## üß± Architecture

### Responsibilities

- This app exists to provide **scoped GitHub API access** for:
  - `<list the approved responsibilities>`
- This app must not be used as a generic ‚Äúwrite-anything‚Äù token.

### Interfaces / contracts

| Interface | Contract | Where defined |
|---|---|---|
| App file contract | Required per-app files + content expectations | `.github/apps/README.md` + this doc |
| Permission justification | Least privilege + mapping to workflows/jobs | `.github/apps/<app_slug>/permissions.md` |
| Workflow usage scope | Approved workflows/jobs and required secrets (names only) | `.github/apps/<app_slug>/workflows.md` |
| Pipeline ordering | No stage bypass; contract-first expectations | `docs/MASTER_GUIDE_v12.md` |

### Operational runbook pointer (no secrets)

- Rotation / incident notes: `.github/apps/<app_slug>/rotation.md` *(recommended)*

## üß† Story Node & Focus Mode Integration

### When this app touches narrative-facing artifacts

If any workflow using this app writes to `docs/reports/story_nodes/**` (or other narrative surfaces), it must enforce:

- provenance links (run IDs / dataset IDs),
- citations/evidence pointers for factual claims,
- explicit labeling of fact vs inference vs hypothesis,
- adherence to ‚Äúdo not infer sensitive locations.‚Äù

### Optional publish controls (for workflows that publish narratives)

~~~yaml
publish_controls:
  allow_story_publish: false
  require_human_review: true
  require_provenance_bundle: true
  require_schema_validation: true
~~~

## üß™ Validation & CI/CD

### Validation steps (minimum)

- [ ] Secret scan passes (no keys/tokens/credential values in `.github/apps/<app_slug>/**`)
- [ ] Required files exist: `README.md`, `manifest.json`, `permissions.md`, `workflows.md`
- [ ] `manifest.json` parses as JSON and contains no secret fields/values
- [ ] `permissions.md` maps each permission ‚Üí workflow job(s) and GitHub operations
- [ ] `workflows.md` references real workflows/jobs (links resolve where possible)
- [ ] Permission increases are explicitly reviewed by a security reviewer
- [ ] If governed artifacts are written, required validators run (schemas/tests/link checks)

### Reproduction (high level)

To recreate the app from `manifest.json` (no secrets):

1. Use `.github/apps/<app_slug>/manifest.json` as the source of truth.
2. Create/install the app in the GitHub UI (org/repo settings).
3. Store generated credentials in secret storage:
   - private key (secret),
   - webhook secret (if any),
   - any required IDs.
4. Update workflows to reference secrets **by name only**.
5. Verify permissions and scope match `permissions.md` and `workflows.md`.

## ‚öñ FAIR+CARE & Governance

### Review gates

- Permission increases require explicit review by:
  - CI owners (workflow impact),
  - security reviewers (least privilege),
  - and (if narrative-facing) governance/story reviewers.

### CARE / sovereignty considerations

- If workflows using this app process culturally sensitive or restricted information, follow:
  - redaction/generalization rules,
  - access controls and audit expectations,
  - sovereignty constraints referenced in the governance docs.

### AI usage constraints

- Ensure AI permissions/prohibitions in the front matter match intended use.
- Do not use automation to infer sensitive locations.
- Do not treat this doc as a place to generate new policy text.

## üï∞Ô∏è Version History

| Version | Date | Summary | Author |
|---|---|---|---|
| v1.0.0 | 2025-12-29 | Initial per-app README scaffold (contract-first + least-privilege + workflow mapping) | TBD |

---

Footer refs (canonical pointers):

- Global GitHub Apps guide: `.github/apps/README.md`
- Apps inventory: `.github/apps/inventory.md`
- Master Guide: `docs/MASTER_GUIDE_v12.md`
- Universal template: `docs/templates/TEMPLATE__KFM_UNIVERSAL_DOC.md`
- Governance: `docs/governance/ROOT_GOVERNANCE.md`
- Ethics: `docs/governance/ETHICS.md`
- Sovereignty: `docs/governance/SOVEREIGNTY.md`
- Markdown work protocol: `docs/standards/KFM_MARKDOWN_WORK_PROTOCOL.md` *(not confirmed in repo)*

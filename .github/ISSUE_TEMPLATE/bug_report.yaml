# ğŸ Kansas Frontier Matrix â€” Bug Report Template
# File: .github/ISSUE_TEMPLATE/bug_report.yaml
# Purpose: Standardized issue form for reporting software, data, or workflow errors.
# Alignment: MCP-DL v6.3 Â· KFM-MDP v11.0 Â· FAIR+CARE Â· Diamondâ¹ Î© / CrownâˆÎ©
# SPDX-License-Identifier: CC-BY-4.0

name: "ğŸ Bug Report"
description: "Report an error, malfunction, or unexpected behavior in the Kansas Frontier Matrix system."
title: "Bug: [Short Description]"
labels:
  - "bug"
  - "triage"
assignees:
  - "bartytime4life"

body:

  - type: markdown
    attributes:
      value: |
        ## ğŸ Bug Report
        Please describe the issue clearly and reproducibly.
        Reports should comply with **MCP-DL v6.3**, **KFM-MDP v11**, and **FAIR+CARE** governance.

  - type: input
    id: summary
    attributes:
      label: "Summary"
      description: "Short summary of the issue."
      placeholder: "Example: Treaty polygons fail to load on initial map render."
    validations:
      required: true

  - type: textarea
    id: steps_to_reproduce
    attributes:
      label: "Steps to Reproduce"
      description: "List all steps needed to consistently reproduce the issue."
      placeholder: |
        1. Open http://localhost:3000
        2. Enable 'Historical Treaties' layer
        3. Zoom into Kansas region
        4. Observe console error
    validations:
      required: true

  - type: textarea
    id: expected_behavior
    attributes:
      label: "Expected Behavior"
      description: "What should have happened?"
      placeholder: "Example: Map should load and display all treaty polygons."
    validations:
      required: true

  - type: textarea
    id: actual_behavior
    attributes:
      label: "Actual Behavior"
      description: "What actually happened?"
      placeholder: "Example: Console shows `TypeError: Cannot read property 'coordinates' of undefined`."
    validations:
      required: true

  - type: textarea
    id: logs
    attributes:
      label: "Relevant Logs or Screenshots"
      description: "Console logs, stack traces, error objects, screenshots."
      placeholder: |
        ```bash
        Traceback (most recent call last):
          File "src/api/routes/map.py", line 42, in get_layers
            raise ValueError("Missing STAC ID")
        ValueError: Missing STAC ID
        ```
    validations:
      required: false

  - type: input
    id: environment
    attributes:
      label: "Environment Details"
      description: "Platform and version where this issue occurred."
      placeholder: "macOS 14 Â· Chrome 120 Â· Python 3.11 Â· Node 18"
    validations:
      required: true

  - type: dropdown
    id: severity
    attributes:
      label: "Severity Level"
      description: "How severe is this issue?"
      options:
        - "ğŸŸ¥ Critical â€” System crash or data loss"
        - "ğŸŸ§ High â€” Major workflow or feature broken"
        - "ğŸŸ¨ Medium â€” Partial functionality broken"
        - "ğŸŸ© Low â€” Minor or cosmetic issue"
      default: 2
    validations:
      required: true

  - type: dropdown
    id: component
    attributes:
      label: "Affected Component"
      description: "Where is this issue occurring?"
      options:
        - "ETL Pipeline (data ingestion/validation)"
        - "AI/ML Components (Focus Mode, NER, summarization)"
        - "API Layer (FastAPI/GraphQL)"
        - "Frontend (React/MapLibre/Cesium)"
        - "Docs/Workflows (.github actions)"
        - "Other (explain in 'Related Files')"
      default: 0
    validations:
      required: true

  - type: textarea
    id: related_files
    attributes:
      label: "Related Files or Directories"
      description: "If relevant, list affected paths."
      placeholder: |
        e.g.
        - src/pipelines/etl/noaa_ingest.py
        - web/src/components/TimelineView/index.tsx
    validations:
      required: false

  - type: checkboxes
    id: validation_steps
    attributes:
      label: "Pre-Submission Checklist"
      description: "Confirm the following before submitting:"
      options:
        - label: "I have reproduced the issue at least twice."
          required: true
        - label: "I verified the issue still occurs on the latest `main` branch."
          required: true
        - label: "I checked open issues to prevent duplicates."
          required: true
        - label: "I included complete reproduction steps and logs."
          required: true

  - type: markdown
    attributes:
      value: |
        ## ğŸ§© Validation, Governance & Telemetry

        Submitting this bug triggers automated CI/CD workflows:

        - **codeql.yml** â€” Static analysis & security scanning  
        - **docs_validate.yml** â€” KFM-MDP v11 doc & metadata validation  
        - **faircare_validate.yml** â€” FAIR+CARE governance checks  
        - **security_audit.yml** â€” Dependency & container scanning  
        - **telemetry_export.yml** â€” CI/CD & sustainability telemetry logging  

        Governance & telemetry artifacts update automatically:

        ```
        docs/reports/audit/github-workflows-ledger.json
        releases/*/focus-telemetry.json
        ```

        Your report strengthens the KFM ecosystem by ensuring:
        - Reliability  
        - Ethical compliance  
        - Reproducibility  
        - Safety  

        **Â© 2025 Kansas Frontier Matrix â€” MIT / CC-BY 4.0**  
        FAIR+CARE Certified Â· MCP-DL v6.3 Â· KFM-MDP v11.0 Â· KFM-OP v11.0  
        Diamondâ¹ Î© / CrownâˆÎ© Ultimate Certified

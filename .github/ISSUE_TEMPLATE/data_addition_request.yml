# ðŸ—ºï¸ Kansas Frontier Matrix â€” Data Addition Request Template
# File: .github/ISSUE_TEMPLATE/data_addition_request.yml
# Purpose: Governance-aware issue form for proposing the addition of a new dataset/layer/source into KFM.
# Alignment: MCP-DL v6.3 Â· KFM-MDP v11.2.6 Â· KFM-PIPE v11 Â· KFM-ONT v11 Â· FAIR+CARE
# SPDX-License-Identifier: CC-BY-4.0

name: "ðŸ—ºï¸ Data Addition Request"
description: "Request ingestion + catalog registration (STAC/DCAT/PROV) for a new dataset/layer/source in KFM."
title: "Data: [Dataset/Layer Name] â€” [Region] â€” [Time Range]"
labels:
  - "type: data"
  - "triage"
  - "stage: catalogs"
assignees:
  - "bartytime4life"

body:
  - type: markdown
    attributes:
      value: |
        ## ðŸ—ºï¸ Data Addition Request â€” Provenance-First Intake

        This form is the governed front door ðŸšªðŸ§­ for proposing a **new dataset/layer/source** for Kansas Frontier Matrix (KFM).

        **KFM contracts (non-negotiable):**
        - ðŸ§¾ **Provenance-first**: sources + transforms are first-class (STAC/DCAT/PROV)
        - ðŸ”’ **No secrets / no PII / no restricted coordinates** in public issues
        - ðŸ§­ **Stage-aware routing**: ETL â†’ Catalogs â†’ Graph â†’ API â†’ UI â†’ Story â†’ Focus
        - ðŸ§ª **Reproducible**: minimal fixtures + checksums + validation evidence

        > [!IMPORTANT]
        > ðŸ” If this request involves **Confidential/Restricted data**, **Indigenous/CARE-governed knowledge**, or **sensitive locations**, do **NOT** post operational details here.
        > Use the repoâ€™s security/governance reporting path (see `SECURITY.md`) and provide only a high-level summary in this issue.

  - type: input
    id: dataset_name
    attributes:
      label: "Dataset / Layer Name"
      description: "Human-readable name for the dataset/layer/source."
      placeholder: "Example: USGS 3DEP DEM (1/3 arc-second) â€” Kansas"
    validations:
      required: true

  - type: input
    id: dataset_slug_id
    attributes:
      label: "Proposed KFM ID / Slug (optional)"
      description: "Optional proposed ID for catalogs (STAC collection id / dataset slug). Keep it lowercase + hyphenated."
      placeholder: "Example: usgs-3dep-dem-10m-ks"
    validations:
      required: false

  - type: textarea
    id: motivation_use_case
    attributes:
      label: "Motivation / Intended Use"
      description: "Why do we need this dataset in KFM? Include user story + expected outcomes (map layer, analytics, story nodes, etc.)."
      placeholder: |
        Example:
        - User story: As a researcher, I want a statewide DEM to compute slope + watershed features for historical flood narratives.
        - Expected outcomes: UI layer + derived slope raster + citations for Story Nodes.
    validations:
      required: true

  - type: dropdown
    id: pipeline_stage_guess
    attributes:
      label: "Primary Pipeline Stage (best guess)"
      description: "Where does the main work land first? If unsure, pick the closest and explain later."
      options:
        - "ðŸ§° ETL / Pipelines (ingest/transform/tiling/normalization)"
        - "ðŸ—‚ï¸ Catalogs (STAC/DCAT/PROV metadata + discoverability)"
        - "ðŸ•¸ï¸ Graph (entities/relations/citations/timelines)"
        - "ðŸ”Œ API boundary (contracts/authZ/redaction/query behavior)"
        - "ðŸ–¥ï¸ UI / Map viewer (rendering, styling, time slider)"
        - "ðŸŽ¬ Story Nodes (claim â†’ evidence mapping)"
        - "ðŸ§  Focus Mode (evidence-backed summaries)"
        - "ðŸ§ª CI / DevEx (validation gates, workflows)"
        - "â“ Unknown / Not sure"
      default: 1
    validations:
      required: true

  - type: checkboxes
    id: integration_targets
    attributes:
      label: "Integration Targets (check all that apply)"
      description: "Where should this show up once integrated?"
      options:
        - label: "ðŸ—ºï¸ UI map layer (MapLibre/Cesium/WebGL)"
        - label: "ðŸ—‚ï¸ Catalog entry (STAC Collection/Items and/or DCAT Dataset)"
        - label: "ðŸ§¾ Provenance bundle (PROV-O lineage in repo)"
        - label: "ðŸ§  Analytics / modeling (indices, regressions, simulations)"
        - label: "ðŸ•¸ï¸ Knowledge Graph mapping (entities/events/citations)"
        - label: "ðŸ”Œ API exposure (new endpoint/parameter or contract update)"
        - label: "ðŸŽ¬ Story Nodes / narrative evidence support"
        - label: "â±ï¸ Ongoing updates (scheduled ingest/refresh)"
    validations:
      required: false

  - type: markdown
    attributes:
      value: |
        ## ðŸ§¾ Source, Rights, and Licensing

        KFM is **provenance-first**. If license/terms are unknown, state that explicitly and include what you *do* know.

  - type: input
    id: source_authority
    attributes:
      label: "Source Authority (Publisher/Owner)"
      description: "Who produced and/or owns the dataset?"
      placeholder: "Example: USGS / USDA / NASA / Kansas DASC / County GIS Dept."
    validations:
      required: true

  - type: input
    id: source_url
    attributes:
      label: "Source URL / Landing Page"
      description: "Public landing page or documentation link for the dataset. (No private links.)"
      placeholder: "Example: https://..."
    validations:
      required: true

  - type: input
    id: license_terms
    attributes:
      label: "License / Terms of Use"
      description: "Exact license name if known (e.g., CC-BY-4.0, ODbL, Public Domain) + any constraints."
      placeholder: "Example: Public Domain (USGS); or CC-BY-4.0; or 'Terms: attribution + non-commercial'"
    validations:
      required: true

  - type: textarea
    id: license_proof
    attributes:
      label: "License Proof / Citation"
      description: "Where is the license stated? Paste the relevant paragraph excerpt (short) or describe where to find it."
      placeholder: |
        Example:
        - License is stated on the dataset landing page under 'Usage Constraints'.
        - Citation format recommended by publisher: ...
    validations:
      required: false

  - type: input
    id: retrieval_date
    attributes:
      label: "Retrieval / Access Date"
      description: "When did you access or download the dataset (YYYY-MM-DD)?"
      placeholder: "2026-01-10"
    validations:
      required: true

  - type: dropdown
    id: redistribution
    attributes:
      label: "Redistribution in KFM Repo?"
      description: "Can we store the data (or subset) in-repo, or must we reference externally?"
      options:
        - "âœ… Yes â€” redistribution allowed"
        - "âš ï¸ Limited â€” redistribution allowed with constraints (explain)"
        - "ðŸ”— No â€” link/manifest only (no redistribution)"
        - "â“ Unknown â€” needs review"
      default: 3
    validations:
      required: true

  - type: markdown
    attributes:
      value: |
        ## ðŸŒŽ Coverage (Space/Time) & Update Cadence

        > [!CAUTION]
        > If locations are sensitive, provide **generalized** coverage only (county-level, region name, coarse bbox).

  - type: input
    id: spatial_coverage
    attributes:
      label: "Spatial Coverage (general)"
      description: "Region/county/state/corridor. Avoid restricted coordinates."
      placeholder: "Example: Kansas (statewide) / Douglas County / Arkansas River basin"
    validations:
      required: true

  - type: textarea
    id: bbox_generalized
    attributes:
      label: "Bounding Box / Geometry (optional, generalized)"
      description: "Optional generalized bbox/polygon. Do NOT include restricted coordinates."
      placeholder: |
        Example (bbox):
        west: -102.05
        south: 36.99
        east: -94.59
        north: 40.00
    validations:
      required: false

  - type: input
    id: temporal_coverage
    attributes:
      label: "Temporal Coverage"
      description: "Time span represented (YYYY, range, or event window)."
      placeholder: "Example: 1972-2025 / 1854-1900 / 2024-05-01 to 2024-06-30"
    validations:
      required: true

  - type: dropdown
    id: update_cadence
    attributes:
      label: "Update Cadence"
      description: "How often does the source change?"
      options:
        - "ðŸ§Š One-time / static (historical or fixed product)"
        - "ðŸ—“ï¸ Periodic (monthly/quarterly/annual refresh)"
        - "â±ï¸ Near-real-time / rolling updates"
        - "â“ Unknown"
      default: 0
    validations:
      required: true

  - type: markdown
    attributes:
      value: |
        ## ðŸ§° Technical Details (Format, CRS, Scale)

        Help us implement this correctly the first time âœ…

  - type: dropdown
    id: data_type
    attributes:
      label: "Data Type"
      description: "Pick the closest match."
      options:
        - "ðŸ§± Vector (points/lines/polygons)"
        - "ðŸ›°ï¸ Raster (imagery/grids/tiles)"
        - "ðŸ“Š Tabular (CSV/Parquet/etc.)"
        - "ðŸ“„ Documents/Scans (maps, PDFs, reports)"
        - "ðŸ§  Model output (derived/simulated/AI-assisted)"
        - "ðŸ” Mixed / multiple"
      default: 0
    validations:
      required: true

  - type: dropdown
    id: primary_format
    attributes:
      label: "Primary Format"
      description: "What format is the dataset currently in (or desired output format for KFM)?"
      options:
        - "COG / GeoTIFF"
        - "GeoPackage (GPKG)"
        - "GeoJSON"
        - "Shapefile"
        - "PMTiles / MBTiles"
        - "NetCDF / HDF"
        - "Zarr"
        - "CSV"
        - "Parquet"
        - "PDF / Image scans"
        - "Other (explain below)"
      default: 0
    validations:
      required: true

  - type: input
    id: crs_epsg
    attributes:
      label: "CRS / EPSG (if known)"
      description: "Coordinate reference system for spatial assets."
      placeholder: "Example: EPSG:4326 / EPSG:3857 / EPSG:26914"
    validations:
      required: false

  - type: input
    id: resolution_scale
    attributes:
      label: "Resolution / Scale (if applicable)"
      description: "Raster pixel size, vector scale, or nominal scale."
      placeholder: "Example: 10m / 30m / 1:24,000 / 1km grid"
    validations:
      required: false

  - type: textarea
    id: schema_fields
    attributes:
      label: "Schema / Fields (for vector/tabular)"
      description: "List key columns, expected types, and any critical codes/enums."
      placeholder: |
        Example:
        - field: county_name (string)
        - field: year (int)
        - field: yield_bu_ac (float)
        - field: source_id (string)
        - field: quality_flag (string enum: A|B|C)
    validations:
      required: false

  - type: input
    id: estimated_volume
    attributes:
      label: "Estimated Data Volume"
      description: "Approximate size / number of files / feature count."
      placeholder: "Example: ~8 GB; 12 COGs; ~1.2M features"
    validations:
      required: false

  - type: markdown
    attributes:
      value: |
        ## ðŸ§¾ Provenance & Processing Context

        If the dataset is **derived**, include the transformation recipe so we can reproduce it.

  - type: dropdown
    id: dataset_origin
    attributes:
      label: "Origin"
      description: "Is this source data or derived output?"
      options:
        - "ðŸ“¥ Source / raw data (authoritative)"
        - "ðŸ§ª Derived / processed data (from one or more sources)"
        - "ðŸ§  Model output (simulation/ML/analysis result)"
        - "â“ Not sure"
      default: 0
    validations:
      required: true

  - type: textarea
    id: processing_context
    attributes:
      label: "Processing Context (tools + major transforms)"
      description: "Include toolchain and major steps (GDAL/QGIS/GEE/Python/R/etc.)."
      placeholder: |
        Example:
        - Tools: GDAL 3.8, Python 3.11, rasterio, geopandas
        - Steps: reproject -> clip to KS -> build COG -> generate overviews -> validate STAC
        - Notes: mask nodata; resample bilinear; keep original as immutable raw
    validations:
      required: false

  - type: textarea
    id: deliverables
    attributes:
      label: "What can you provide right now?"
      description: "Links, sample subsets, manifests, checksums, draft metadata, etc."
      placeholder: |
        Example:
        - Public URL(s): ...
        - Sample subset: <50MB (redacted if needed)
        - Checksums: sha256 for each file
        - Draft STAC: collection.json + 3 item.json examples
        - Draft DCAT: dataset.jsonld
        - Draft PROV bundle: prov/*.jsonld
    validations:
      required: true

  - type: markdown
    attributes:
      value: |
        ## ðŸ”’ Sensitivity, Sovereignty, and Governance

        KFM is â€œmostly openâ€ ðŸŒ¾ â€” but we protect what must be protected.

  - type: dropdown
    id: sensitivity_class
    attributes:
      label: "Sensitivity Classification"
      description: "Choose the highest applicable class."
      options:
        - "ðŸŒ Public (OK for public issue details)"
        - "ðŸ¢ Internal (limit details; avoid operational specifics)"
        - "ðŸ” Confidential (do not post details here)"
        - "ðŸ§¨ Restricted (do not post; security/governance path only)"
        - "â“ Unknown / Needs review"
      default: 0
    validations:
      required: true

  - type: checkboxes
    id: governance_flags
    attributes:
      label: "Governance Flags (check any that apply)"
      description: "These flags route review gates correctly."
      options:
        - label: "ðŸª¶ CARE / Indigenous knowledge or culturally sensitive context"
        - label: "ðŸ“ Sensitive location(s) (ecological, archaeological, protected sites)"
        - label: "ðŸ§ Contains or could expose PII (directly or by linkage)"
        - label: "ðŸ—ï¸ Critical infrastructure / private facilities / security-relevant"
        - label: "âš–ï¸ License/terms unclear or potentially incompatible"
        - label: "ðŸ§  Involves AI-assisted/ML-derived outputs (needs extra provenance)"
    validations:
      required: false

  - type: textarea
    id: redaction_access_plan
    attributes:
      label: "Redaction / Access Plan (if not fully public)"
      description: "If Internal/Confidential/Restricted, describe how we should handle access (general terms only)."
      placeholder: |
        Example:
        - Only publish generalized geometries (county-level) + remove sensitive attributes.
        - Store raw data outside repo; commit manifest + checksums only.
        - Gate API responses with role-based redaction rules.
    validations:
      required: false

  - type: markdown
    attributes:
      value: |
        ## âœ… Acceptance Criteria (Definition of Done)

        This helps maintainers implement quickly and safely ðŸ§±

  - type: textarea
    id: acceptance_criteria
    attributes:
      label: "Acceptance Criteria (propose)"
      description: "What must be true for this to be considered 'done'?"
      placeholder: |
        Example:
        - STAC Collection + Items validate successfully
        - DCAT record present with license + access URL + temporal/spatial coverage
        - PROV bundle included for ingest/transform
        - Checksums recorded for all assets
        - UI layer renders (if requested) and respects redaction rules
        - Repro steps documented (scripts/notebooks/configs)
    validations:
      required: false

  - type: checkboxes
    id: pre_submission
    attributes:
      label: "Pre-Submission Checklist"
      description: "Required confirmations before submitting."
      options:
        - label: "ðŸ” I did NOT include secrets, credentials, private keys, PII, or restricted coordinates in this issue."
          required: true
        - label: "ðŸ§¾ I provided the best-known source + license/terms + retrieval date."
          required: true
        - label: "ðŸŒŽ I provided spatial + temporal coverage (generalized if sensitive)."
          required: true
        - label: "ðŸ§± I understand data additions are integrated via governed PRs with provenance artifacts (no direct publish)."
          required: true

  - type: textarea
    id: related_context
    attributes:
      label: "Related Links / Issues / Notes"
      description: "Anything else that helps routing (related PRs, prior discussions, relevant docs)."
      placeholder: |
        Example:
        - Related issue: #123
        - Related PR: #456
        - Notes on known quirks: ...
    validations:
      required: false

  - type: markdown
    attributes:
      value: |
        ## ðŸ§­ Maintainers Notes (what weâ€™ll do after submission)

        Typical KFM integration path:
        - ðŸ§° ETL plan (ingest/transform) + fixtures
        - ðŸ—‚ï¸ STAC/DCAT/PROV metadata + validation
        - ðŸ”Œ API exposure (if needed) with contract tests + redaction
        - ðŸ–¥ï¸ UI layer registration (if requested)
        - ðŸŽ¬ Story Node evidence mapping (if requested)

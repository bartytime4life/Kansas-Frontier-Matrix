<div align="center">

# ğŸ’§ Kansas Frontier Matrix â€” Hydrology Checksums

`data/processed/checksums/hydrology/`

**Mission:** Verify and preserve the **integrity and reproducibility** of all processed **hydrology datasets**
through **SHA-256 checksums**, maintaining consistent lineage, provenance, and scientific fidelity
across the Kansas Frontier Matrix (KFM) ecosystem.

[![Build & Deploy](https://github.com/bartytime4life/Kansas-Frontier-Matrix/actions/workflows/site.yml/badge.svg)](../../../../.github/workflows/site.yml)
[![STAC Validate](https://github.com/bartytime4life/Kansas-Frontier-Matrix/actions/workflows/stac-validate.yml/badge.svg)](../../../../.github/workflows/stac-validate.yml)
[![Trivy Security](https://github.com/bartytime4life/Kansas-Frontier-Matrix/actions/workflows/trivy.yml/badge.svg)](../../../../.github/workflows/trivy.yml)
[![Docs Â· MCP](https://img.shields.io/badge/Docs-MCP-blue)](../../../../docs/)
[![License: Data](https://img.shields.io/badge/License-CC--BY%204.0-green)](../../../../LICENSE)
[![License: Code](https://img.shields.io/badge/License-MIT-yellow)](../../../../LICENSE)

</div>

---

## ğŸ§© Versioning

| Field            | Value                                                     |
| :--------------- | :-------------------------------------------------------- |
| **Version**      | `v1.0.2`                                                  |
| **Status**       | Stable                                                    |
| **Maintainer**   | KFM Hydrology & Geoscience Data Team                      |
| **Last Updated** | 2025-10-12                                                |
| **Scope**        | Processed hydrology datasets (`.geojson`, `.tif`, `.csv`) |
| **Compliance**   | MCP v1.0 Â· STAC 1.0.0 Â· SHA-256 Validated                 |

---

## ğŸ“š Overview

This directory houses **SHA-256 checksum manifests (`.sha256`)** validating every processed hydrology dataset in KFM.
These digests form a **verifiable audit chain** from **raw input â†’ ETL process â†’ catalog publication**, ensuring
**data integrity**, **reproducibility**, and **traceable provenance** under the Master Coder Protocol (MCP).

All checksums are auto-generated by the hydrology ETL pipeline (`make hydrology`) and continuously validated in CI/CD workflows.

---

## ğŸ—‚ï¸ Directory Layout

```bash
data/processed/checksums/hydrology/
â”œâ”€â”€ README.md
â”œâ”€â”€ nhd_flowlines_ks.geojson.sha256
â”œâ”€â”€ watersheds_huc12_ks.geojson.sha256
â”œâ”€â”€ fema_nfhl_ks.geojson.sha256
â”œâ”€â”€ groundwater_levels_ks.geojson.sha256
â””â”€â”€ flood_events_ks.geojson.sha256
```

Each `.sha256` maps **1:1** to its dataset in `data/processed/hydrology/`.
CI pipelines re-run `sha256sum -c` to guarantee byte-level consistency and reproducibility.

---

## ğŸ¯ Purpose

| Objective                  | Description                                                |
| :------------------------- | :--------------------------------------------------------- |
| ğŸ§© **Data Integrity**      | Detects file corruption or tampering across environments.  |
| ğŸ” **Reproducibility**     | Confirms deterministic ETL outputs.                        |
| ğŸ”— **Provenance Tracking** | Links digests to STAC Items and metadata for full lineage. |
| âš™ï¸ **CI Enforcement**      | GitHub Actions halt merges when mismatches occur.          |

---

## ğŸ§® Example `.sha256` File

```bash
# File: watersheds_huc12_ks.geojson.sha256
d2a9e4b1f97c3aa923f9025b2cf2058c477f01e8c024a07f68b992b04d789e5f  watersheds_huc12_ks.geojson
```

This digest certifies
`data/processed/hydrology/watersheds_huc12_ks.geojson`
matches its previously validated state exactly.

---

## âš™ï¸ Checksum Generation

Checksums are generated automatically at the completion of the **hydrology ETL pipeline**.

### Makefile Target

```bash
make hydrology-checksums
```

### Python Utility

```bash
python src/utils/generate_checksums.py data/processed/hydrology/ --algo sha256
```

**Steps**

1. Locate processed hydrology outputs (`.geojson`, `.tif`, `.csv`).
2. Compute SHA-256 in binary mode for consistency.
3. Save as `<filename>.sha256`.
4. Validate automatically in CI/CD workflows.

ğŸ’¡ Use `sha256sum --binary` or the Python utility to ensure cross-platform reproducibility.

---

## ğŸ” Validation in CI/CD

GitHub Actions re-verify checksums on every PR, push, and release:

```bash
sha256sum -c data/processed/checksums/hydrology/*.sha256
```

If any mismatch is found, the pipeline **fails immediately**, blocking merges or releases until the dataset is reprocessed and rehashed.
Logs are archived to ensure a **permanent MCP audit trail**.

---

## ğŸ§© Integration with Metadata & STAC

| Linked Component                                | Purpose                                                     |
| :---------------------------------------------- | :---------------------------------------------------------- |
| `data/processed/metadata/hydrology/`            | STAC + metadata JSONs embed SHA-256 digests for validation. |
| `src/pipelines/hydrology/hydrology_pipeline.py` | Orchestrates checksum generation + verification.            |
| `.github/workflows/stac-validate.yml`           | CI job verifying hashes and schema compliance.              |
| `data/stac/hydrology/`                          | Publishes checksums in `assets.checksum:sha256`.            |

---

## ğŸ§­ Mermaid Data Flow

```mermaid
flowchart TD
  A["Hydrology Sources<br/>NHD Â· FEMA Â· Groundwater surveys"] --> B["ETL Process<br/>clean Â· merge Â· normalize"]
  B --> C["Processed Hydrology Data<br/>GeoJSON Â· COG Â· CSV"]
  C --> D["Checksum Generation<br/>sha256sum per file"]
  D --> E["Verification<br/>CI/CD Â· manual audit"]
  E --> F["Catalog & Provenance<br/>STAC Â· MCP metadata"]
  F --> G["Publication<br/>Data Hub Â· GitHub Pages Â· Google Earth"]
%% END OF MERMAID %%
```

---

## ğŸ§  MCP Compliance Summary

| MCP Principle       | Implementation                                                |
| :------------------ | :------------------------------------------------------------ |
| Documentation-first | Each dataset includes `.sha256` + metadata.                   |
| Reproducibility     | Deterministic ETL verified through SHA-256 validation.        |
| Open Standards      | SHA-256 (FIPS 180-4), STAC 1.0, JSON Schema compliant.        |
| Provenance          | Hashes link data lineage from source â†’ ETL â†’ STAC.            |
| Auditability        | CI/CD logs maintain public, reproducible verification trails. |

---

## ğŸ§® Maintenance & Best Practices

* ğŸ”„ **After updates:** Regenerate hashes after reprocessing or ETL changes.
* ğŸ§© **File pairing:** Checksum filenames must match their dataset names exactly.
* ğŸ§¾ **Batch audits:** Use `_manifest_all.sha256` for large-scale validations.
* ğŸ§ª **Pre-commit hook:** Optionally block commits with outdated or missing checksums.
* ğŸ§° **Version bump:** Update STAC + metadata version fields when new hashes are generated.

---

## ğŸ“… Version History

| Version   | Date       | Summary                                                         |
| :-------- | :--------- | :-------------------------------------------------------------- |
| **1.0.2** | 2025-10-12 | Added Mermaid visualization + full MCP/STAC linkage metadata.   |
| **1.0.1** | 2025-10-10 | Improved CI/CD integration + documentation for reproducibility. |
| **1.0.0** | 2025-10-04 | Initial hydrology checksum documentation + manifests.           |

---

## ğŸ“– References

* ğŸ”— [GNU Coreutils â€” SHA Utilities](https://www.gnu.org/software/coreutils/manual/html_node/sha2-utilities.html)
* ğŸŒ [STAC 1.0 Specification](https://stacspec.org)
* ğŸ§© [JSON Schema](https://json-schema.org)
* ğŸ“˜ [MCP Standards](../../../../docs/standards/)
* ğŸ§­ [Data Provenance in Open Science](https://www.nature.com/articles/s41597-019-0193-2)

---

<div align="center">

> **Kansas Frontier Matrix â€” â€œFlowing Data, Verified Integrity.â€**
> ğŸ“ `data/processed/checksums/hydrology/` Â· Linked to the Hydrology STAC Collection

</div>

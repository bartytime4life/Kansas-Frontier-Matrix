---
title: "ğŸ•¸ï¸ KFM `data/graph/` â€” Graph Import Artifacts for Neo4j"
path: data/graph/README.md
doc_kind: repo_readme
status: active
owner: graph-maintainers
version: v1.2.0
last_updated: 2026-01-19
license: "TBD (repo default)"
classification: public
care_label: "n/a"
jurisdiction: "US-KS"
doc_uuid: "kfm:doc:data-graph-readme:v1.2.0"
git_commit: "TBD"
checksum_sha256: "TBD"
---

<div align="center">

# ğŸ•¸ï¸ KFM `data/graph/` â€” Graph Import Artifacts for Neo4j

![KFM](https://img.shields.io/badge/KFM-Kansas%20Frontier%20Matrix-222222)
![Graph](https://img.shields.io/badge/Graph-Neo4j%20(Property%20Graph)-4C8EDA?logo=neo4j&logoColor=white)
![Spatial](https://img.shields.io/badge/Spatial-PostGIS-336791?logo=postgresql&logoColor=white)
![Provenance](https://img.shields.io/badge/Provenance-STAC%20%7C%20DCAT%20%7C%20PROV-6F42C1)
![Policy](https://img.shields.io/badge/Policy%20Pack-OPA%20%2B%20Conftest-0B7285)
![API](https://img.shields.io/badge/API-FastAPI%20%7C%20GraphQL-009688?logo=fastapi&logoColor=white)
![Ethics](https://img.shields.io/badge/Ethics-FAIR%20%2B%20CARE-FF69B4)

**A governed home for graph import artifacts** that build and evolve the **KFM knowledge graph** â€” with **roundâ€‘trip traceability** back to **STAC/DCAT/PROV**.

</div>

---

<a id="system-context-and-invariants"></a>
## ğŸ§­ Nonâ€‘negotiable system order and invariants

> **Raw â†’ ETL â†’ STAC â†’ DCAT â†’ PROV â†’ Graph â†’ API â†’ UI â†’ Story Nodes â†’ Focus Mode**

**If the graph canâ€™t point back to catalogs + lineage, it doesnâ€™t ship.** âœ…

### KFM hard rules for this folder ğŸ§±
- ğŸš« **No â€œmystery nodesâ€**: every node/edge must carry **evidence pointers** (STAC/DCAT) and, when applicable, **lineage pointers** (PROV).
- ğŸ”Œ **API boundary enforced**: UI and Story Nodes **never** read Neo4j directly â€” all access is mediated by API contracts and governance gates.
- ğŸ§ª **Policy pack is law**: CI policy checks (OPA + Conftest) apply to **humans and agents** equally.
- ğŸ§¾ **Provenance-first publishing**: anything visible in Graph/UI must have provenance metadata before promotion.
- â™»ï¸ **Deterministic builds**: artifacts here should be generated by deterministic pipelines (no hand-edited drift).

> [!IMPORTANT]
> `data/graph/` stores **import artifacts**, not â€œtruth.â€  
> Canonical truth lives in **STAC/DCAT/PROV + processed domain outputs**; the graph stores **pointers + relationships**.

---

## âš¡ Quick links

| What | Why it matters | Path |
|---|---|---|
| ğŸ›°ï¸ STAC | Assets and spatial records | `data/stac/` |
| ğŸ—‚ï¸ DCAT | Dataset discoverability + publishing metadata | `data/catalog/dcat/` |
| ğŸ§¬ PROV | Lineage, reproducibility, audit trails | `data/prov/` |
| ğŸ•¸ï¸ Graph import CSV | Bulk import artifacts | `data/graph/csv/` |
| ğŸ§© Cypher | Constraints, migrations, post-import linking | `data/graph/cypher/` |
| ğŸ” Policy pack | CI governance rules (OPA/Rego + Conftest) | `api/scripts/policy/` |
| ğŸ”Œ API boundary | Governed access layer (FastAPI + GraphQL) | `api/` |
| ğŸ—ºï¸ UI | Map + exploration interface | `web/` |
| ğŸ¬ Story Nodes | Governed narratives | `docs/reports/story_nodes/` *(if present)* |

> [!NOTE]
> Some docs reference `data/catalogs/` as a conceptual umbrella. In v13 repo layout, DCAT is typically under `data/catalog/dcat/`.

---

## ğŸ§  At a glance

```mermaid
flowchart LR
  A[ğŸ“¦ Raw Sources] --> B[ğŸ§° ETL + Normalization]
  B --> C[ğŸ›°ï¸ STAC Items + Collections]
  C --> D[ğŸ—‚ï¸ DCAT Datasets]
  C --> E[ğŸ§¬ PROV Bundles]
  D --> F[ğŸ•¸ï¸ Neo4j Graph]
  E --> F
  F --> G[ğŸ”Œ API Boundary]
  G --> H[ğŸ—ºï¸ UI]
  H --> I[ğŸ¬ Story Nodes]
  I --> J[ğŸ§  Focus Mode]
```

---

<a id="table-of-contents"></a>
## ğŸ“Œ Table of contents

- [ğŸ“˜ Overview](#overview)
- [ğŸ§­ System context and invariants](#system-context-and-invariants)
- [ğŸ—‚ï¸ Directory layout](#directory-layout)
- [ğŸ§¾ Graph traceability contract](#graph-traceability-contract)
- [ğŸ§± Ontology and modeling guardrails](#ontology-and-modeling-guardrails)
- [ğŸ“¦ CSV import artifact specs](#csv-import-artifact-specs)
- [ğŸ§© Cypher scripts](#cypher-scripts)
- [ğŸ§ª Validation and CI gates](#validation-and-ci-gates)
- [ğŸ” Governance, privacy, and access control](#governance-privacy-and-access-control)
- [â± Real-time, simulation, and Focus Mode integration](#real-time-simulation-and-focus-mode-integration)
- [âš™ï¸ Performance notes](#performance-notes)
- [ğŸ“š Reference shelf](#reference-shelf)
- [ğŸ•°ï¸ Version history](#version-history)

---

<a id="overview"></a>
## ğŸ“˜ Overview

### Purpose ğŸ¯
`data/graph/` exists so graph imports are:

- âœ… **reviewable** (diffable artifacts, no opaque binary dumps)
- âœ… **reproducible** (generated from deterministic ETL + catalogs)
- âœ… **traceable** (pointers back to STAC/DCAT + PROV lineage)
- âœ… **governed** (UI access only through the API boundary and policy pack gates)

### Scope âœ… / Out of scope âŒ

| âœ… In scope | âŒ Out of scope |
|---|---|
| ğŸ“„ Importable CSV exports | ğŸ—ƒï¸ Full Neo4j store files / db dumps |
| ğŸ§¾ Small fixtures for tests | ğŸ” Secrets, tokens, `.env`, credentials |
| ğŸ§© Constraints, indexes, migrations | ğŸ“¥ Raw source snapshots |
| ğŸ”— Evidence + lineage pointers | ğŸ§‘â€ğŸ¨ UI code or UI â†’ Neo4j direct access |

### Audience ğŸ‘¥
- ğŸ§‘â€ğŸ”¬ Data + graph contributors producing imports for new domains
- ğŸ§  Ontology maintainers reviewing label/relationship changes
- ğŸ”Œ API + Story maintainers validating provenance behavior and redaction

### Definitions ğŸ§¾
- **Evidence pointer**: a link to a canonical catalog record (STAC/DCAT) that supports a node/edge.
- **Lineage pointer**: a link to a PROV activity/entity/bundle describing how the data was produced.
- **Classification**: access tier like `public/internal/confidential/restricted`.
- **CARE label**: sensitivity tag like `culturally_sensitive`, `pii`, `endangered_species`, or `n/a`.
- **Claim node**: an explicit interpretation statement with evidence + confidence, rather than a â€œhard factâ€.

### Key artifacts ğŸ“¦
| Artifact | Location | Why |
|---|---|---|
| Node CSVs | `data/graph/csv/` | Diffable node sets by label/domain/date |
| Relationship CSVs | `data/graph/csv/` | Diffable edge sets by type/domain/date |
| Constraints + indexes | `data/graph/cypher/` | Enforce uniqueness + query speed |
| Migrations | `data/graph/cypher/` | Controlled schema evolution |
| Mapping + ontology docs | `data/graph/docs/` | Prevent drift between ETL and graph |

---

<a id="directory-layout"></a>
## ğŸ—‚ï¸ Directory layout

```text
ğŸ“¦ data/
â””â”€ ğŸ•¸ï¸ graph/
   â”œâ”€ ğŸ“„ README.md
   â”œâ”€ ğŸ“ csv/
   â”‚  â”œâ”€ ğŸ“„ nodes__<Label>__<domain>__<yyyymmdd>.csv
   â”‚  â”œâ”€ ğŸ“„ rels__<TYPE>__<domain>__<yyyymmdd>.csv
   â”‚  â””â”€ ğŸ“„ fixtures__tiny__<purpose>.csv
   â”œâ”€ ğŸ“ cypher/
   â”‚  â”œâ”€ ğŸ“„ constraints__<yyyymmdd>.cypher
   â”‚  â”œâ”€ ğŸ“„ post_import__<domain>__<purpose>__<yyyymmdd>.cypher
   â”‚  â””â”€ ğŸ“„ migrations__<semver>.cypher
   â””â”€ ğŸ“ docs/
      â”œâ”€ ğŸ“„ ontology.md
      â””â”€ ğŸ“„ mapping_rules.md
```

> [!TIP]
> If `data/graph/docs/` doesnâ€™t exist yet, create it. Keeping **ontology + mapping rules** near artifacts reduces drift. ğŸ§²

---

<a id="graph-traceability-contract"></a>
## ğŸ§¾ Graph traceability contract

KFM is a **catalog-driven system**: graph is **derived** from catalogs, not a standalone fact store.

### Minimum required pointers âœ…
For **every** node/edge row, include:

- `classification` â†’ `public/internal/confidential/restricted`
- `care_label` â†’ `n/a` or sensitivity label
- one or more evidence pointers:
  - `evidence_stac_id` â†’ STAC Item/Collection id
  - `evidence_dcat_id` â†’ DCAT Dataset id
- when applicable, lineage pointers:
  - `prov_bundle_id` â†’ PROV bundle id
  - `prov_activity_id` â†’ PROV activity id
  - `prov_entity_id` â†’ PROV entity id

> [!IMPORTANT]
> Donâ€™t store big geometries, rasters, or documents inside Neo4j.  
> Store **IDs + small summaries** â†’ let STAC/DCAT/PROV remain canonical. ğŸ§¾

### Why this contract exists ğŸ§ 
- ğŸ§¾ **Auditability:** â€œWhere did this come from?â€
- â™»ï¸ **Reproducibility:** â€œCan we rebuild and compare outputs?â€
- ğŸ›¡ï¸ **Governance:** â€œCan we enforce redaction + classification consistently?â€

### Advanced provenance extension ğŸ§¬
If you are modeling software/data operations provenance, you may add:

- `prov_agent_id` â†’ human/CI agent id
- `git_commit_sha` â†’ commit that produced the artifact
- `git_pr_id` â†’ PR activity id, when PRâ†’PROV integration is enabled

> [!NOTE]
> This supports â€œcode + data lineage in one graph,â€ enabling queries like â€œWhich code version produced this dataset and who reviewed it?â€

---

<a id="ontology-and-modeling-guardrails"></a>
## ğŸ§± Ontology and modeling guardrails

KFM uses a property graph, but keeps semantics grounded in standard vocabularies where possible.

### Stable IDs ğŸªª
Recommended pattern:
```text
kfm:<kind>:<namespace>:<slug_or_id>[:v<version>]
```

Examples:
```text
kfm:place:us-ks:topeka
kfm:dataset:kfm.ks.transport.railroads.1870_1910:v1
kfm:doc:khs:map_1878_plate12
kfm:event:us-ks:1874_grasshopper_outbreak
kfm:run:kfm-sim-run:groundwater_model:2026_01_19:v1
```

Rules:
- âœ… Stable across rebuilds for the â€œsame conceptual thingâ€
- âœ… Use version only when semantics change, not just re-runs
- âŒ Never use Neo4j internal ids as identity

### Labels and relationship types ğŸ§±
Keep them boring and consistent.

Suggested core labels:
- `Place`, `Person`, `Org`, `Event`, `Document`, `Dataset`, `Asset`, `Run`, `Claim`, `Activity`

Suggested relationship types:
- `LOCATED_IN`, `OCCURRED_AT`, `MENTIONS`, `CITES`
- `HAS_ASSET`, `HAS_DATASET`, `DERIVED_FROM`
- `WAS_GENERATED_BY`, `USED`, `WAS_ATTRIBUTED_TO` *(PROV-like)*

> [!IMPORTANT]
> If you add/rename labels or relationship types, treat it like a schema change:
> - update `data/graph/docs/ontology.md`
> - add a migration (`data/graph/cypher/migrations__*.cypher`)
> - coordinate API contract updates

### Facts vs claims ğŸ­
If a relationship is interpretive or uncertain, model it as a `Claim`:

- `(:Claim)-[:CITES]->(:Document|:Dataset|:Asset)`
- `(:Claim)-[:ABOUT]->(:Entity)`
- claim carries `confidence`, `method`, `classification`, and evidence pointers

This keeps â€œfact vs interpretationâ€ clean for Story Nodes and Focus Mode. ğŸ¬ğŸ§ 

### Time and space semantics ğŸ§­ğŸ•°ï¸
- Store time as ISO 8601 strings: `at`, `start`, `end` (+ timezone if relevant)
- For spatial footprint prefer safe summaries:
  - `bbox_wgs84` âœ…
  - `geom_hash` âœ…
- Avoid precise coordinates when restricted âŒ  
  Use generalized summaries and enforce redaction at API boundary.

---

<a id="csv-import-artifact-specs"></a>
## ğŸ“¦ CSV import artifact specs

### CSV standards âœ…
- UTFâ€‘8
- header row required
- deterministic ordering (sort by `kfm_id` / `src_id,dst_id`)
- explicit columns only (no mystery extra fields)

> [!TIP]
> Keep CSV files **review-friendly** (small columns, stable ordering). If you need wide/complex node payloads, store the payload as an external asset and reference via STAC/DCAT.

---

### Node CSV recommended columns ğŸ§±

| Column | Required | Meaning |
|---|:---:|---|
| `kfm_id` | âœ… | Stable node id |
| `labels` | âœ… | Neo4j labels (`Label1;Label2`) |
| `name` | âœ… | Display name |
| `description` | âš ï¸ | Short summary, not full text |
| `classification` | âœ… | `public/internal/confidential/restricted` |
| `care_label` | âœ… | `n/a` or sensitivity tag |
| `valid_from` / `valid_to` | âš ï¸ | ISO 8601 validity |
| `bbox_wgs84` | âš ï¸ | `minLon,minLat,maxLon,maxLat` |
| `evidence_stac_id` | âœ…* | STAC pointer |
| `evidence_dcat_id` | âœ…* | DCAT pointer |
| `prov_activity_id` | âš ï¸ | PROV activity pointer |
| `prov_entity_id` | âš ï¸ | PROV entity pointer |
| `license_id` | âš ï¸ | License id or SPDX (esp. for datasets) |

\* At least one of `evidence_stac_id` or `evidence_dcat_id` is required.

Example:
```csv
kfm_id,labels,name,description,classification,care_label,bbox_wgs84,evidence_dcat_id,evidence_stac_id,prov_activity_id,license_id
kfm:place:us-ks:topeka,Place,Topeka,"Capital city of Kansas.",public,n/a,"-95.78,38.95,-95.63,39.10",kfm:dataset/kfm.ks.admin.places:v1,,prov:activity/run_2026_01_19_01,
```

---

### Relationship CSV recommended columns ğŸ”—

| Column | Required | Meaning |
|---|:---:|---|
| `src_id` | âœ… | Start node `kfm_id` |
| `rel_type` | âœ… | Relationship type |
| `dst_id` | âœ… | End node `kfm_id` |
| `classification` | âœ… | Access tier for edge |
| `care_label` | âœ… | `n/a` or sensitivity tag |
| `confidence` | âš ï¸ | `0..1` or `low/med/high` |
| `weight` | âš ï¸ | Optional numeric weight |
| `evidence_*` | âœ… | Evidence pointer(s) |
| `prov_*` | âš ï¸ | Lineage pointer(s) |

Example:
```csv
src_id,rel_type,dst_id,classification,care_label,confidence,evidence_dcat_id,prov_activity_id
kfm:place:us-ks:topeka,LOCATED_IN,kfm:place:us-ks:kansas,public,n/a,0.99,kfm:dataset/kfm.ks.admin.places:v1,prov:activity/run_2026_01_19_01
```

---

<a id="cypher-scripts"></a>
## ğŸ§© Cypher scripts

Use Cypher for:
- âœ… constraints and indexes
- âœ… idempotent post-import linking
- âœ… migrations with explicit scope

Idempotency patterns:
```cypher
// Constraints (safe re-run)
CREATE CONSTRAINT kfm_id_unique IF NOT EXISTS
FOR (n) REQUIRE n.kfm_id IS UNIQUE;

// Safe upsert
MERGE (p:Place {kfm_id: $kfm_id})
SET p.name = $name,
    p.classification = $classification,
    p.care_label = $care_label;
```

Avoid:
- âŒ global rewrites without scope
- âŒ scripts that assume empty database
- âŒ embedding credentials/endpoints

---

<a id="validation-and-ci-gates"></a>
## ğŸ§ª Validation and CI gates

### Definition of Done for PRs touching `data/graph/**` âœ…
- [ ] CSV UTFâ€‘8 + headers present
- [ ] `kfm_id` non-null and unique per label file
- [ ] relationships reference existing node IDs
- [ ] `classification` present and valid values only
- [ ] `care_label` present (`n/a` allowed)
- [ ] at least one evidence pointer per row (`evidence_stac_id` or `evidence_dcat_id`)
- [ ] evidence targets resolve in `data/stac/**` and/or `data/catalog/dcat/**`
- [ ] PROV pointers resolve in `data/prov/**` when used
- [ ] no restricted precision introduced accidentally
- [ ] policy pack checks pass (OPA/Rego + Conftest)

### Policy pack integration ğŸ”
CI policy checks are intended to enforce rules like:
- dataset license required
- AI-assisted outputs must include at least one citation (where applicable)
- sensitive or restricted areas must trigger review requirements
- provenance-first promotion gates

> [!IMPORTANT]
> Policy checks apply equally to human and agent PRs. No bypass lanes. ğŸ§±

### Integration testing recommended ğŸ§ª
Run a tiny fixture ingest in CI:
- import a small set of nodes/rels
- apply constraints
- run â€œgolden queriesâ€ that match API patterns
- validate governance behavior (classification redaction expectations)

---

<a id="governance-privacy-and-access-control"></a>
## ğŸ” Governance, privacy, and access control

### Classification carries through ğŸ§­
- `classification` on nodes/edges is enforced at API boundary
- restricted content must not be fully exposed in public exports

### Sensitive locations and CARE labels â¤ï¸ğŸ§­
If a dataset is sensitive:
- do **not** store precise coordinates in public graph exports
- prefer generalized geometry summaries (bbox, grid cell ids)
- attach `care_label` values such as `culturally_sensitive` and use policy gates to enforce handling

### Role-based access control roadmap ğŸ‘¤
As KFM introduces accounts:
- UI shows actions based on role
- API enforces role permissions for endpoints
- provenance logs should record â€œwho did what and whenâ€ for trust and accountability

> [!CAUTION]
> Never commit: secrets, internal-only endpoints, unreviewed PII, or precise sensitive sites.

---

<a id="real-time-simulation-and-focus-mode-integration"></a>
## â± Real-time, simulation, and Focus Mode integration

### Real-time data is still governed ğŸ›°ï¸
Streaming feeds should be treated as many small datasets over time:
- data lands in PostGIS (for fast spatial + time-series querying)
- graph links stations/datasets/lineage for discoverability and traceability
- provenance and catalog stubs must exist before display, even for real-time layers

### Simulations and model runs ğŸ§ªğŸ§ 
Model outputs should behave like any other dataset:
- publish outputs via STAC/DCAT
- record PROV: inputs used, model code version, parameters, outputs generated
- graph links should allow queries like â€œwhich model run produced this layer?â€

### Focus Mode uses the governed stack ğŸ§ 
Focus Mode should:
- use the graph to locate entities (places, stations, datasets)
- use API to retrieve authorized data (including PostGIS lookups)
- produce answers with citations that point back to catalog/provenance records
- never reveal restricted coordinates or classified properties

> [!IMPORTANT]
> The AI assistant is advisory-only. It should not autonomously mutate graph/catalog data without PR-based governance.

---

<a id="performance-notes"></a>
## âš™ï¸ Performance notes

Graph is for **relationships + discovery**, not heavy analytics.

Practical guidelines âœ…
- index/constraint `kfm_id`
- keep API traversals bounded (depth limits + pagination)
- avoid UI mega-traversals and uncontrolled expansions
- cache Story Node query patterns at the API layer

If you need heavy analytics:
- run it in pipelines
- publish outputs as datasets (STAC/DCAT/PROV)
- link results into the graph as derived datasets

---

<a id="reference-shelf"></a>
## ğŸ“š Reference shelf

> KFM treats documentation as part of the governance surface. Keep it close, keep it current. ğŸ“šğŸ§­

<details>
<summary><strong>ğŸ§± KFM canonical docs</strong></summary>

- `Kansas Frontier Matrix (KFM) â€“ Comprehensive Technical Documentation.pdf`
- `Kansas Frontier Matrix (KFM) â€“ Comprehensive Architecture, Features, and Design.pdf`
- `Kansas Frontier Matrix (KFM) â€“ AI System Overview ğŸ§­ğŸ¤–.pdf`
- `ğŸ“š Kansas Frontier Matrix (KFM) Data Intake â€“ Technical & Design Guide.pdf`
- `Kansas Frontier Matrix â€“ Comprehensive UI System Overview.pdf`
- `ğŸŒŸ Kansas Frontier Matrix â€“ Latest Ideas & Future Proposals.docx.pdf`
- `Innovative Concepts to Evolve the Kansas Frontier Matrix (KFM).pdf`

</details>

<details>
<summary><strong>ğŸ“¦ Research bundles and PDF portfolios</strong></summary>

These are useful background references; some are packaged as PDF portfolios:
- `AI Concepts & more.pdf`
- `Maps-GoogleMaps-VirtualWorlds-Archaeological-Computer Graphics-Geospatial-webgl.pdf`
- `Data Managment-Theories-Architures-Data Science-Baysian Methods-Some Programming Ideas.pdf`
- `Various programming langurages & resources 1.pdf`

</details>

<details>
<summary><strong>ğŸ“ Markdown and documentation standards</strong></summary>

- `MARKDOWN_GUIDE_v13.md`
- `Comprehensive Markdown Guide_ Syntax, Extensions, and Best Practices.docx`

</details>

---

<a id="version-history"></a>
## ğŸ•°ï¸ Version history

| Version | Date | Change | Author |
|---|---:|---|---|
| v1.0.0 | 2025-12-26 | Initial `data/graph/README.md` | TBD |
| v1.1.0 | 2026-01-08 | Tighten traceability contract, CSV/Cypher specs, CI gates, governance | graph-maintainers |
| v1.2.0 | 2026-01-19 | Align with v13 invariants, policy pack, FAIR+CARE fields, PostGIS/Neo4j split, Focus Mode integration | graph-maintainers |

---

### âœ… Footer
- Pipeline invariant: **Raw â†’ ETL â†’ STAC â†’ DCAT â†’ PROV â†’ Graph â†’ API â†’ UI â†’ Story Nodes â†’ Focus Mode**
- Canonical pointers: `data/stac/` Â· `data/catalog/dcat/` Â· `data/prov/`
- Graph artifacts: `data/graph/csv/` + `data/graph/cypher/`
- Security policy: `SECURITY.md` or `.github/SECURITY.md`
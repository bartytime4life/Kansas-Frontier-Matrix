<div align="center">

# 🧾 Kansas Frontier Matrix — Climate Derivative Checksums  
`data/derivatives/climate/checksums/`

**Purpose:** Maintain **SHA-256 integrity manifests** for all **climate-derivative artifacts**  
(COG · GeoJSON · Parquet · CSV) generated by the ETL pipeline, ensuring verifiable, reproducible data lineage.

[![Build & Deploy](https://img.shields.io/github/actions/workflow/status/bartytime4life/Kansas-Frontier-Matrix/site.yml?label=Build%20%26%20Deploy)](../../../../../.github/workflows/site.yml)  
[![STAC Validate](https://img.shields.io/badge/STAC-validate-blue)](../../../../../.github/workflows/stac-validate.yml)  
[![CodeQL](https://img.shields.io/github/actions/workflow/status/bartytime4life/Kansas-Frontier-Matrix/codeql.yml?label=CodeQL)](../../../../../.github/workflows/codeql.yml)  
[![Trivy](https://img.shields.io/badge/Container-Scan-informational)](../../../../../.github/workflows/trivy.yml)  
[![Docs · MCP](https://img.shields.io/badge/Docs-MCP-brightgreen)](../../../../../docs/)  
[![License: CC-BY 4.0](https://img.shields.io/badge/License-CC--BY%204.0-lightgrey)](../../../../../LICENSE)

</div>

---

## 📚 Overview

The `checksums/` directory stores **SHA-256 manifest files** validating every processed  
climate derivative under `data/derivatives/climate/`.  

Checksums act as **integrity anchors** throughout KFM’s data lifecycle —  
**ETL → STAC → Knowledge Graph → API → Web UI** — ensuring that every artifact  
used in analysis or visualization can be independently verified and reproduced.

---

## 🧭 Checksum Generation & Validation Flow

```mermaid
flowchart TD
  A["Sources\nNOAA · Daymet · Normals"] --> B["ETL\nNormalize · Reproject · Derive"]
  B --> C["Climate Derivatives\nCOG · GeoJSON · Parquet · CSV"]
  C --> D["Compute SHA-256\n*.sha256 manifests"]
  D --> E["STAC Items\nlink assets + checksum"]
  E --> F["Knowledge Graph\nprovenance + asset refs"]
  F --> G["API & Web UI\nserve verified assets"]
  click E "https://github.com/bartytime4life/Kansas-Frontier-Matrix/tree/main/data/stac" "Indexed in data/stac/"
  click C "https://github.com/bartytime4life/Kansas-Frontier-Matrix/tree/main/data/derivatives/climate" "Derivative outputs"
%% END OF MERMAID
````

<!-- END OF MERMAID -->

---

## 🗂 Directory Layout

```bash
data/derivatives/climate/
├── # derived climate products (COGs, GeoJSON, Parquet, CSV)
└── checksums/
    ├── 1991_2020_normals_prcp_cog.tif.sha256
    ├── daymet_1980_2024_tmin_ks_cog.tif.sha256
    ├── drought_index_annual_ks.parquet.sha256
    ├── station_normals_points.geojson.sha256
    └── README.md
```

> ✅ Only `.sha256` manifests reside here; data binaries remain one level up.

---

## 🧪 Algorithm & File Format

| Property         | Value / Explanation                                                                         |
| :--------------- | :------------------------------------------------------------------------------------------ |
| **Algorithm**    | SHA-256 (hex digest)                                                                        |
| **Format**       | `<HEX_DIGEST>  <filename>` — one line per file                                              |
| **Line Endings** | LF (`\n`)                                                                                   |
| **Scope**        | Hash computed over raw binary file (not symlinks)                                           |
| **Why SHA-256**  | Collision-resistant, portable across systems (`sha256sum`, `shasum -a 256`, `openssl dgst`) |

---

## 🛠️ Generate & Verify

**Generate**

```bash
cd data/derivatives/climate
for f in *.tif *.parquet *.geojson *.csv; do
  [ -f "$f" ] || continue
  shasum -a 256 "$f" > "checksums/${f}.sha256"
done
```

**Verify**

```bash
cd data/derivatives/climate
for c in checksums/*.sha256; do
  base=$(basename "$c" .sha256)
  sha256sum -c "checksums/${base}.sha256"
done
```

> 💡 Validation is automatically triggered by CI via `stac-validate.yml`.

---

## 🔗 STAC Integration (Provenance)

Each STAC Item embeds the checksum for reproducibility:

| Key                            | Example                                                     |
| :----------------------------- | :---------------------------------------------------------- |
| `assets.<key>.href`            | `data/derivatives/climate/daymet_1980_2024_tmin_ks_cog.tif` |
| `assets.<key>.checksum:sha256` | `fa9c…3b2d`                                                 |
| `properties['kfm:provenance']` | `data/sources/daymet.json`                                  |

Checksums form the **validation linkage** between derivative artifacts,
source manifests, and the STAC registry.

---

## 🧩 Knowledge Graph & API Integration

* **Graph:** `checksum_sha256` attributes attach to asset nodes in Neo4j,
  ensuring evidence-based provenance chains.
* **API:** `GET /api/assets/{id}/checksum` returns the digest for client-side verification
  and automated asset validation within the Web UI.

---

## 🧱 Naming Conventions

| Pattern                                        | Example                                   | Notes                  |
| :--------------------------------------------- | :---------------------------------------- | :--------------------- |
| `<dataset>_<temporal>_<var>_ks_cog.tif.sha256` | `daymet_1980_2024_tmin_ks_cog.tif.sha256` | Year range + KS suffix |
| `<dataset>_<period>_<name>.parquet.sha256`     | `drought_index_annual_ks.parquet.sha256`  | Tabular derivative     |
| `<dataset>_<layer>.geojson.sha256`             | `station_normals_points.geojson.sha256`   | Vector layer naming    |
| `<dataset>_<period>_<var>.csv.sha256`          | `normals_1991_2020_prcp.csv.sha256`       | Small CSV derivative   |

---

## ✅ Integrity Policy

1️⃣ Every derivative file **must have** a matching `.sha256` manifest before publication.
2️⃣ **Never edit** digests manually — recompute after any modification.
3️⃣ **CI fails** if file hash ≠ STAC-recorded checksum.
4️⃣ All PRs touching derivatives **must include updated checksums**.

---

## 🔒 Reproducibility & MCP Alignment

Checksums embody **Master Coder Protocol (MCP)** principles:

* 🔗 **Provenance-anchored:** connects data to verifiable origins.
* 🧮 **Reproducible:** guarantees byte-for-byte integrity across environments.
* 🧱 **Auditable:** forms the foundation for CI validation gates.
* 🧬 **Interoperable:** used consistently across STAC, Neo4j, and API layers.

This ensures the Kansas Frontier Matrix remains a **trustworthy, mission-grade historical dataset hub.**

---

## 🧱 Related Documentation

* [`docs/architecture.md`](../../../../../docs/architecture.md) — Pipeline & provenance overview
* [`docs/data-architecture.md`](../../../../../docs/data-architecture.md) — Data integrity design
* [`data/stac/catalog.json`](../../../stac/catalog.json) — STAC registry linking `checksum:sha256`
* [`data/derivatives/climate/metadata/README.md`](../metadata/README.md) — Metadata schema integration

---

## 🗓️ Version History

| Version  | Date       | Notes                                                                                           |
| :------- | :--------- | :---------------------------------------------------------------------------------------------- |
| **v1.1** | 2025-10-11 | Upgraded to Markdown Protocols v1.1; added front-matter, improved diagram, CI/validation links. |
| **v1.0** | 2025-10-10 | Initial checksum policy and examples.                                                           |

---

```

<div align="center">

# 🏔️ Kansas Frontier Matrix — Terrain Checksums  
`data/checksums/terrain/`

**Mission:** Maintain **integrity, reproducibility, and provenance** for all terrain and elevation datasets  
within the Kansas Frontier Matrix (KFM) — ensuring every Digital Elevation Model (DEM), hillshade, and slope/aspect raster  
is cryptographically validated, reproducible, and transparently linked via STAC metadata.

[![Build & Deploy](https://github.com/bartytime4life/Kansas-Frontier-Matrix/actions/workflows/site.yml/badge.svg)](../../../.github/workflows/site.yml)
[![STAC Validate](https://github.com/bartytime4life/Kansas-Frontier-Matrix/actions/workflows/stac-validate.yml/badge.svg)](../../../.github/workflows/stac-validate.yml)
[![CodeQL](https://github.com/bartytime4life/Kansas-Frontier-Matrix/actions/workflows/codeql.yml/badge.svg)](../../../.github/workflows/codeql.yml)
[![Trivy Security](https://github.com/bartytime4life/Kansas-Frontier-Matrix/actions/workflows/trivy.yml/badge.svg)](../../../.github/workflows/trivy.yml)
[![Docs · MCP](https://img.shields.io/badge/Docs-MCP-blue)](../../../docs/)
[![License: Data](https://img.shields.io/badge/License-CC--BY%204.0-green)](../../../LICENSE)

</div>

---

## 📚 Overview

The `data/checksums/terrain/` directory contains **SHA-256 checksum files (`.sha256`)**  
for all processed **terrain datasets** within the Kansas Frontier Matrix (KFM).  

These checksums are the foundation of **scientific reproducibility and audit integrity**,  
ensuring that terrain products — from statewide LiDAR DEMs to derivative slope rasters —  
remain verifiable and unaltered through their entire lifecycle.

**Checksum guarantees:**
- 🧱 **Integrity** — Detects file corruption or unauthorized modification.  
- 🔁 **Reproducibility** — Ensures identical ETL outputs on every pipeline run.  
- 🔗 **Provenance** — Connects all terrain products to their source metadata and STAC entries.  
- 🧩 **Auditability** — Provides continuous validation through CI/CD automation.  

All checksum files are automatically generated by the **Terrain ETL pipeline (`make terrain`)**  
and verified during every continuous integration workflow.

---

## 🗂️ Directory Layout

```bash
data/checksums/terrain/
├── README.md
├── ks_1m_dem_2018_2020.tif.sha256
├── ks_hillshade_2018_2020.tif.sha256
├── slope_aspect_2018_2020.tif.sha256
└── contour_lines_10m_ks.geojson.sha256
````

> **Note:** Each `.sha256` file corresponds to its associated dataset in
> `data/processed/terrain/` and is validated automatically via `sha256sum -c` during CI/CD.

---

## 🔐 Purpose of Checksums

| Objective           | Description                                                                    |
| :------------------ | :----------------------------------------------------------------------------- |
| **Data Integrity**  | Detects corruption, partial writes, or tampering across raster datasets.       |
| **Reproducibility** | Verifies deterministic results across platforms and rebuilds.                  |
| **Provenance**      | Embeds verified lineage between processed data, metadata, and STAC references. |
| **Automation**      | Integrated into CI/CD pipelines for perpetual validation.                      |
| **Transparency**    | Supports open, verifiable data governance under MCP standards.                 |

---

## 🧮 Example `.sha256` File

```bash
# File: ks_1m_dem_2018_2020.tif.sha256
f3c0b929a38ef47c7b41138dd726abf84a65a03b8b24e8e12db2fa89a5740c42  ks_1m_dem_2018_2020.tif
```

This checksum certifies the integrity of
`data/processed/terrain/ks_1m_dem_2018_2020.tif`
and confirms its reproducibility across all builds and deployments.

---

## ⚙️ Generation Workflow

Checksums are generated automatically following each ETL run or can be invoked manually.

**Makefile target:**

```bash
make terrain-checksums
```

**Python command:**

```bash
python src/utils/generate_checksums.py data/processed/terrain/ --algo sha256
```

### Workflow Steps:

1. Scan `data/processed/terrain/` for terrain products (`.tif`, `.cog`, `.geojson`).
2. Compute hashes via Python’s `hashlib` for each file.
3. Save results as `<filename>.sha256` to this directory.
4. CI/CD validates the checksums automatically.
5. Logs archived to `data/work/logs/terrain_checksums.log` for transparency.

---

## 🧰 CI/CD Validation

**Validation command:**

```bash
sha256sum -c data/checksums/terrain/*.sha256
```

### Behavior

* ✅ **Pass:** Data integrity verified; STAC items remain in sync.
* ❌ **Fail:** CI halts immediately; dataset must be reprocessed and rehashed.
* 📜 **Logs:** Validation reports stored under `data/work/logs/` for MCP audit tracking.

This process integrates with `.github/workflows/stac-validate.yml`
to synchronize checksum verification with STAC metadata validation.

---

## 🔗 Integration with Metadata & STAC

| Linked Component                      | Purpose                                                    |
| :------------------------------------ | :--------------------------------------------------------- |
| `data/processed/metadata/terrain/`    | STAC Items include `"checksum:sha256"` for terrain assets. |
| `src/pipelines/terrain_pipeline.py`   | Automates hash generation, verification, and logging.      |
| `.github/workflows/stac-validate.yml` | Ensures checksum and STAC schema parity during CI.         |
| `data/stac/terrain/`                  | Catalog maintains hash-linked Items for reproducibility.   |
| `data/checksums/manifest.sha256`      | Global manifest referencing terrain checksum files.        |

---

## 🧩 Troubleshooting & Maintenance

| Issue                     | Cause                                         | Resolution                                           |
| :------------------------ | :-------------------------------------------- | :--------------------------------------------------- |
| CI validation fails       | File changed or truncated post-ETL.           | Re-run `make terrain-checksums` and recommit hashes. |
| Missing checksum file     | New raster added but hash not created.        | Run `python src/utils/generate_checksums.py`.        |
| STAC mismatch             | STAC entry out of sync with checksum.         | Run `make stac` to update STAC Items.                |
| Non-deterministic results | Randomized compression or timestamp metadata. | Rebuild with fixed seed & deterministic GDAL flags.  |

---

## 🧠 MCP Compliance Summary

| MCP Principle           | Implementation                                              |
| :---------------------- | :---------------------------------------------------------- |
| **Documentation-first** | Each dataset includes README and `.sha256` manifest.        |
| **Reproducibility**     | Deterministic hashing guarantees byte-for-byte consistency. |
| **Open Standards**      | SHA-256 (FIPS 180-4) and STAC Checksum extension used.      |
| **Provenance**          | Datasets linked via STAC, metadata, and checksum chain.     |
| **Auditability**        | Continuous validation via CI/CD and logged evidence.        |

---

## 📅 Version History

| Version | Date       | Summary                                                                                        |
| :------ | :--------- | :--------------------------------------------------------------------------------------------- |
| v1.0.0  | 2025-10-04 | Initial terrain checksum documentation — DEM, hillshade, slope/aspect verified.                |
| v1.1.0  | 2025-10-10 | Added contour datasets, enhanced CI logging, troubleshooting, and global manifest integration. |

---

<div align="center">

**Kansas Frontier Matrix** — *“Elevation Verified, Integrity Preserved.”*
📍 [`data/checksums/terrain/`](.) · Linked to the **Terrain STAC Collection** and Global Manifest Registry.

</div>
```
 

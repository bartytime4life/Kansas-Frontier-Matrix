<!--
ğŸ“ Path: web/assets/media/branding/watermark/README.md
Purpose: Document KFM watermark assets + how theyâ€™re applied in the Web UI & exports.
-->

# ğŸ§· KFM Watermark Assets

![Branding](https://img.shields.io/badge/category-branding-informational)
![Formats](https://img.shields.io/badge/formats-SVG%20%7C%20PNG-blue)
![Scope](https://img.shields.io/badge/scope-web%20UI%20%2B%20exports-brightgreen)

Watermarks live here so the **Web UI** (and any **export/screenshot flows**) can apply a consistent **Kansas Frontier Matrix (KFM)** brand mark while preserving KFMâ€™s core principle: **evidence + provenance remain first-class**.

> [!IMPORTANT]
> A watermark is **not** a substitute for:
> - dataset attribution & licensing,
> - STAC/DCAT/PROV metadata,
> - Story Node evidence links,
> - or any required thirdâ€‘party credit overlays.
>
> Think of the watermark as â€œbrand identity for rendered visuals,â€ not â€œsource-of-truth attribution.â€

---

## ğŸ“¦ Whatâ€™s in this folder?

This directory contains **watermark-ready** assets that are:
- âœ… transparent background  
- âœ… safe for overlaying on maps, charts, screenshots, and exports  
- âœ… lightweight (optimized for web delivery)  

Typical use cases:
- ğŸ—ºï¸ Map UI overlay (MapLibre / Leaflet / 3D canvases)
- ğŸ“¸ â€œExport imageâ€ / â€œScreenshotâ€ feature
- ğŸ§¾ Report rendering (PDF/PNG outputs generated by tools)
- ğŸï¸ Demo captures & videos (as a non-interactive overlay)

---

## ğŸ—‚ï¸ Expected directory layout

> If your repo already has different filenames, keep them â€” but align with the **variant rules** below.

```text
web/assets/media/branding/watermark/
â”œâ”€ README.md                         # (this file)
â”œâ”€ kfm-watermark-light.svg           # light mark for dark backgrounds
â”œâ”€ kfm-watermark-dark.svg            # dark mark for light backgrounds
â”œâ”€ kfm-watermark-light.png           # png fallback / canvas-friendly
â”œâ”€ kfm-watermark-dark.png            # png fallback / canvas-friendly
â””â”€ previews/
   â”œâ”€ preview-on-light.png
   â””â”€ preview-on-dark.png
```

---

## ğŸ§© Asset variants

| Variant | Best on | Primary purpose | Notes |
|---|---|---|---|
| `kfm-watermark-light.*` | dark imagery / dark UI | overlays in dark theme, satellite imagery, dark basemaps | white/near-white mark with transparency |
| `kfm-watermark-dark.*` | light imagery / light UI | overlays in light theme, paper scans, light basemaps | black/near-black mark with transparency |

> [!TIP]
> Prefer **SVG** in DOM/CSS for crisp scaling.
> Prefer **PNG** for canvas pipelines where SVG rendering is inconsistent (or for simple â€œdrawImageâ€ flows).

---

## ğŸ“ Default placement spec

These defaults keep the mark visible without overpowering map content:

### âœ… Recommended default
- **Anchor:** bottom-right
- **Margin (safe padding):** `max(16px, 2vw)`
- **Width:** `min(180px, 22vw)`  
- **Opacity:** `0.18` (UI overlay) â†’ `0.12` (exports)  
- **Pointer events:** disabled (never blocks map interactions)

### ğŸš« Avoid
- placing over legends, scale bars, or attribution text
- â€œburning inâ€ the watermark onto **canonical data assets** (COGs, GeoJSON, etc.)

---

## ğŸŒ Web UI overlay (HTML/CSS)

Add a watermark element above your map container (or inside it as an absolute overlay):

```html
<div class="MapShell">
  <div id="map"></div>

  <img
    class="KfmWatermark"
    src="/assets/media/branding/watermark/kfm-watermark-dark.svg"
    alt="Kansas Frontier Matrix watermark"
    aria-hidden="true"
  />
</div>
```

```css
.MapShell {
  position: relative;
}

.KfmWatermark {
  position: absolute;
  right: max(16px, 2vw);
  bottom: max(16px, 2vw);

  width: min(180px, 22vw);
  height: auto;

  opacity: 0.18;
  pointer-events: none;
  user-select: none;

  /* Optional: if your UI supports it, use a subtle blend mode */
  /* mix-blend-mode: multiply; */
}
```

> [!NOTE]
> Keep watermark logic **theme-aware**:
> - Light UI â†’ use `kfm-watermark-dark.*`
> - Dark UI â†’ use `kfm-watermark-light.*`

---

## ğŸ§ª Canvas export watermark (PNG/JPEG)

If your export pipeline renders a canvas (MapLibre screenshot, chart canvas, WebGL capture), apply the watermark **after** rendering the main scene:

```js
async function drawWatermark(ctx, canvasWidth, canvasHeight, watermarkUrl) {
  const img = new Image();
  img.crossOrigin = "anonymous";
  img.src = watermarkUrl;

  await new Promise((resolve, reject) => {
    img.onload = resolve;
    img.onerror = reject;
  });

  // Layout rules
  const margin = Math.max(16, Math.round(canvasWidth * 0.02));
  const targetW = Math.min(220, Math.round(canvasWidth * 0.18));
  const scale = targetW / img.width;
  const targetH = Math.round(img.height * scale);

  const x = canvasWidth - targetW - margin;
  const y = canvasHeight - targetH - margin;

  // Watermark compositing
  ctx.save();
  ctx.globalAlpha = 0.12; // exports should be more subtle than UI
  ctx.drawImage(img, x, y, targetW, targetH);
  ctx.restore();
}
```

Usage:

```js
const canvas = document.querySelector("canvas");
const ctx = canvas.getContext("2d");

await drawWatermark(
  ctx,
  canvas.width,
  canvas.height,
  "/assets/media/branding/watermark/kfm-watermark-dark.png"
);

const blob = await new Promise((r) => canvas.toBlob(r, "image/png"));
```

---

## ğŸ§Š WebGL overlay note (advanced)

If your capture is from WebGL:
- **Option A (simplest):** capture WebGL â†’ draw onto a 2D canvas â†’ apply watermark (recommended)
- **Option B:** render watermark as a screen-space quad (NDC) using an orthographic pass

> Keep the watermark pass last, and donâ€™t allow it to contaminate any â€œanalysis buffersâ€ (depth picking, segmentation, etc.). Itâ€™s purely presentation.

---

## ğŸ§¯ SVG fallback pattern (recommended)

If you want to prefer SVG but fallback to PNG:

```css
.KfmWatermark {
  background: url("/assets/media/branding/watermark/kfm-watermark-dark.png") no-repeat;
  background: url("/assets/media/branding/watermark/kfm-watermark-dark.svg") left top / contain no-repeat;
}
```

This ensures older SVG-in-CSS limitations degrade gracefully.

---

## âš–ï¸ Governance & attribution rules

Because KFM is a provenance-first system:

- âœ… Apply watermarks to **renders** (UI overlays, exports, screenshots)
- ğŸš« Do **not** watermark **raw/processed canonical datasets** (COGs, GeoJSON, catalog artifacts)
- âœ… If a dataset license requires visible attribution, include it **separately** and do not hide it behind the KFM mark
- âœ… If multiple organizations require logos/marks, treat them as **co-equal** credits and apply consistent sizing rules

> [!WARNING]
> Never use a watermark to imply ownership of data that KFM does not own.
> Branding â‰  licensing.

---

## ğŸ› ï¸ Adding or updating watermark files

### Naming rules (please follow)
- `kfm-watermark-{light|dark}.{svg|png}`
- optional scale variants: `@2x`, `@3x` **only** if your pipeline explicitly uses them

### Optimization checklist âœ…
- SVG:
  - remove editor metadata
  - keep viewBox correct
  - avoid embedded raster images unless unavoidable
- PNG:
  - ensure transparency preserved
  - keep sRGB profile consistent
  - export at a â€œreasonable maxâ€ (e.g., 1024px wide if needed for print-ish exports)

---

## âœ… QA checklist (before merging)

- [ ] Looks crisp at **100â€“220px wide** on standard monitors
- [ ] Still legible at **retina scaling**
- [ ] Opacity feels subtle (not â€œstamp-likeâ€)
- [ ] Doesnâ€™t overlap map attribution, legend, or scale bar
- [ ] Transparent background verified
- [ ] File sizes are reasonable (no â€œaccidental 5MB watermarkâ€ ğŸ˜…)

---

## ğŸ“ Changelog

- **v1** â€” Initial watermark asset documentation + default overlay rules

# ğŸ“Š Charts Media Assets (KFM)

<p align="left">
  <img alt="KFM badge" src="https://img.shields.io/badge/KFM-provenance--first-1f6feb" />
  <img alt="assets badge" src="https://img.shields.io/badge/assets-charts%20%26%20figures-8250df" />
  <img alt="ui badge" src="https://img.shields.io/badge/web-Focus%20Mode%20compatible-2da44e" />
</p>

This folder contains **static chart renders** (images/SVGs) shipped with the web appâ€”used in:
- ğŸ§­ **Story Nodes / Focus Mode** (narrative + map context)
- ğŸ§© **UI panels** (e.g., feature detail panels, onboarding, docs)
- ğŸ§ª **Reference visuals** for tests, snapshots, and QA

> KFM rule of thumb: **If it shows up in the UI, it must be traceable to cataloged sources.** âœ…

---

## ğŸ—‚ï¸ Folder layout

```text
web/assets/media/charts/
â”œâ”€â”€ README.md
â”œâ”€â”€ export/              # âœ… optimized, production-ready assets
â”œâ”€â”€ raw/                 # ğŸ› ï¸ editable sources (if small) (e.g., .ai/.svg/.csv)
â”œâ”€â”€ thumbs/              # ğŸ–¼ï¸ small previews for lists / galleries
â””â”€â”€ meta/                # ğŸ§¾ sidecar provenance metadata (required for Focus Mode usage)
```

> Keep this directory **small + cache-friendly**. Large datasets belong in `data/` (ideally via DVC) and should be rendered dynamically or built into tiles/derivatives.

---

## âœ… What belongs here (and what doesnâ€™t)

### âœ… Good candidates
- `*.svg` icons/diagrams and vector charts
- `*.png` / `*.webp` chart renders (docs, story panels, posters)
- Small reference charts used in tests (snapshot baselines)

### âŒ Avoid
- Huge rasters / time series dumps / raw exports from GIS tools
- â€œMystery chartsâ€ with unknown data sources
- One-off screenshots without a provenance sidecar

---

## ğŸ§¾ Provenance sidecars (required)

Every production asset in `export/` **must** have a matching metadata file in `meta/`.

### ğŸ“Œ Naming convention
- Chart asset: `export/<name>.<ext>`
- Sidecar: `meta/<name>.meta.json`

Example:
- `export/ks-drought-index_timeseries_1895-2025_light_1200x675_v01.png`
- `meta/ks-drought-index_timeseries_1895-2025_light_1200x675_v01.meta.json`

### ğŸ§© Suggested `*.meta.json` schema

```json
{
  "title": "Kansas Drought Index (1895â€“2025)",
  "chart_kind": "timeseries",
  "description": "Annual drought index values with rolling mean overlay.",
  "data_sources": [
    { "dataset_id": "urn:kfm:data:...", "license": "...", "attribution": "..." }
  ],
  "pipeline": {
    "generator": "scripts/charts/render_drought_index.py",
    "code_ref": "git:abcdef1",
    "run_id": "2026-01-15T00:00:00Z"
  },
  "display": {
    "theme": "light",
    "size": { "w": 1200, "h": 675 },
    "pixel_ratio": 2,
    "format": "png"
  },
  "provenance": {
    "prov": "urn:kfm:prov:...",
    "stac_items": ["urn:kfm:stac:item:..."],
    "notes": "Any assumptions, joins, filters, smoothing choices."
  },
  "sensitivity": {
    "classification": "public",
    "care_label": "Public",
    "redactions": []
  }
}
```

**Minimum required fields** (donâ€™t skip these):
- `title`, `chart_kind`
- `data_sources[]` (at least one)
- `pipeline.generator` (or a clear â€œmanualâ€ explanation)
- `provenance` pointer(s)
- `sensitivity.classification`

---

## ğŸ·ï¸ Naming conventions

Use **kebab-case** and encode the â€œshapeâ€ of the asset in the filename.

**Pattern**

```text
<scope>_<metric>_<chart-kind>_<time-range>_<theme>_<WxH>_vNN.<ext>
```

**Examples**
- `ks_population_bar_1860-2020_dark_1600x900_v02.svg`
- `flint-hills_fire-frequency_choropleth_2001-2024_light_1200x675_v01.webp`

Tips:
- Use `ks-` prefix when itâ€™s statewide
- Use region slugs (`flint-hills`, `arkansas-river-basin`) when map-tied
- Prefer `webp` for photos/screen-renders; prefer `svg` for vector charts

---

## ğŸ¨ Visual & accessibility checklist

Before committing a chart:
- [ ] **Readable at 320px wide** (mobile sidebar / cards)
- [ ] Labels donâ€™t overlap; legends donâ€™t cover data
- [ ] Color is not the *only* encoding (use markers, patterns, or direct labels)
- [ ] Includes **alt text** wherever referenced in Markdown/JSX
- [ ] Meets sensitivity rules (no precise locations for protected sites)

---

## ğŸ”§ Optimization rules

- **SVG**: run through SVGO (or equivalent) and ensure text remains selectable.
- **PNG**: prefer indexed/optimized PNG when possible.
- **WebP**: default for photographic chart renders.

General:
- Keep `export/` assets as the â€œfinal formâ€ (optimized, production-ready).
- Keep edits in `raw/` when source files are small enough to version cleanly.

---

## ğŸ§  How charts are used in the app

Typical integration points:
- `web/components/` â†’ reusable chart components
- `web/story_nodes/` â†’ Markdown narratives that embed chart assets
- Feature details (popovers/panels) â†’ charts that summarize a clicked dataset

**Focus Mode compatibility**
- Only include charts that have a provenance sidecar and refer back to cataloged datasets.
- If a chart is AI-assisted (e.g., autogenerated narrative captions), label it clearly and keep it opt-in.

---

## ğŸ¤ Contributing

1. Add editable sources to `raw/` (optional, if small).
2. Export optimized assets to `export/`.
3. Add a sidecar `meta/*.meta.json`.
4. Reference the chart from the UI/story (and include alt text).

Happy charting! ğŸ§ªğŸ“ˆ

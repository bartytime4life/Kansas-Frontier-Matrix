{
  "id": "climate_normals_ks",
  "title": "Climate Normals — Kansas Stations (1991–2020)",
  "type": "vector",
  "format": "geojson",
  "data": "web/data/climate_normals_ks.json",
  "category": "climate",

  "time": { "start": "1991-01-01", "end": "2020-12-31" },
  "bounds": [-102.051, 36.993, -94.588, 40.003],

  "minzoom": 4,
  "maxzoom": 19,
  "visible": false,
  "opacity": 1.0,

  "popup": ["station", "ghcn_id", "elev_m", "tmin_c", "tmax_c", "precip_mm", "period_start", "period_end", "data_quality"],
  "popupTemplate": {
    "title": "{station}",
    "rows": [
      ["GHCN", "{ghcn_id}"],
      ["Elevation", "{elev_m} m"],
      ["Tmin (annual mean)", "{tmin_c} °C"],
      ["Tmax (annual mean)", "{tmax_c} °C"],
      ["Precip (annual mean daily)", "{precip_mm} mm"],
      ["Period", "{period_start} → {period_end}"],
      ["Quality", "{data_quality}"]
    ],
    "charts": {
      "temperature_monthlies": {
        "type": "line",
        "fields": ["tmin_c_monthly", "tmax_c_monthly"],
        "labels": ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]
      },
      "precip_monthlies": {
        "type": "bar",
        "fields": ["precip_mm_monthly"],
        "labels": ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]
      }
    }
  },

  "legend": {
    "type": "circle",
    "label": "Station normals (color=Tmax °C, size=precip mm/day)",
    "fields": {
      "tmax_c": "Annual mean Tmax (°C)",
      "precip_mm": "Annual mean daily precip (mm)"
    },
    "units": { "tmax_c": "°C", "precip_mm": "mm/day" }
  },

  "style": {
    "renderer": "circle",
    "circleColor": [
      "interpolate",
      ["linear", ["get", "tmax_c"]],
      10, "#3182bd",
      15, "#9ecae1",
      20, "#fdae6b",
      25, "#fd8d3c",
      30, "#e6550d",
      35, "#a63603"
    ],
    "circleRadius": [
      "interpolate",
      ["linear", ["get", "precip_mm"]],
      0.5, 3.0,
      1.0, 5.0,
      2.0, 8.0,
      3.0, 11.0
    ],
    "circleOpacity": 0.9,
    "circleStrokeColor": "#ffffff",
    "circleStrokeWidth": 0.6
  },

  "cluster": {
    "enabled": true,
    "minzoom": 4,
    "maxzoom": 8,
    "clusterRadius": 40,
    "clusterColor": "#666666",
    "clusterTextColor": "#ffffff"
  },

  "filters": {
    "quality": { "field": "data_quality", "include": ["final", "provisional"] },
    "tmax_range": { "field": "tmax_c", "min": null, "max": null },
    "precip_range": { "field": "precip_mm", "min": null, "max": null }
  },

  "search": { "qFields": ["station", "ghcn_id"] },

  "fields": {
    "station":   { "type": "string", "description": "Station name" },
    "ghcn_id":   { "type": "string", "description": "GHCN station identifier" },
    "elev_m":    { "type": "number", "units": "m" },
    "tmin_c":    { "type": "number", "units": "°C", "description": "Annual mean daily minimum (1991–2020)" },
    "tmax_c":    { "type": "number", "units": "°C", "description": "Annual mean daily maximum (1991–2020)" },
    "precip_mm": { "type": "number", "units": "mm/day", "description": "Annual mean daily precipitation (1991–2020)" },
    "tmin_c_monthly":    { "type": "array", "items": { "type": "number" }, "units": "°C", "length": 12, "nullable": true },
    "tmax_c_monthly":    { "type": "array", "items": { "type": "number" }, "units": "°C", "length": 12, "nullable": true },
    "precip_mm_monthly": { "type": "array", "items": { "type": "number" }, "units": "mm/day", "length": 12, "nullable": true },
    "period_start": { "type": "string", "format": "date" },
    "period_end":   { "type": "string", "format": "date" },
    "data_quality": { "type": "string", "enum": ["provisional", "final"] }
  },

  "connections": {
    "stac_item": "stac/items/climate_normals_ks.json",
    "related_layers": [
      "web/data/landcover.json",
      "web/data/ks_hydro.json"
    ]
  },

  "attribution": "NOAA NCEI U.S. Climate Normals (1991–2020)",
  "license": "Public Domain / NOAA",
  "provenance": {
    "source": "NOAA NCEI Climate Normals 1991–2020 (station-based)",
    "retrieved": "2025-09-26T00:00:00Z",
    "notes": "Units normalized to °C and mm/day; station points are centroids/coordinates."
  },

  "validation": {
    "geometry": "Point",
    "required_fields": ["station","ghcn_id","elev_m","tmin_c","tmax_c","precip_mm","period_start","period_end","data_quality"],
    "bounds_check": true
  }
}

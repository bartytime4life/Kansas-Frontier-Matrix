{
  "id": "ks_hydro",
  "title": "Rivers & Waterbodies",
  "type": "vector",
  "format": "geojson",
  "data": "data/processed/hydrology.json",

  "category": "environment",
  "version": "1.2",
  "generated": "2025-09-28T00:00:00Z",

  "time": { "start": null, "end": null, "mode": "static" },

  "bounds": [-102.051, 36.993, -94.588, 40.003],
  "minzoom": 5,
  "maxzoom": 19,
  "visible": false,
  "opacity": 1.0,

  "popup": ["name", "ftype", "fcode", "length_km", "area_km2", "source"],

  "legend": {
    "type": "mixed",
    "label": "Hydrology",
    "classes": [
      { "label": "Perennial rivers/streams", "stroke": "#1874FF", "stroke-width": 1.5 },
      { "label": "Intermittent/ephemeral",   "stroke": "#1874FF", "stroke-dasharray": [4,2] },
      { "label": "Lakes & reservoirs",        "fill": "#A0C4FF", "stroke": "#1874FF" }
    ]
  },

  "style": {
    "renderer": "sublayers",

    "sublayers": [
      {
        "id": "ks_hydro_lines_perennial",
        "filter": { "geometry": "LineString", "any": [{ "ftype": "Stream/River" }, { "ftype": "Canal/Ditch" }] },
        "lineColor": "#1874FF",
        "lineOpacity": 0.9,
        "lineJoin": "round",
        "lineCap": "round",
        "lineDasharray": [],
        "lineWidthByZoom": [
          { "zoom": 5, "width": 0.5 },
          { "zoom": 8, "width": 0.8 },
          { "zoom": 10, "width": 1.1 },
          { "zoom": 12, "width": 1.6 },
          { "zoom": 14, "width": 2.2 }
        ]
      },
      {
        "id": "ks_hydro_lines_intermittent",
        "filter": { "geometry": "LineString", "any": [{ "fcode": "46003" }, { "fcode": "33600" }, { "ftype": "Stream/River Intermittent" }] },
        "lineColor": "#1874FF",
        "lineOpacity": 0.8,
        "lineJoin": "round",
        "lineCap": "round",
        "lineDasharray": [4, 2],
        "lineWidthByZoom": [
          { "zoom": 7, "width": 0.4 },
          { "zoom": 10, "width": 0.8 },
          { "zoom": 12, "width": 1.2 },
          { "zoom": 14, "width": 1.8 }
        ]
      },
      {
        "id": "ks_hydro_polys_water",
        "filter": { "geometry": "Polygon", "any": [{ "ftype": "Lake/Pond" }, { "ftype": "Reservoir" }, { "ftype": "Swamp/Marsh" }] },
        "fillColor": "#A0C4FF",
        "fillOpacity": 0.6,
        "lineColor": "#1874FF",
        "lineWidth": 0.6
      }
    ]
  },

  "fields": {
    "name":      { "type": "string", "description": "Feature name (GNIS/NHD)" },
    "ftype":     { "type": "string", "description": "NHD feature type (e.g., Stream/River, Lake/Pond, Reservoir)" },
    "fcode":     { "type": "string", "description": "NHD FCODE (e.g., 46006=Stream/River Perennial)" },
    "flow":      { "type": "string", "description": "Flow regime (perennial | intermittent | ephemeral)", "optional": true },
    "length_km": { "type": "number", "units": "km",  "description": "Feature length (lines, optional)" },
    "area_km2":  { "type": "number", "units": "km²", "description": "Surface area (polygons, optional)" },
    "source":    { "type": "string", "description": "Source dataset/version (e.g., NHD 2024 + KGS extract)" },
    "gnis_id":   { "type": "string", "description": "GNIS Feature ID", "optional": true }
  },

  "filters": {
    "quick": [
      { "label": "Perennial only",   "where": { "flow": "perennial" } },
      { "label": "Intermittent only","where": { "flow": "intermittent" } },
      { "label": "Named features",   "where": { "name$notnull": true } }
    ]
  },

  "search": {
    "qFields": ["name", "ftype"],
    "accentFold": true,
    "minLength": 2,
    "placeholder": "Search hydrology (e.g., Kansas River)"
  },

  "ordering": {
    "zindex": 310,
    "before": "roads_major",
    "after": "basemap"
  },

  "attribution": "© <a href=\"https://www.usgs.gov/national-hydrography\" target=\"_blank\" rel=\"noopener\">USGS NHD</a> / Kansas Geological Survey",
  "license": "Public Domain / US Government data",

  "provenance": {
    "source": "USGS National Hydrography Dataset (NHD) with KGS hydrology extracts (normalized for KFM)",
    "retrieved": "2025-09-26T00:00:00Z",
    "notes": "Mixed geometry (lines + polygons); names from GNIS/NHD where available; FCODEs retained."
  },

  "kfm_meta": {
    "schema_version": "1.1",
    "popup": ["name", "ftype", "fcode", "length_km", "area_km2", "gnis_id"],
    "stac": {
      "collection": "kfm-hydrology",
      "item": "ks_hydro_current"
    }
  },

  "alternates": {
    "data_fallbacks": [
      { "format": "pmtiles", "url": "web/tiles/ks_hydro.pmtiles", "note": "Use when present for better performance" },
      { "format": "geojson", "url": "data/processed/hydrology.json" }
    ]
  }
}

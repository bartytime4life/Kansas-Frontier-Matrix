{
  "id": "plss_parcels",
  "title": "PLSS / Historic Parcels",
  "type": "vector",
  "format": "geojson",
  "data": "data/processed/plss_sections.json",
  "category": "cadastre",

  "version": "1.4",
  "generated": "2025-09-28T00:00:00Z",

  "time": { "start": "1854-01-01", "end": null },
  "timeProperty": {
    "mode": "auto",
    "prefer": { "start": "valid_start", "end": "valid_end", "format": "date" },
    "fallback": { "start": "year", "end": null, "format": "year" }
  },

  "bounds": [-102.051, 36.993, -94.588, 40.003],
  "minzoom": 6,
  "maxzoom": 19,
  "visible": false,
  "opacity": 1.0,

  "popup": ["trs", "aliquot", "year", "valid_start", "valid_end", "meridian", "county", "parcel_id", "source"],

  "legend": {
    "type": "line",
    "label": "PLSS sections / historic parcels",
    "classes": [
      { "label": "Sections (current/undated)", "stroke": "#6D6875", "stroke-width": 0.6 },
      { "label": "Historic (status=historic)", "stroke": "#6D6875", "stroke-width": 0.6, "dash": [3, 2] },
      { "label": "Aliquots / lots", "stroke": "#4B5563", "stroke-width": 0.8 }
    ]
  },

  "style": {
    "renderer": "sublayers",
    "sublayers": [
      {
        "id": "plss_sections",
        "filter": { "any": [{ "class": "section" }, { "geom_scale": "section" } ] },
        "fillColor": "#000000",
        "fillOpacity": 0.0,
        "lineColor": "#6D6875",
        "lineOpacity": 0.95,
        "lineJoin": "round",
        "lineCap": "round",
        "lineWidthByZoom": [
          { "zoom": 6, "width": 0.4 },
          { "zoom": 10, "width": 0.6 },
          { "zoom": 13, "width": 0.9 },
          { "zoom": 16, "width": 1.2 }
        ],
        "lineDasharray": {
          "match": {
            "property": "status",
            "stops": [["historic", [3, 2]]],
            "default": []
          }
        }
      },
      {
        "id": "plss_aliquots",
        "filter": { "any": [{ "class": "aliquot" }, { "aliquot$notnull": true }, { "geom_scale": "aliquot" }] },
        "fillColor": "#000000",
        "fillOpacity": 0.0,
        "lineColor": "#4B5563",
        "lineOpacity": 0.95,
        "lineJoin": "round",
        "lineCap": "round",
        "lineWidthByZoom": [
          { "zoom": 12, "width": 0.6 },
          { "zoom": 14, "width": 0.9 },
          { "zoom": 16, "width": 1.2 },
          { "zoom": 18, "width": 1.6 }
        ],
        "lineDasharray": {
          "match": {
            "property": "status",
            "stops": [["historic", [3, 2]]],
            "default": []
          }
        }
      },
      {
        "id": "plss_section_labels",
        "labelField": "trs",
        "labelMinZoom": 14,
        "labelMaxZoom": 19,
        "labelHalo": 1.5,
        "labelHaloColor": "#ffffff",
        "labelOpacity": 0.8,
        "labelSizeByZoom": [
          { "zoom": 14, "size": 10 },
          { "zoom": 16, "size": 12 },
          { "zoom": 18, "size": 14 }
        ]
      }
    ],
    "hover": {
      "lineColor": "#111827",
      "lineWidthDelta": 0.6,
      "fillColor": "#93C5FD",
      "fillOpacity": 0.05
    },
    "selection": {
      "lineColor": "#1D4ED8",
      "lineWidthDelta": 0.8,
      "fillColor": "#60A5FA",
      "fillOpacity": 0.08
    }
  },

  "fields": {
    "trs":          { "type": "string", "description": "Township-Range-Section (e.g., T14S R10E S12)" },
    "township":     { "type": "string", "description": "Township (e.g., 14S)" },
    "range":        { "type": "string", "description": "Range (e.g., 10E)" },
    "section":      { "type": "string", "description": "Section (1–36)" },
    "aliquot":      { "type": "string", "description": "Aliquot/lot (e.g., NE¼, Lot 2), if available", "optional": true },
    "meridian":     { "type": "string", "description": "Meridian (e.g., 6th PM)" },
    "year":         { "type": "number", "description": "Year of record/plat (used for time slider when present)", "optional": true },
    "valid_start":  { "type": "string", "format": "date", "description": "Start date (if using date spans)", "optional": true },
    "valid_end":    { "type": "string", "format": "date|null", "description": "End date (null = current)", "optional": true },
    "status":       { "type": "string", "enum": ["historic", "current"], "description": "Parcel status, if present", "optional": true },
    "county":       { "type": "string", "description": "County name", "optional": true },
    "source":       { "type": "string", "description": "Cartographic/archival source (ROD/DASC/BLM/etc.)" },
    "parcel_id":    { "type": "string", "description": "Internal or legacy parcel identifier (optional)", "optional": true },
    "class":        { "type": "string", "enum": ["section", "aliquot"], "description": "Rendering hint if present", "optional": true },
    "geom_scale":   { "type": "string", "enum": ["section", "aliquot"], "description": "Alternative hint for styling", "optional": true }
  },

  "filters": {
    "quick": [
      { "label": "Sections only", "where": { "class": "section" } },
      { "label": "Aliquots/lots only", "where": { "class": "aliquot" } },
      { "label": "Historic only", "where": { "status": "historic" } },
      { "label": "Has year/date", "where": { "any": [{ "year$notnull": true }, { "valid_start$notnull": true }] } }
    ]
  },

  "search": {
    "qFields": ["trs", "aliquot", "county", "parcel_id"],
    "accentFold": true,
    "minLength": 2,
    "placeholder": "e.g., T14S R10E S12 or NE¼"
  },

  "ordering": {
    "zindex": 420,
    "before": "roads_minor",
    "after": "ks_hydro"
  },

  "attribution": "© <a href=\"https://data.kansasgis.org/\" target=\"_blank\" rel=\"noopener\">Kansas DASC</a> / Kansas Register of Deeds",
  "license": "Public Domain / State of Kansas (see per-source notes)",

  "provenance": {
    "source": "PLSS sections and historic parcel compilations (ROD/DASC), normalized for KFM",
    "retrieved": "2025-09-26T00:00:00Z",
    "notes": "Timesliced polygons; dates normalized to integer 'year' or ISO spans where available"
  },

  "kfm_meta": {
    "schema_version": "1.2",
    "popup": ["trs", "aliquot", "year", "valid_start", "valid_end", "meridian", "county", "parcel_id", "source"],
    "stac": {
      "collection": "kfm-cadastre",
      "item": "plss_parcels_timesliced"
    }
  },

  "alternates": {
    "data_fallbacks": [
      { "format": "pmtiles", "url": "web/tiles/plss_parcels.pmtiles", "note": "Use when present for better performance" },
      { "format": "geojson", "url": "data/processed/plss_sections.json" }
    ]
  }
}

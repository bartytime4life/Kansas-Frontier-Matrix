{
  "type": "FeatureCollection",
  "name": "climate_normals_ks",
  "description": "NOAA NCEI U.S. Climate Normals (1991–2020) for Kansas stations (annual & optional monthly normals; °C and mm).",
  "crs": { "type": "name", "properties": { "name": "EPSG:4326" } },
  "bbox": [-102.051, 36.993, -94.588, 40.003],

  "kfm_meta": {
    "schema_version": "1.1.0",
    "generated": "2025-09-26T00:00:00Z",
    "category": "climate",
    "accuracy": "authoritative",
    "license": {
      "name": "Public Domain (NOAA/NCEI)",
      "url": "https://www.ncei.noaa.gov/"
    },
    "attribution": "NOAA NCEI U.S. Climate Normals (1991–2020)",
    "provenance": {
      "source": "NOAA NCEI Climate Normals 1991–2020 (station-based normals)",
      "notes": "Values normalized to °C and mm; point locations are station coordinates.",
      "processing": [
        "Unit normalization (°C, mm)",
        "Schema harmonization for KFM viewer"
      ]
    },
    "connections": {
      "stac_item": "stac/items/climate_normals_ks.json",
      "related_layers": [
        "web/data/ks_hydro.json",
        "web/data/landcover.json"
      ],
      "app_layer_id": "climate_normals_ks"
    },
    "properties_schema": {
      "station":        "Station name",
      "ghcn_id":        "GHCN station ID",
      "elev_m":         "Elevation (m)",
      "tmin_c":         "Annual mean daily minimum temperature (°C)",
      "tmax_c":         "Annual mean daily maximum temperature (°C)",
      "precip_mm":      "Annual mean daily precipitation (mm)",
      "tmin_c_monthly": "Monthly mean daily minimum temperature (°C), Jan..Dec",
      "tmax_c_monthly": "Monthly mean daily maximum temperature (°C), Jan..Dec",
      "precip_mm_monthly": "Monthly mean daily precipitation (mm), Jan..Dec",
      "period_start":   "Norms period start (YYYY-MM-DD)",
      "period_end":     "Norms period end (YYYY-MM-DD)",
      "data_quality":   "provisional|final"
    },
    "ui": {
      "minzoom": 5,
      "maxzoom": 19,
      "visible": false,
      "opacity": 1.0,
      "popup": {
        "title": "{station}",
        "rows": [
          ["GHCN", "{ghcn_id}"],
          ["Elevation", "{elev_m} m"],
          ["Tmin (annual mean)", "{tmin_c} °C"],
          ["Tmax (annual mean)", "{tmax_c} °C"],
          ["Precip (annual mean daily)", "{precip_mm} mm"],
          ["Period", "{period_start} → {period_end}"],
          ["Quality", "{data_quality}"]
        ],
        "charts": {
          "temperature_monthlies": {
            "type": "line",
            "fields": ["tmin_c_monthly", "tmax_c_monthly"],
            "labels": ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]
          },
          "precip_monthlies": {
            "type": "bar",
            "fields": ["precip_mm_monthly"],
            "labels": ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]
          }
        }
      },
      "style": {
        "type": "circle",
        "circleColor": [
          "interpolate",
          ["linear", ["get", "tmax_c"]],
          10, "#3182bd",
          20, "#fe9929",
          30, "#de2d26"
        ],
        "circleRadius": [
          "interpolate",
          ["linear", ["get", "precip_mm"]],
          0.5, 4,
          3.0, 10
        ],
        "circleOpacity": 0.9
      },
      "legend": {
        "title": "Station Normals (1991–2020)",
        "notes": "Color: annual mean Tmax (°C). Size: annual mean daily precip (mm).",
        "units": { "tmax_c": "°C", "precip_mm": "mm/day" }
      }
    },
    "validation": {
      "required_fields": ["station","ghcn_id","elev_m","tmin_c","tmax_c","precip_mm","period_start","period_end","data_quality"],
      "geometry": "Point",
      "bounds_check": true
    }
  },

  "fields": {
    "station":      { "type": "string" },
    "ghcn_id":      { "type": "string" },
    "elev_m":       { "type": "number", "units": "m" },
    "tmin_c":       { "type": "number", "units": "°C" },
    "tmax_c":       { "type": "number", "units": "°C" },
    "precip_mm":    { "type": "number", "units": "mm" },
    "tmin_c_monthly":    { "type": "array", "items": { "type": "number" }, "units": "°C", "length": 12, "nullable": true },
    "tmax_c_monthly":    { "type": "array", "items": { "type": "number" }, "units": "°C", "length": 12, "nullable": true },
    "precip_mm_monthly": { "type": "array", "items": { "type": "number" }, "units": "mm", "length": 12, "nullable": true },
    "period_start": { "type": "string", "format": "date" },
    "period_end":   { "type": "string", "format": "date" },
    "data_quality": { "type": "string", "enum": ["provisional", "final"] }
  },

  "features": [
    {
      "type": "Feature",
      "id": "ks_normals_0001",
      "geometry": { "type": "Point", "coordinates": [-98.329, 38.364] },
      "properties": {
        "station": "Great Bend 3W KS",
        "ghcn_id": "USW00003971",
        "elev_m": 574,
        "tmin_c": 6.9,
        "tmax_c": 19.3,
        "precip_mm": 1.89,
        "tmin_c_monthly":   [ -5.2, -2.7, 1.3, 6.6, 12.4, 17.2, 19.8, 18.8, 13.6, 7.3, 1.0, -3.6 ],
        "tmax_c_monthly":   [ 5.2, 8.0, 13.4, 19.6, 25.1, 30.2, 33.3, 32.6, 27.7, 21.0, 12.8, 6.7 ],
        "precip_mm_monthly":[ 0.80, 0.88, 1.05, 1.86, 3.05, 3.28, 2.90, 2.59, 2.07, 1.58, 0.97, 0.77 ],
        "period_start": "1991-01-01",
        "period_end": "2020-12-31",
        "data_quality": "final"
      }
    },
    {
      "type": "Feature",
      "id": "ks_normals_0002",
      "geometry": { "type": "Point", "coordinates": [-95.622, 39.068] },
      "properties": {
        "station": "Topeka Philip Billard KS",
        "ghcn_id": "USW00013996",
        "elev_m": 270,
        "tmin_c": 7.0,
        "tmax_c": 18.9,
        "precip_mm": 2.40,
        "tmin_c_monthly":   [ -5.7, -3.6, 0.3, 5.6, 11.3, 16.4, 19.1, 18.6, 13.3, 7.0, 0.9, -3.8 ],
        "tmax_c_monthly":   [ 3.9, 6.9, 12.6, 19.0, 24.8, 29.7, 32.6, 31.9, 26.8, 20.1, 12.0, 5.3 ],
        "precip_mm_monthly":[ 0.94, 1.04, 1.52, 3.00, 4.37, 4.72, 3.89, 3.54, 3.13, 2.61, 1.46, 1.13 ],
        "period_start": "1991-01-01",
        "period_end": "2020-12-31",
        "data_quality": "final"
      }
    }
  ]
}

# .env.example — Kansas Frontier Matrix (KFM)
# ------------------------------------------------------------------------------
# Copy this file to ".env" for local development.
# Never commit ".env" (it may contain secrets).
# Keep ".env.example" secret-free (placeholders are OK).
#
# Canonical pipeline ordering (non-negotiable):
# ETL → STAC/DCAT/PROV catalogs → Neo4j graph → API boundary → Web UI → Story Nodes → Focus Mode
#
# Architecture invariants (guardrails):
# - UI MUST NOT talk to Neo4j directly; all graph access is via the API boundary.
# - Contract-first: schemas + API contracts are first-class; breaking changes require versioning/tests.
# - Deterministic pipeline: idempotent transforms, stable IDs, logged inputs/outputs.
#
# Protocol baselines (FYI; see docs/architecture/KFM_REDESIGN_BLUEPRINT_v13.md):
# - markdown_protocol_version: KFM-MDP v11.2.6
# - mcp_version: MCP-DL v6.3
# - ontology_protocol_version: KFM-ONTO v4.1.0
# - pipeline_contract_version: KFM-PPC v11.0.0
# - stac_profile: KFM-STAC v11.0.0
# - dcat_profile: KFM-DCAT v11.0.0
# - prov_profile: KFM-PROV v11.0.0
#
# If your implementation does not read a variable, delete it (especially optional sections).

# ------------------------------------------------------------------------------
# Runtime
KFM_ENV=development
KFM_LOG_LEVEL=info
KFM_DEBUG=false

# ------------------------------------------------------------------------------
# Canonical roots (repo-relative)
# Expected top-level roots (v12/v13): .github/ data/ docs/ mcp/ schemas/ src/ tests/ tools/ web/ releases/
KFM_REPO_ROOT=.
KFM_DATA_ROOT=./data
KFM_DOCS_ROOT=./docs
KFM_SCHEMAS_ROOT=./schemas
KFM_MCP_ROOT=./mcp
KFM_RELEASES_ROOT=./releases

# Optional (align with repo conventions if present)
KFM_TOOLS_ROOT=./tools
KFM_TESTS_ROOT=./tests

# Optional docs sub-roots (useful for tooling; delete if unused)
KFM_DOCS_TEMPLATES_ROOT=./docs/templates
KFM_DOCS_ARCHITECTURE_ROOT=./docs/architecture
KFM_DOCS_GOVERNANCE_ROOT=./docs/governance
KFM_DOCS_STANDARDS_ROOT=./docs/standards

# MCP sub-roots (run artifacts + experiments)
KFM_MCP_RUNS_ROOT=./mcp/runs
KFM_MCP_EXPERIMENTS_ROOT=./mcp/experiments

# ------------------------------------------------------------------------------
# Canonical code roots by stage (useful for scripts/tooling)
# NOTE: Some older materials reference src/api/ and src/web/; v12/v13 canon is src/server/ + web/.
KFM_PIPELINES_ROOT=./src/pipelines
# Optional sub-roots (only if present)
KFM_PIPELINES_ETL_ROOT=./src/pipelines/etl
KFM_PIPELINES_CATALOG_ROOT=./src/pipelines/catalog

KFM_GRAPH_CODE_ROOT=./src/graph
# Optional graph sub-roots (only if present)
KFM_GRAPH_INGEST_ROOT=./src/graph/ingest
KFM_GRAPH_MIGRATIONS_ROOT=./src/graph/migrations
KFM_GRAPH_CONSTRAINTS_ROOT=./src/graph/constraints

KFM_API_CODE_ROOT=./src/server
KFM_WEB_ROOT=./web

# ------------------------------------------------------------------------------
# Data lifecycle (choose ONE layout and keep pipelines deterministic)
# Layout A (stage roots; Master Guide v12 style):     data/{raw,work,processed}/<domain>/
# Layout B (domain roots; some older docs):          data/<domain>/{raw,work,processed}/
#
# Layout A roots
KFM_RAW_ROOT=./data/raw
KFM_WORK_ROOT=./data/work
KFM_PROCESSED_ROOT=./data/processed

# ------------------------------------------------------------------------------
# Catalog outputs (STAC / DCAT / PROV)
# Canonical outputs:
# - STAC: data/stac/{collections,items}/
# - DCAT: data/catalog/dcat/
# - PROV: data/prov/
KFM_STAC_ROOT=./data/stac
KFM_STAC_COLLECTIONS_ROOT=./data/stac/collections
KFM_STAC_ITEMS_ROOT=./data/stac/items

KFM_DCAT_ROOT=./data/catalog/dcat
KFM_PROV_ROOT=./data/prov

# ------------------------------------------------------------------------------
# Graph import artifacts (generated from processed + catalog outputs)
# Canonical: data/graph/{csv,cypher}/
KFM_GRAPH_IMPORT_ROOT=./data/graph
KFM_GRAPH_CSV_ROOT=./data/graph/csv
KFM_GRAPH_CYPHER_ROOT=./data/graph/cypher

# ------------------------------------------------------------------------------
# Neo4j (Graph database)
# Used by graph ingest scripts and the API boundary service.
NEO4J_URI=bolt://localhost:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=changeme
NEO4J_DATABASE=neo4j

# If running Neo4j via docker-compose, the official image often uses NEO4J_AUTH.
# Keep this in sync with NEO4J_USER/NEO4J_PASSWORD.
NEO4J_AUTH=neo4j/changeme
NEO4J_HTTP_PORT=7474
NEO4J_BOLT_PORT=7687

# ------------------------------------------------------------------------------
# API boundary (backend service)
KFM_API_HOST=0.0.0.0
KFM_API_PORT=8000
KFM_API_PUBLIC_URL=http://localhost:8000

# Comma-separated list of allowed origins (CORS)
KFM_CORS_ORIGINS=http://localhost:3000

# API contracts (canonical in v12/v13: src/server/contracts/**)
KFM_API_CONTRACTS_ROOT=./src/server/contracts
# Optional (only if present)
KFM_API_OPENAPI_CONTRACTS_ROOT=./src/server/contracts/openapi
KFM_API_GRAPHQL_CONTRACTS_ROOT=./src/server/contracts/graphql

# Optional: if the API also serves catalogs and Story Nodes as static endpoints
KFM_STAC_PUBLIC_URL=http://localhost:8000/stac
KFM_DCAT_PUBLIC_URL=http://localhost:8000/dcat
KFM_PROV_PUBLIC_URL=http://localhost:8000/prov
KFM_STORY_NODES_PUBLIC_URL=http://localhost:8000/story_nodes

# ------------------------------------------------------------------------------
# Web UI
KFM_WEB_PUBLIC_URL=http://localhost:3000
KFM_WEB_PORT=3000

# Base URL the UI uses to call the API boundary
KFM_WEB_API_BASE_URL=http://localhost:8000

# Optional: MapLibre style URL (leave blank to use a built-in/default style)
KFM_MAP_STYLE_URL=

# ------------------------------------------------------------------------------
# Story Nodes (narrative layer)
# Canonical home: docs/reports/story_nodes/
KFM_STORY_NODES_ROOT=./docs/reports/story_nodes
KFM_STORY_NODES_TEMPLATES_ROOT=./docs/reports/story_nodes/templates
KFM_STORY_NODES_DRAFT_ROOT=./docs/reports/story_nodes/draft
KFM_STORY_NODES_PUBLISHED_ROOT=./docs/reports/story_nodes/published
# Shared assets folder (optional). Published stories may also keep per-story assets under published/<story_slug>/assets/.
KFM_STORY_NODES_ASSETS_ROOT=./docs/reports/story_nodes/assets

# ------------------------------------------------------------------------------
# Schemas (used by validators/CI and local tooling)
# Minimum v13 readiness schema roots:
# - schemas/stac/ schemas/dcat/ schemas/prov/ schemas/storynodes/ schemas/ui/ schemas/telemetry/
KFM_SCHEMA_STAC_ROOT=./schemas/stac
KFM_SCHEMA_DCAT_ROOT=./schemas/dcat
KFM_SCHEMA_PROV_ROOT=./schemas/prov
KFM_SCHEMA_STORYNODES_ROOT=./schemas/storynodes
KFM_SCHEMA_UI_ROOT=./schemas/ui
KFM_SCHEMA_TELEMETRY_ROOT=./schemas/telemetry

# Validation mode (for local tooling if implemented): disabled | warn | strict
KFM_VALIDATION_MODE=warn

# ------------------------------------------------------------------------------
# Optional auth (depends on your API implementation)
# Examples: disabled | dev | strict | oidc
KFM_AUTH_MODE=disabled

# Dev-only secret for signing sessions/tokens (set to a strong value in real deployments)
KFM_AUTH_SECRET=dev-only-change-me

# Optional OIDC (only if implemented)
KFM_OIDC_ISSUER_URL=
KFM_OIDC_AUDIENCE=
KFM_OIDC_CLIENT_ID=
KFM_OIDC_CLIENT_SECRET=
KFM_OIDC_REDIRECT_URI=
# Space-separated or comma-separated scopes (implementation-dependent)
KFM_OIDC_SCOPES=openid profile email

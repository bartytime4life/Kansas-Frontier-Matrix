# ==============================================================================
# üåæ Kansas Frontier Matrix (KFM) ‚Äî .env.example
# ------------------------------------------------------------------------------
# ‚úÖ Safe to commit (NO real secrets). Copy to `.env` for local dev.
# üö´ Never commit `.env` (use env vars, Docker secrets, Vault/Secret Manager, etc.)
#
# üîí Trust-first invariant (non-negotiable ordering):
#   ETL ‚Üí Catalogs (STAC/DCAT/PROV) ‚Üí Graph (refs to catalogs) ‚Üí API (contracts+redaction) ‚Üí UI ‚Üí Story Nodes ‚Üí Focus Mode
#
# üì¶ Canonical data staging (domain-scoped):
#   data/raw/<domain>/      ‚Üí sources
#   data/work/<domain>/     ‚Üí intermediates
#   data/processed/<domain>/‚Üí publishable outputs
#   data/stac/{collections,items}/ + data/catalog/dcat/ + data/prov/ ‚Üí required boundary artifacts
# ==============================================================================

# ------------------------------------------------------------------------------
# üè∑Ô∏è Project Identity (safe + used by metadata builders)
# ------------------------------------------------------------------------------
KFM_APP_NAME=Kansas-Frontier-Matrix
KFM_PROJECT_TITLE=Kansas Frontier Matrix (KFM)
KFM_PROJECT_URL=https://github.com/bartytime4life/Kansas-Frontier-Matrix
KFM_PROJECT_REPOSITORY=https://github.com/bartytime4life/Kansas-Frontier-Matrix

# Default licenses (used for catalog generation; adjust per dataset/domain)
KFM_DEFAULT_CODE_LICENSE=Apache-2.0
KFM_DEFAULT_DATA_LICENSE=CC-BY-4.0

# ------------------------------------------------------------------------------
# üß¨ Versioning / Determinism / Reproducibility (global invariants)
# ------------------------------------------------------------------------------
# Tip: CI can inject these (commit SHA, run id) for PROV + traceability.
KFM_VERSION=v0.0.0-dev
KFM_BUILD_COMMIT_SHA=
KFM_RUN_ID=

# Determinism switches (recommended true for ETL/tests; can be false for exploratory dev)
KFM_DETERMINISTIC_MODE=true
KFM_GLOBAL_SEED=1337
PYTHONHASHSEED=0

# Uncertainty defaults (for model outputs + reporting layers)
KFM_UQ_DEFAULT_CONFIDENCE=0.95

# ------------------------------------------------------------------------------
# üß≠ Environment / Runtime
# ------------------------------------------------------------------------------
KFM_ENV=development
KFM_DEBUG=true
KFM_LOG_LEVEL=INFO
KFM_TIMEZONE=America/Chicago
TZ=America/Chicago

# Local dev URLs (UI + API)
KFM_BASE_URL=http://localhost:3000
KFM_API_BASE_URL=http://localhost:8000
KFM_HEALTH_PATH=/health

# Optional: compose convenience
COMPOSE_PROJECT_NAME=kfm
DOCKER_BUILDKIT=1

# ------------------------------------------------------------------------------
# üìÅ Canonical repo paths (used by tools that generate/validate artifacts)
# ------------------------------------------------------------------------------
KFM_DOCS_DIR=./docs
KFM_TEMPLATES_DIR=./docs/templates
KFM_STANDARDS_DIR=./docs/standards
KFM_SCHEMAS_DIR=./schemas
KFM_RELEASES_DIR=./releases

# Catalog profiles (standards)
KFM_STAC_PROFILE_PATH=./docs/standards/KFM_STAC_PROFILE.md
KFM_DCAT_PROFILE_PATH=./docs/standards/KFM_DCAT_PROFILE.md
KFM_PROV_PROFILE_PATH=./docs/standards/KFM_PROV_PROFILE.md

# Governance/ethics (paths referenced by governed outputs)
KFM_GOVERNANCE_ROOT=./docs/standards/governance
KFM_FAIRCARE_GUIDE_PATH=./docs/standards/faircare/FAIRCARE-GUIDE.md
KFM_SOVEREIGNTY_POLICY_PATH=./docs/standards/sovereignty/INDIGENOUS-DATA-PROTECTION.md

# ------------------------------------------------------------------------------
# üîå API Server (e.g., FastAPI)
# ------------------------------------------------------------------------------
KFM_API_HOST=0.0.0.0
KFM_API_PORT=8000
KFM_API_WORKERS=2
KFM_API_RELOAD=true
KFM_API_REQUEST_TIMEOUT_SEC=60

# Contracts / specs (optional, but recommended if you auto-serve OpenAPI)
KFM_OPENAPI_ENABLED=true
KFM_OPENAPI_PATH=/openapi.json
KFM_DOCS_PATH=/docs

# ------------------------------------------------------------------------------
# üåê Frontend (React / Vite / Next)
# NOTE: Variables prefixed with NEXT_PUBLIC_ / VITE_ are exposed to the browser.
# ------------------------------------------------------------------------------
NEXT_PUBLIC_KFM_API_BASE_URL=http://localhost:8000
VITE_KFM_API_BASE_URL=http://localhost:8000

# Map UI engine (React ¬∑ MapLibre ¬∑ optional Cesium)
KFM_MAP_ENGINE=maplibre
KFM_CESIUM_ENABLED=false

# Default Kansas view (approx) ‚Äî bbox: [minLon,minLat,maxLon,maxLat]
KFM_DEFAULT_BBOX=-102.05,37.0,-94.6,40.0
KFM_DEFAULT_ZOOM=6

# MapLibre style URL (set if using MapLibre)
KFM_MAP_STYLE_URL=
VITE_KFM_MAP_STYLE_URL=

# ------------------------------------------------------------------------------
# üìö Story Nodes + üéØ Focus Mode (governed narrative layer)
# ------------------------------------------------------------------------------
KFM_STORY_NODES_DIR=./docs/reports/visualization/focus_mode/story_nodes
KFM_FOCUS_OVERLAYS_DIR=./docs/reports/visualization/focus_mode/overlays
KFM_FOCUS_CORE_PANELS_DIR=./docs/reports/visualization/focus_mode/core_panels
KFM_FOCUS_ASSETS_DIR=./docs/reports/visualization/focus_mode/story_nodes/assets

# Focus Mode reproducibility features
KFM_FOCUS_MODE_ENABLED=true
KFM_FOCUS_VERSION_LOCK_ENABLED=true
KFM_FOCUS_DIFF_ENABLED=true

# Telemetry (governance + reproducibility signals)
KFM_TELEMETRY_ENABLED=true
KFM_TELEMETRY_SINK=file
KFM_TELEMETRY_FILE=./releases/v0.0.0-dev/focus-telemetry.json

# Telemetry schemas (examples ‚Äî pick the one your emitter uses)
KFM_TELEMETRY_SCHEMA_STORYNODES=./schemas/telemetry/reports-visualization-focusmode-storynodes-v1.json
KFM_TELEMETRY_SCHEMA_OVERLAYS=./schemas/telemetry/reports-visualization-focusmode-overlays-v1.json
KFM_TELEMETRY_SCHEMA_PANELS=./schemas/telemetry/reports-visualization-focusmode-panels-v1.json

# ------------------------------------------------------------------------------
# üß± CORS / Trusted Hosts / Rate Limiting
# ------------------------------------------------------------------------------
KFM_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173
KFM_CORS_ALLOW_ORIGINS=http://localhost:3000,http://localhost:5173
KFM_CORS_ALLOW_CREDENTIALS=true
KFM_CORS_ALLOW_METHODS=GET,POST,PUT,PATCH,DELETE,OPTIONS
KFM_CORS_ALLOW_HEADERS=Authorization,Content-Type,Accept,Origin
KFM_TRUSTED_HOSTS=localhost,127.0.0.1

KFM_RATE_LIMIT_ENABLED=true
KFM_RATE_LIMIT_DEFAULT=100/minute
KFM_LOGIN_RATE_LIMIT=10/minute

# ------------------------------------------------------------------------------
# üîê Auth (JWT / service tokens)
# ------------------------------------------------------------------------------
# üö® Replace for real deployments via secrets manager / CI secrets.
KFM_JWT_SECRET=change_me_dev_only
KFM_JWT_ALG=HS256
KFM_JWT_ISSUER=kfm
KFM_JWT_AUDIENCE=kfm-users
KFM_JWT_ACCESS_TTL_MIN=30
KFM_JWT_REFRESH_TTL_DAYS=30

KFM_PASSWORD_BCRYPT_ROUNDS=12

# Service-to-service auth (internal calls)
KFM_SERVICE_TOKEN=change_me_dev_only

# ------------------------------------------------------------------------------
# üõ∞Ô∏è Real-time (WebSockets / SSE)
# ------------------------------------------------------------------------------
KFM_WS_ENABLED=true
KFM_WS_PATH=/ws
KFM_WS_PING_INTERVAL_SEC=25
KFM_WS_MAX_CONNECTIONS=200

# ------------------------------------------------------------------------------
# üóÑÔ∏è Database (PostgreSQL + PostGIS)
# ------------------------------------------------------------------------------
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=kfm
POSTGRES_USER=kfm
POSTGRES_PASSWORD=change_me
POSTGRES_SCHEMA=geodata
POSTGRES_SSLMODE=disable

DATABASE_URL=postgresql://kfm:change_me@localhost:5432/kfm

DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_POOL_TIMEOUT_SEC=30
DB_STATEMENT_TIMEOUT_MS=30000

# ------------------------------------------------------------------------------
# üï∏Ô∏è Graph (Neo4j) ‚Äî references catalogs (no bulk payload duplication)
# ------------------------------------------------------------------------------
KFM_GRAPH_ENABLED=true

NEO4J_URI=bolt://localhost:7687
NEO4J_USERNAME=neo4j
NEO4J_PASSWORD=change_me
NEO4J_DATABASE=neo4j

# Graph safety + determinism (bounded traversal; stable ordering required)
KFM_GRAPH_QUERY_TIMEOUT_SEC=10
KFM_GRAPH_MAX_HOPS_DEFAULT=2
KFM_GRAPH_LIMIT_NODES_DEFAULT=500
KFM_GRAPH_LIMIT_EDGES_DEFAULT=1500
KFM_GRAPH_REQUIRE_STABLE_ORDERING=true
KFM_GRAPH_DISALLOW_UNBOUNDED_TRAVERSAL=true
KFM_GRAPH_DISALLOW_STRING_CONCAT_CYPHER=true

# DRIFT search (governed query templates + allowlists)
KFM_DRIFT_ENABLED=true
KFM_DRIFT_TEMPLATES_DIR=./docs/search/drift/graph-queries/templates
KFM_DRIFT_POLICIES_DIR=./docs/search/drift/graph-queries/policies
KFM_DRIFT_POLICY_LABEL_ALLOWLIST=./docs/search/drift/graph-queries/policies/label_allowlist.yml
KFM_DRIFT_POLICY_REL_ALLOWLIST=./docs/search/drift/graph-queries/policies/rel_allowlist.yml
KFM_DRIFT_POLICY_RESULT_FIELDS=./docs/search/drift/graph-queries/policies/result_fields.yml

# Sovereignty mode should be query-visible and auditable: clear|restricted|conflict|unknown
KFM_SOVEREIGNTY_MODE=clear

# ------------------------------------------------------------------------------
# üß† Cache / Task Queue (optional but common)
# ------------------------------------------------------------------------------
REDIS_URL=redis://localhost:6379/0
KFM_CACHE_TTL_SEC=300

# Celery/RQ style defaults (optional)
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2

# Worker throttles (keep heavy jobs from exhausting CPU)
KFM_WORKER_CONCURRENCY=2
KFM_MAX_SIMULATION_TASKS=2

# ------------------------------------------------------------------------------
# üì¶ Storage / Data Lake (canonical staging layout)
# ------------------------------------------------------------------------------
KFM_STORAGE_DRIVER=local

# Canonical roots (domain-scoped folders live underneath these)
KFM_DATA_ROOT=./data
KFM_DATA_RAW_DIR=./data/raw
KFM_DATA_WORK_DIR=./data/work
KFM_DATA_PROCESSED_DIR=./data/processed
KFM_DATA_EXPORTS_DIR=./data/exports
KFM_DATA_TMP_DIR=./data/tmp
KFM_DATA_IPC_DIR=./data/ipc

# Legacy aliases (keep if older modules still read these names)
KFM_DATA_DIR=./data
KFM_RAW_DATA_DIR=./data/raw
KFM_PROCESSED_DATA_DIR=./data/processed
KFM_EXPORTS_DIR=./data/exports
KFM_TMP_DIR=./data/tmp

# ------------------------------------------------------------------------------
# üóÇÔ∏è Catalogs + Provenance (required ‚Äúboundary artifacts‚Äù)
# ------------------------------------------------------------------------------
KFM_CATALOGS_ENABLED=true

# STAC (collections + items)
KFM_STAC_DIR=./data/stac
KFM_STAC_COLLECTIONS_DIR=./data/stac/collections
KFM_STAC_ITEMS_DIR=./data/stac/items

# DCAT (dataset discovery)
KFM_DCAT_DIR=./data/catalog/dcat

# PROV (lineage bundles)
KFM_PROV_DIR=./data/prov

# Validation strictness (recommended true in CI and publish paths)
KFM_METADATA_VALIDATION_STRICT=true
KFM_LINK_VALIDATION_STRICT=true

# ------------------------------------------------------------------------------
# üßæ Columnar interchange (Arrow / GeoArrow / GeoParquet) ‚Äî optional performance lane
# ------------------------------------------------------------------------------
KFM_COLUMNAR_ENABLED=true
KFM_GEOPARQUET_COMPRESSION=zstd

# Arrow Flight (optional high-throughput transport)
KFM_ARROW_FLIGHT_ENABLED=false
KFM_ARROW_FLIGHT_HOST=0.0.0.0
KFM_ARROW_FLIGHT_PORT=8815

# ------------------------------------------------------------------------------
# üåæ Geospatial / GDAL / PROJ (optional ‚Äî often needed for local native installs)
# ------------------------------------------------------------------------------
KFM_DEFAULT_EPSG=4326

# If your environment needs explicit GDAL/PROJ paths:
GDAL_DATA=
PROJ_LIB=

# Optional performance knobs (safe defaults; tweak per host)
KFM_GDAL_NUM_THREADS=ALL_CPUS

# ------------------------------------------------------------------------------
# üõ∞Ô∏è Google Earth Engine (GEE) + External APIs
# IMPORTANT: keep creds server-side only (never expose to browser)
# ------------------------------------------------------------------------------
KFM_GEE_ENABLED=false
KFM_GEE_PROJECT_ID=
KFM_GEE_SERVICE_ACCOUNT_EMAIL=

# Used by many Google SDKs (GCS, GEE, etc.)
GOOGLE_APPLICATION_CREDENTIALS=
GOOGLE_CLOUD_PROJECT=

# Weather / external feeds (optional)
KFM_NOAA_ENABLED=false
KFM_NOAA_BASE_URL=
KFM_NOAA_TOKEN=

# ------------------------------------------------------------------------------
# üîé Search & Indexing (optional)
# ------------------------------------------------------------------------------
KFM_SEARCH_ENABLED=false
ELASTICSEARCH_URL=http://localhost:9200

# Optional document store (if you add crawlers / JSON doc storage)
KFM_DOCSTORE_ENABLED=false
MONGODB_URL=mongodb://localhost:27017/kfm

# ------------------------------------------------------------------------------
# ‚öñÔ∏è Governance + Redaction (FAIR+CARE / sovereignty guardrails)
# ------------------------------------------------------------------------------
KFM_REDACTION_ENABLED=true
KFM_CLASSIFICATION_ENABLED=true

# CARE generalization defaults (tune per domain + policy)
KFM_CARE_COORD_MAX_DECIMALS=3
KFM_CARE_SENSITIVE_BUFFER_KM=5
KFM_CARE_TEMPORAL_SMOOTHING_ENABLED=true

# Auditability
KFM_AUDIT_LOG_ENABLED=true
KFM_AUDIT_LOG_SINK=file
KFM_AUDIT_LOG_FILE=./data/tmp/audit.log

# ------------------------------------------------------------------------------
# üó∫Ô∏è Maps (Google Maps JS API) ‚Äî optional if you use Google Maps instead of MapLibre
# NOTE: client keys must be HTTP-referrer restricted in GCP.
# ------------------------------------------------------------------------------
KFM_GOOGLE_MAPS_API_KEY=
KFM_GOOGLE_MAPS_MAP_ID=
NEXT_PUBLIC_GOOGLE_MAPS_API_KEY=
VITE_GOOGLE_MAPS_API_KEY=

# ------------------------------------------------------------------------------
# üì£ Notifications (optional)
# ------------------------------------------------------------------------------
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM_NAME=KFM
SMTP_FROM_EMAIL=no-reply@example.com

KFM_WEBHOOKS_ENABLED=false
KFM_WEBHOOK_SIGNING_SECRET=change_me_dev_only

# ------------------------------------------------------------------------------
# üîè Release Integrity / Supply Chain (optional but recommended for governed releases)
# ------------------------------------------------------------------------------
KFM_INTEGRITY_ENABLED=false
KFM_SBOM_PATH=./releases/v0.0.0-dev/sbom.spdx.json
KFM_MANIFEST_PATH=./releases/v0.0.0-dev/manifest.zip
KFM_ATTESTATIONS_DIR=./releases/v0.0.0-dev/attestations

# Policy-as-code gate (OPA/Rego pattern) ‚Äî optional
KFM_POLICY_GATES_ENABLED=false
KFM_OPA_URL=http://localhost:8181

# ------------------------------------------------------------------------------
# üî≠ Observability (optional)
# ------------------------------------------------------------------------------
KFM_LOG_JSON=false
SENTRY_DSN=
OTEL_SERVICE_NAME=kfm
OTEL_EXPORTER_OTLP_ENDPOINT=
PROMETHEUS_ENABLED=false

# ------------------------------------------------------------------------------
# üß™ Testing / Seeding (optional)
# ------------------------------------------------------------------------------
KFM_TESTING=false
KFM_SEED_DATA=true

# ------------------------------------------------------------------------------
# üõ†Ô∏è Airflow (optional ‚Äî orchestration of pipelines / DAGs)
# ------------------------------------------------------------------------------
AIRFLOW__CORE__EXECUTOR=LocalExecutor
AIRFLOW__DATABASE__SQL_ALCHEMY_CONN=postgresql+psycopg2://kfm:change_me@localhost:5432/airflow
AIRFLOW__WEBSERVER__SECRET_KEY=change_me_dev_only
AIRFLOW__CORE__FERNET_KEY=
AIRFLOW__CORE__LOAD_EXAMPLES=false
AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION=true
AIRFLOW__SCHEDULER__CATCHUP_BY_DEFAULT=false

# ------------------------------------------------------------------------------
# üì° IoT / MQTT (optional ‚Äî if sensors are part of your ingest path)
# ------------------------------------------------------------------------------
KFM_MQTT_ENABLED=false
KFM_MQTT_BROKER_URL=mqtts://localhost:8883
KFM_MQTT_USERNAME=
KFM_MQTT_PASSWORD=
KFM_MQTT_CLIENT_ID=kfm-dev
KFM_MQTT_TOPIC_PREFIX=kfm
KFM_MQTT_TLS_CA_CERT_PATH=
KFM_MQTT_TLS_CLIENT_CERT_PATH=
KFM_MQTT_TLS_CLIENT_KEY_PATH=

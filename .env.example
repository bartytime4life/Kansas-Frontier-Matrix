# ==============================================================================
# üåæ Kansas Frontier Matrix (KFM) ‚Äî .env.example
# ------------------------------------------------------------------------------
# ‚úÖ Safe to commit (NO real secrets). Copy to `.env` for local dev.
# üö´ Never commit `.env` (use env vars, Docker secrets, Vault/Secret Manager, etc.)
# ==============================================================================

# ------------------------------------------------------------------------------
# üß≠ Environment / Runtime
# ------------------------------------------------------------------------------
KFM_ENV=development
KFM_DEBUG=true
KFM_LOG_LEVEL=INFO
KFM_TIMEZONE=America/Chicago
KFM_APP_NAME=Kansas-Frontier-Matrix
KFM_BASE_URL=http://localhost:3000
KFM_API_BASE_URL=http://localhost:8000
KFM_HEALTH_PATH=/health

# Optional: compose convenience
COMPOSE_PROJECT_NAME=kfm
DOCKER_BUILDKIT=1

# ------------------------------------------------------------------------------
# üîå API Server (e.g., FastAPI)
# ------------------------------------------------------------------------------
KFM_API_HOST=0.0.0.0
KFM_API_PORT=8000
KFM_API_WORKERS=2
KFM_API_RELOAD=true
KFM_API_REQUEST_TIMEOUT_SEC=60

# ------------------------------------------------------------------------------
# üåê Frontend (React / Vite / Next)
# NOTE: Variables prefixed with NEXT_PUBLIC_ / VITE_ are exposed to the browser.
# ------------------------------------------------------------------------------
NEXT_PUBLIC_KFM_API_BASE_URL=http://localhost:8000
VITE_KFM_API_BASE_URL=http://localhost:8000

# ------------------------------------------------------------------------------
# üß± CORS / Trusted Hosts / Rate Limiting
# ------------------------------------------------------------------------------
KFM_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173
KFM_CORS_ALLOW_ORIGINS=http://localhost:3000,http://localhost:5173
KFM_CORS_ALLOW_CREDENTIALS=true
KFM_CORS_ALLOW_METHODS=GET,POST,PUT,PATCH,DELETE,OPTIONS
KFM_CORS_ALLOW_HEADERS=Authorization,Content-Type,Accept,Origin
KFM_TRUSTED_HOSTS=localhost,127.0.0.1

KFM_RATE_LIMIT_ENABLED=true
KFM_RATE_LIMIT_DEFAULT=100/minute
KFM_LOGIN_RATE_LIMIT=10/minute

# ------------------------------------------------------------------------------
# üîê Auth (JWT / service tokens)
# ------------------------------------------------------------------------------
KFM_JWT_SECRET=change_me_dev_only
KFM_JWT_ALG=HS256
KFM_JWT_ISSUER=kfm
KFM_JWT_AUDIENCE=kfm-users
KFM_JWT_ACCESS_TTL_MIN=30
KFM_JWT_REFRESH_TTL_DAYS=30

KFM_PASSWORD_BCRYPT_ROUNDS=12

# Service-to-service auth (internal calls)
KFM_SERVICE_TOKEN=change_me_dev_only

# ------------------------------------------------------------------------------
# üõ∞Ô∏è Real-time (WebSockets / SSE)
# ------------------------------------------------------------------------------
KFM_WS_ENABLED=true
KFM_WS_PATH=/ws
KFM_WS_PING_INTERVAL_SEC=25
KFM_WS_MAX_CONNECTIONS=200

# ------------------------------------------------------------------------------
# üóÑÔ∏è Database (PostgreSQL + PostGIS)
# ------------------------------------------------------------------------------
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=kfm
POSTGRES_USER=kfm
POSTGRES_PASSWORD=change_me
POSTGRES_SCHEMA=geodata
POSTGRES_SSLMODE=disable

DATABASE_URL=postgresql://kfm:change_me@localhost:5432/kfm

DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_POOL_TIMEOUT_SEC=30
DB_STATEMENT_TIMEOUT_MS=30000

# ------------------------------------------------------------------------------
# üß† Cache / Task Queue (optional but common)
# ------------------------------------------------------------------------------
REDIS_URL=redis://localhost:6379/0
KFM_CACHE_TTL_SEC=300

# Celery/RQ style defaults (optional)
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2

# Worker throttles (keep heavy jobs from exhausting CPU)
KFM_WORKER_CONCURRENCY=2
KFM_MAX_SIMULATION_TASKS=2

# ------------------------------------------------------------------------------
# üì¶ Storage / Data Lake
# ------------------------------------------------------------------------------
KFM_STORAGE_DRIVER=local
KFM_DATA_DIR=./data
KFM_RAW_DATA_DIR=./data/raw
KFM_PROCESSED_DATA_DIR=./data/processed
KFM_EXPORTS_DIR=./data/exports
KFM_TMP_DIR=./data/tmp

# S3 (optional)
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_SESSION_TOKEN=
KFM_S3_BUCKET=
KFM_S3_PREFIX=kfm

# GCS (optional)
GOOGLE_CLOUD_PROJECT=
GOOGLE_APPLICATION_CREDENTIALS=
KFM_GCS_BUCKET=
KFM_GCS_PREFIX=kfm

# ------------------------------------------------------------------------------
# üåæ Geospatial / GDAL / PROJ (optional ‚Äî often needed for local native installs)
# ------------------------------------------------------------------------------
KFM_DEFAULT_EPSG=4326
GDAL_DATA=
PROJ_LIB=

# ------------------------------------------------------------------------------
# üõ∞Ô∏è Google Earth Engine (GEE) + External APIs
# IMPORTANT: keep creds server-side only (never expose to browser)
# ------------------------------------------------------------------------------
KFM_GEE_ENABLED=false
KFM_GEE_PROJECT_ID=
KFM_GEE_SERVICE_ACCOUNT_EMAIL=
GOOGLE_APPLICATION_CREDENTIALS=

# Weather / external feeds (optional)
KFM_NOAA_ENABLED=false
KFM_NOAA_BASE_URL=
KFM_NOAA_TOKEN=

# ------------------------------------------------------------------------------
# üó∫Ô∏è Maps (Google Maps JS API)
# NOTE: client keys must be HTTP-referrer restricted in GCP.
# ------------------------------------------------------------------------------
KFM_GOOGLE_MAPS_API_KEY=
KFM_GOOGLE_MAPS_MAP_ID=
NEXT_PUBLIC_GOOGLE_MAPS_API_KEY=
VITE_GOOGLE_MAPS_API_KEY=

# ------------------------------------------------------------------------------
# üì£ Notifications (optional)
# ------------------------------------------------------------------------------
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM_NAME=KFM
SMTP_FROM_EMAIL=no-reply@example.com

KFM_WEBHOOKS_ENABLED=false
KFM_WEBHOOK_SIGNING_SECRET=change_me_dev_only

# ------------------------------------------------------------------------------
# üî≠ Observability (optional)
# ------------------------------------------------------------------------------
KFM_LOG_JSON=false
SENTRY_DSN=
OTEL_SERVICE_NAME=kfm
OTEL_EXPORTER_OTLP_ENDPOINT=
PROMETHEUS_ENABLED=false

# ------------------------------------------------------------------------------
# üß™ Testing / Seeding (optional)
# ------------------------------------------------------------------------------
KFM_TESTING=false
KFM_SEED_DATA=true

# ------------------------------------------------------------------------------
# üõ†Ô∏è Airflow (optional ‚Äî orchestration of pipelines / DAGs)
# ------------------------------------------------------------------------------
AIRFLOW__CORE__EXECUTOR=LocalExecutor
AIRFLOW__DATABASE__SQL_ALCHEMY_CONN=postgresql+psycopg2://kfm:change_me@localhost:5432/airflow
AIRFLOW__WEBSERVER__SECRET_KEY=change_me_dev_only
AIRFLOW__CORE__FERNET_KEY=
AIRFLOW__CORE__LOAD_EXAMPLES=false
AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION=true
AIRFLOW__SCHEDULER__CATCHUP_BY_DEFAULT=false

# ------------------------------------------------------------------------------
# üì° IoT / MQTT (optional ‚Äî if sensors are part of your ingest path)
# ------------------------------------------------------------------------------
KFM_MQTT_ENABLED=false
KFM_MQTT_BROKER_URL=mqtts://localhost:8883
KFM_MQTT_USERNAME=
KFM_MQTT_PASSWORD=
KFM_MQTT_CLIENT_ID=kfm-dev
KFM_MQTT_TOPIC_PREFIX=kfm
KFM_MQTT_TLS_CA_CERT_PATH=
KFM_MQTT_TLS_CLIENT_CERT_PATH=
KFM_MQTT_TLS_CLIENT_KEY_PATH=
